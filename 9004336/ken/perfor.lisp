;; -*-lisp-*- produced by Director (IN MACLISP)

(INCLUDE |ai:ken;declare >|) 
(IF-FOR-MACLISP (DECLARE (LOAD '|ai:ken1;turmac|))) 
(DEFCOMMENT PERFOR) 
(DEFINE-FORM
 (DRAW-SCALED-AND-CENTERED
  SIZE
  DRAWING-FORM
  SCALE-FACTOR
  HOW-TO-GET-TO-CENTER
  PEN-COLOR)
 (LET
  ((*DIRECTOR-TURTLE-SCALING-FACTOR
    (*$ SIZE SCALE-FACTOR *DIRECTOR-TURTLE-SCALING-FACTOR)))
  (THINGUP)
  (LET
   ((XCOR ($XCOR)) (YCOR ($YCOR)) (HEADING ($HEADING)))
   (EVAL HOW-TO-GET-TO-CENTER)
   (PENCOLOR PEN-COLOR)
   (THINGDOWN)
   (EVAL DRAWING-FORM)
   (THINGUP)
   (SETXY XCOR YCOR)
   (SETHEADING HEADING)))) 
(DEFINE-FORM
 (FUSE-PARTS PARTS WHOLE-ABSOLUTE-SIZE)
 (EVAL
  '(DEFUN ,(APPEND-ATOMS (NAME-OF MYSELF) '-FUSED-APPEARANCE) (SIZE)
     !,(MAPCAR
        (FUNCTION
         (LAMBDA (PART) (GENERATE-APPEARANCE-CODE-FOR-PART PART WHOLE-ABSOLUTE-SIZE)))
        PARTS)))) 
(DEFINE-FORM
 (REVERSE-DISPLAY-LIST TURTLE-COMMANDS)
 (NREVERSE
  (MAPCAR
   (FUNCTION
    (LAMBDA (COMMAND)
      '(,(FIRST COMMAND)
        ,
         (COND ((NUMBERP (SECOND COMMAND)) (MINUS (SECOND COMMAND)))
               (T '(MINUS ,(SECOND COMMAND)))))))
   TURTLE-COMMANDS))) 
(DEFINE-FORM
 (SEPERATE-SHAPE-ARGS DRAW-ARGS)
 (DO
  ((I DRAW-ARGS (REST I)) (SHAPE-ARGS NIL) (NON-SHAPE-ARGS NIL))
  ((NULL I) (LIST (NREVERSE SHAPE-ARGS) (NREVERSE NON-SHAPE-ARGS)))
  (COND ((ATOM (FIRST I)) (PUSH (FIRST I) SHAPE-ARGS))
        ((ONE-LONG (FIRST I)) (PUSH (FIRST (FIRST I)) NON-SHAPE-ARGS))
        (T (PUSH (FIRST I) SHAPE-ARGS))))) 
(DEFINE-FORM (DRAW-FORM HOW-TO-DRAW) (SECOND (THIRD HOW-TO-DRAW))) 
(DEFCOMMENT STAGE) 
(DEFINE-FORM (DIRECTOR-WIPE) (ASK STAGE WIPE)) 
(DEFINE-SYNONYM DWIPE DIRECTOR-WIPE) 
(DEFINE-SYNONYM DCS DIRECTOR-CLEAR-STAGE) 
(IF-FOR-MACLISP
 (SSTATUS TTYINT 18 'RESTORE-STAGE-TO-NORMAL)
 (DEFINE-METHOD-HELPER
  (RESTORE-STAGE-TO-NORMAL NIL NIL)
  STAGE
  (NOINTERRUPT NIL)
  (ASK STAGE SET YOUR MODE TO NORMAL)
  (ASK STAGE WIPE))
 (SSTATUS TTYINT 1 'HIDE-ALL-STAGE-ACTIVITIES)
 (DEFINE-METHOD-HELPER
  (HIDE-ALL-STAGE-ACTIVITIES NIL NIL)
  STAGE
  (NOINTERRUPT NIL)
  (ASK STAGE SET YOUR MODE TO SILENT))) 
(COMMENT HERE COMES THE ACTORS THEMSELVES) 
(OR
 (GET-ACTOR (QUOTE PERFORMER))
 (PLACE-ACTOR-ON-NAME (LIST (QUOTE DIRECTOR-SYMBOL-FOR-ACTOR) NIL) (QUOTE PERFORMER))) 
(REPLACE-REST
 (ACTOR-OF (QUOTE PERFORMER))
 (LIST
  NIL
  (CONS
   (QUOTE VALUE-METHOD)
   (CONS
    (QUOTE
     (((NAME PERFORMER PRIVATE)                 (DEFAULT-WHOLE THE-CAST)
       (SIZE 100.0)                             (STATE NIL)
       (ABSOLUTE-SIZE NIL)                      (HEADING-FROM-WHOLE 0.0)
       (DISTANCE-FROM-WHOLE 0.0)                (RELATIVE-HEADING 0.0)
       (COLORS (WHITE))                         (DRAW-MODE (PENDOWN))
       (ERASE-MODE (ERASERDOWN))                (PEN-TYPE NORMAL)
       (ERASABILITY T)                          (SPEED 100.0)
       (VARIABLES-TO-COPY-UPON-CREATION (STATE VISIBILITY))
       (STANDARDIZE-SIZE? T)                    (STANDARDIZE-CENTER? T))
      ((MOVE FORWARD SPEED) 100.0)
      ((MOVE RIGHT SPEED) 100.0)
      ((MOVE UP SPEED) 100.0)
      ((TURN RIGHT SPEED) 30.0)
      ((GROW SPEED) 100.0)
      ((GROW BY FACTOR SPEED) (MULTIPLY-BY 2.0))
      ((XCOR SPEED) 100.0)
      ((HEADING SPEED) 30.0)
      ((COMPONENTS OF DELXY) (DELX DELY))
      ((COMPONENTS OF POSITION) (XCOR YCOR))
      ((COMPONENTS OF STATE) (XCOR YCOR HEADING))))
    (QUOTE ((INTERNAL-RECALL-YOUR-VARIABLE)))))
  (QUOTE (METHOD-SELECTOR D0297 TO-BE-FILLED-IN-WITH-SECOND-TO-LAST-CONS))
  (QUOTE (NORMAL-METHOD D0298 |(SET YOUR {MEMQ ? (QUOTE (XCOR YCOR))} TO ?)|))
  (QUOTE (NORMAL-METHOD D0299 |(SET YOUR POSITION TO ?)|))
  (QUOTE (NORMAL-METHOD D0300 |(RECALL YOUR {MEMQ ? (QUOTE (XCOR YCOR))})|))
  (QUOTE (NORMAL-METHOD D0301 |(SET YOUR {MEMQ ? (QUOTE (XCOR YCOR HEADING))} TO ?)|))
  (QUOTE (NORMAL-METHOD D0302 |(SET YOUR STATE TO ?)|))
  (QUOTE (NORMAL-METHOD D0303 |(RECALL YOUR {MEMQ ? (QUOTE (XCOR YCOR HEADING))})|))
  (QUOTE (NORMAL-METHOD D0304 |(MAKE ?)|))
  (QUOTE (NORMAL-METHOD D0305 (RECALL YOUR DRAW-PROCEDURE-BODY)))
  (QUOTE (NORMAL-METHOD D0306 (SHOW)))
  (QUOTE (NORMAL-METHOD D0308 (JUST SHOW)))
  (QUOTE (NORMAL-METHOD D0309 (SHOW ALL)))
  (QUOTE (NORMAL-METHOD D0311 (HIDE)))
  (QUOTE (NORMAL-METHOD D0313 (JUST HIDE)))
  (QUOTE (NORMAL-METHOD D0314 (HIDE ALL)))
  (QUOTE (NORMAL-METHOD D0316 (REDISPLAY)))
  (QUOTE (NORMAL-METHOD D0317 (DISPLAY)))
  (QUOTE (NORMAL-METHOD D0318 (ERASE)))
  (QUOTE (NORMAL-METHOD D0319 |(SET YOUR ERASABILITY TO ?)|))
  (QUOTE (NORMAL-METHOD D0320 (ERASE BY CLEARING AREA)))
  (QUOTE (NORMAL-METHOD D0321 |(RECALL YOUR ({or DISPLAY ERASE} ACTIONS))|))
  (QUOTE (NORMAL-METHOD D0322 (RECALL YOUR HOW-TO-DRAW)))
  (QUOTE (NORMAL-METHOD D0323 (RECALL YOUR ABSOLUTE-SIZE)))
  (QUOTE (NORMAL-METHOD D0324 |(RECOMPUTE YOUR ABSOLUTE-SIZE SINCE ? IS NOW ?)|))
  (QUOTE (NORMAL-METHOD D0325 |(NOTICE THAT ? HAS GROWN BY ?)|))
  (QUOTE (NORMAL-METHOD D0327 |(SET YOUR SIZE TO ?)|))
  (QUOTE (NORMAL-METHOD D0328 |(SET YOUR ABSOLUTE-SIZE TO ?)|))
  (QUOTE (NORMAL-METHOD D0330 |(SET YOUR HOW-TO-DRAW TO ?)|))
  (QUOTE (NORMAL-METHOD D0331 |(SET YOUR COLORS TO ?)|))
  (QUOTE (NORMAL-METHOD D0332 |(SET YOUR VALIDITY-OF-HOW-TO-DRAW TO ?)|))
  (QUOTE (NORMAL-METHOD D0333 |({or FD FORWARD BK BACK RT RIGHT LT LEFT} ?)|))
  (QUOTE (MACRO-METHOD |MACRO-(GROW ?AMOUNT)PERFORMER| |(GROW ?)|))
  (QUOTE
   (MACRO-METHOD
    |MACRO-({or GROW SHRINK} BY FACTOR ?FACTOR)PERFORMER|
    |({or GROW SHRINK} BY FACTOR ?)|))
  (QUOTE (MACRO-METHOD |MACRO-(SHRINK ?AMOUNT)PERFORMER| |(SHRINK ?)|))
  (QUOTE (NORMAL-METHOD D0334 |(PREPARE TO MIX COLORS WITH ?)|))
  (QUOTE
   (NORMAL-METHOD D0335 |(SEQUENTIALLY (DO IN ? ? {or CHANGE SET} YOUR COLORS TO ?) %)|))
  (QUOTE (NORMAL-METHOD D0336 |(YIELD DISTANCE TO (? ? %))|))
  (QUOTE (NORMAL-METHOD D0337 |(YIELD HEADING TO (? ? %))|))
  (QUOTE (NORMAL-METHOD D0338 |(YIELD HEADING FROM (? ? %))|))
  (QUOTE (NORMAL-METHOD D0339 (RECALL YOUR STATE)))
  (QUOTE (NORMAL-METHOD D0340 |(RECOMPUTE YOUR STATE SINCE ? IS NOW ?)|))
  (QUOTE (NORMAL-METHOD D0341 |(NOTICE THAT STATE OF ? IS NOW ?)|))
  (QUOTE (NORMAL-METHOD D0342 |(SET YOUR STATE TO ?)|))
  (QUOTE (MACRO-METHOD |MACRO-(SETTURTLE ?NEW-STATE)PERFORMER| |(SETTURTLE ?)|))
  (QUOTE (MACRO-METHOD |MACRO-(SETHEADING ?NEW-HEADING)PERFORMER| |(SETHEADING ?)|))
  (QUOTE (NORMAL-METHOD D0344 |({or SETXY DELXY} ? ?)|))
  (QUOTE (NORMAL-METHOD D0345 |(MOVE LEFT ?)|))
  (QUOTE (NORMAL-METHOD D0346 |(MOVE RIGHT ?)|))
  (QUOTE (NORMAL-METHOD D0347 |(MOVE UP ?)|))
  (QUOTE (NORMAL-METHOD D0348 |(MOVE DOWN ?)|))
  (QUOTE (NORMAL-METHOD D0349 |(MOVE {MEMQ ? '(FORWARD BACK)} ?)|))
  (QUOTE (NORMAL-METHOD D0350 |(TURN {MEMQ ? '(RIGHT LEFT)} ?)|))
  (QUOTE (NORMAL-METHOD D0351 |({or DELX DELY SETX SETY} ?)|))
  (QUOTE (NORMAL-METHOD D0352 |(RUN ?)|))
  (QUOTE (NORMAL-METHOD D0353 |(SET YOUR PEN-TYPE TO ?)|))
  (QUOTE (NORMAL-METHOD D0354 (PEN UP)))
  (QUOTE (NORMAL-METHOD D0355 (PEN DOWN)))
  (QUOTE (NORMAL-METHOD D0356 (REDISPLAY)))
  (QUOTE (NORMAL-METHOD D0357 (CREATE NEW APPEARANCE)))
  (QUOTE (NORMAL-METHOD D0358 (FUSE YOUR PARTS)))
  (QUOTE (NORMAL-METHOD D0360 |(WHEN DRAWING USE ? OF %)|))
  (QUOTE (NORMAL-METHOD D0362 |(WHEN DRAWING DO %)|))
  (QUOTE (NORMAL-METHOD D0363 |(SET YOUR WHOLE TO ?)|))
  (QUOTE (NORMAL-METHOD D0366 |(MAKE ? INTERPOLATION TO ?)|))
  (QUOTE (NORMAL-METHOD D0367 (UNMAKE)))
  (QUOTE (NORMAL-METHOD D0368 |(SAVE ?)|))
  (QUOTE SOMETHING))) 
(REPLACE-THIRD
 (SECOND (METHODS-OF (ACTOR-OF (QUOTE PERFORMER))))
 (SECOND-TO-LAST-CONS (METHODS-OF (ACTOR-OF (QUOTE PERFORMER))))) 
(REMPROP (QUOTE PERFORMER) (QUOTE ACTOR-LOAD)) 
(OR
 (GET-ACTOR (QUOTE THE-CAST))
 (PLACE-ACTOR-ON-NAME (LIST (QUOTE DIRECTOR-SYMBOL-FOR-ACTOR) NIL) (QUOTE THE-CAST))) 
(REPLACE-REST
 (ACTOR-OF (QUOTE THE-CAST))
 (LIST
  NIL
  (CONS
   (QUOTE VALUE-METHOD)
   (CONS
    (QUOTE
     (((NAME THE-CAST PRIVATE)                  (STATE (0.0 0.0 0.0))
       (VISIBILITY NIL)                         (WHOLE NIL PRIVATE)
       (SIZE 1000.0)                            (ABSOLUTE-SIZE 1000.0)
       (POSITION (0.0 0.0))                     (XCOR 0.0)
       (YCOR 0.0)                               (HEADING 0.0))))
    (QUOTE ((INTERNAL-RECALL-YOUR-VARIABLE)))))
  (QUOTE PERFORMER))) 
(REMPROP (QUOTE THE-CAST) (QUOTE ACTOR-LOAD)) 
(OR
 (GET-ACTOR (QUOTE APPEARANCE))
 (PLACE-ACTOR-ON-NAME (LIST (QUOTE DIRECTOR-SYMBOL-FOR-ACTOR) NIL) (QUOTE APPEARANCE))) 
(REPLACE-REST
 (ACTOR-OF (QUOTE APPEARANCE))
 (LIST
  NIL
  (CONS
   (QUOTE VALUE-METHOD)
   (CONS
    (QUOTE
     (((NAME APPEARANCE PRIVATE) (DRAW-MODE (PENDOWN)) (ERASE-MODE (ERASERDOWN)))))
    (QUOTE ((INTERNAL-RECALL-YOUR-VARIABLE)))))
  (QUOTE (METHOD-SELECTOR D0369 TO-BE-FILLED-IN-WITH-SECOND-TO-LAST-CONS))
  (QUOTE (NORMAL-METHOD D0370 (COMPILE AS FUNCTION)))
  (QUOTE (NORMAL-METHOD D0371 |(MAKE APPEARANCE OF ?)|))
  (QUOTE (NORMAL-METHOD D0373 |(MAKE AN INSTANCE AT ?)|))
  (QUOTE SOMETHING))) 
(REPLACE-THIRD
 (SECOND (METHODS-OF (ACTOR-OF (QUOTE APPEARANCE))))
 (SECOND-TO-LAST-CONS (METHODS-OF (ACTOR-OF (QUOTE APPEARANCE))))) 
(REMPROP (QUOTE APPEARANCE) (QUOTE ACTOR-LOAD)) 
(OR
 (GET-ACTOR (QUOTE INTERPOLATION))
 (PLACE-ACTOR-ON-NAME (LIST (QUOTE DIRECTOR-SYMBOL-FOR-ACTOR) NIL) (QUOTE INTERPOLATION))) 
(REPLACE-REST
 (ACTOR-OF (QUOTE INTERPOLATION))
 (LIST
  NIL
  (CONS
   (QUOTE VALUE-METHOD)
   (CONS
    (QUOTE
     (((NAME INTERPOLATION PRIVATE)             (STATE (0.0 0.0 0.0))
       (VISIBILITY NIL)                         (WHOLE THE-CAST PRIVATE)
       (ABSOLUTE-SIZE 100.000001)               (SIZE 100.000001)
       (POSITION (0.0 0.0))                     (XCOR 0.0)
       (YCOR 0.0)                               (HEADING 0.0)
       (DISTANCE-FROM-WHOLE 0.0)                (HEADING-FROM-WHOLE 0.0)
       (RELATIVE-HEADING 0.0)                   (COLOR-CHANGE-FREQUENCY 99999999)
       (AMOUNT 0.5))))
    (QUOTE ((INTERNAL-RECALL-YOUR-VARIABLE)))))
  (QUOTE PERFORMER))) 
(REMPROP (QUOTE INTERPOLATION) (QUOTE ACTOR-LOAD)) 
(OR
 (GET-ACTOR (QUOTE THE-TURTLE))
 (PLACE-ACTOR-ON-NAME (LIST (QUOTE DIRECTOR-SYMBOL-FOR-ACTOR) NIL) (QUOTE THE-TURTLE))) 
(REPLACE-REST
 (ACTOR-OF (QUOTE THE-TURTLE))
 (LIST
  NIL
  (CONS
   (QUOTE VALUE-METHOD)
   (CONS
    (QUOTE (((NAME THE-TURTLE PRIVATE) (PERFORM-OR-RECALL PERFORM))))
    (QUOTE ((INTERNAL-RECALL-YOUR-VARIABLE)))))
  (QUOTE (NORMAL-METHOD D0375 |(PERFORM %)|))
  (QUOTE SOMETHING))) 
(REMPROP (QUOTE THE-TURTLE) (QUOTE ACTOR-LOAD)) 
(OR
 (GET-ACTOR (QUOTE STAGE))
 (PLACE-ACTOR-ON-NAME (LIST (QUOTE DIRECTOR-SYMBOL-FOR-ACTOR) NIL) (QUOTE STAGE))) 
(REPLACE-REST
 (ACTOR-OF (QUOTE STAGE))
 (LIST
  NIL
  (CONS
   (QUOTE VALUE-METHOD)
   (CONS
    (QUOTE
     (((NAME STAGE PRIVATE)       (STATE (0.0 0.0 0.0))      (VISIBILITY NIL)
       (WHOLE THE-CAST PRIVATE)   (ABSOLUTE-SIZE 100.000001) (SIZE 100.000001)
       (POSITION (0.0 0.0))       (XCOR 0.0)                 (YCOR 0.0)
       (HEADING 0.0)              (DISTANCE-FROM-WHOLE 0.0)  (HEADING-FROM-WHOLE 
0.0)
       (RELATIVE-HEADING 0.0)     (STANDARDIZE-SIZE? NIL)
       (DRAW-PROCEDURE DRAW-RECTANGLE)
       (DRAWING-ARGS (HEIGHT-OF-SCREEN WIDTH-OF-SCREEN))
       (NON-SHAPE-DRAWING-ARGS NIL)
       (APPEARANCE-VARIABLES (HOW-TO-DRAW COLORS))
       (VARIABLES-TO-COPY-UPON-CREATION (HOW-TO-DRAW COLORS STATE VISIBILITY))
       (MODE NORMAL))))
    (QUOTE ((INTERNAL-RECALL-YOUR-VARIABLE)))))
  (QUOTE (METHOD-SELECTOR D0377 TO-BE-FILLED-IN-WITH-SECOND-TO-LAST-CONS))
  (QUOTE (NORMAL-METHOD D0378 |(SET YOUR HEIGHT-OF-SCREEN TO ?)|))
  (QUOTE (NORMAL-METHOD D0379 |(SET YOUR WIDTH-OF-SCREEN TO ?)|))
  (QUOTE (NORMAL-METHOD D0380 (RECALL YOUR WIDTH)))
  (QUOTE (NORMAL-METHOD D0381 (RECALL YOUR HEIGHT)))
  (QUOTE (NORMAL-METHOD D0382 (RECALL YOUR HEIGHT-OF-SCREEN)))
  (QUOTE (NORMAL-METHOD D0383 (RECALL YOUR WIDTH-OF-SCREEN)))
  (QUOTE (NORMAL-METHOD D0384 |(SET YOUR HEIGHT TO ?)|))
  (QUOTE (NORMAL-METHOD D0385 |(SET YOUR WIDTH TO ?)|))
  (QUOTE (NORMAL-METHOD D0386 (SAVE STAGE)))
  (QUOTE (NORMAL-METHOD D0388 (WIPE)))
  (QUOTE (NORMAL-METHOD D0390 (CLEAR)))
  (QUOTE (NORMAL-METHOD D0391 (START DISPLAY)))
  (QUOTE (NORMAL-METHOD D0392 (RESTART DISPLAY)))
  (QUOTE PERFORMER))) 
(REPLACE-THIRD
 (SECOND (METHODS-OF (ACTOR-OF (QUOTE STAGE))))
 (SECOND-TO-LAST-CONS (METHODS-OF (ACTOR-OF (QUOTE STAGE))))) 
(REMPROP (QUOTE STAGE) (QUOTE ACTOR-LOAD)) 
(OR
 (GET-ACTOR (QUOTE THE-TRAILS))
 (PLACE-ACTOR-ON-NAME (LIST (QUOTE DIRECTOR-SYMBOL-FOR-ACTOR) NIL) (QUOTE THE-TRAILS))) 
(REPLACE-REST
 (ACTOR-OF (QUOTE THE-TRAILS))
 (LIST
  NIL
  (CONS
   (QUOTE VALUE-METHOD)
   (CONS
    (QUOTE
     (((NAME THE-TRAILS PRIVATE)                (STATE (0.0 0.0 0.0))
       (VISIBILITY NIL)                         (WHOLE THE-CAST PRIVATE)
       (ABSOLUTE-SIZE 100.000001)               (SIZE 100.000001)
       (POSITION (0.0 0.0))                     (XCOR 0.0)
       (YCOR 0.0)                               (HEADING 0.0)
       (DISTANCE-FROM-WHOLE 0.0)                (HEADING-FROM-WHOLE 0.0)
       (RELATIVE-HEADING 0.0))))
    (QUOTE ((INTERNAL-RECALL-YOUR-VARIABLE)))))
  (QUOTE (METHOD-SELECTOR D0395 TO-BE-FILLED-IN-WITH-SECOND-TO-LAST-CONS))
  (QUOTE (NORMAL-METHOD D0396 (SET YOUR VISIBILITY TO NIL)))
  (QUOTE (NORMAL-METHOD D0397 |(MOVING FROM ? TO ? WITH ?)|))
  (QUOTE (NORMAL-METHOD D0400 |({or DISPLAY REDISPLAY})|))
  (QUOTE (NORMAL-METHOD D0401 (ERASE)))
  (QUOTE (NORMAL-METHOD D0402 (CREATE NEW APPEARANCE)))
  (QUOTE PERFORMER))) 
(REPLACE-THIRD
 (SECOND (METHODS-OF (ACTOR-OF (QUOTE THE-TRAILS))))
 (SECOND-TO-LAST-CONS (METHODS-OF (ACTOR-OF (QUOTE THE-TRAILS))))) 
(REMPROP (QUOTE THE-TRAILS) (QUOTE ACTOR-LOAD)) 
(OR
 (GET-ACTOR (QUOTE TRAIL-APPEARANCE))
 (PLACE-ACTOR-ON-NAME
  (LIST (QUOTE DIRECTOR-SYMBOL-FOR-ACTOR) NIL)
  (QUOTE TRAIL-APPEARANCE))) 
(REPLACE-REST
 (ACTOR-OF (QUOTE TRAIL-APPEARANCE))
 (LIST
  NIL
  (CONS
   (QUOTE VALUE-METHOD)
   (CONS
    (QUOTE (((NAME TRAIL-APPEARANCE PRIVATE))))
    (QUOTE ((INTERNAL-RECALL-YOUR-VARIABLE)))))
  (QUOTE (METHOD-SELECTOR D0404 TO-BE-FILLED-IN-WITH-SECOND-TO-LAST-CONS))
  (QUOTE (NORMAL-METHOD D0405 (COMPILE AS FUNCTION)))
  (QUOTE (NORMAL-METHOD D0406 (ERASE)))
  (QUOTE APPEARANCE))) 
(REPLACE-THIRD
 (SECOND (METHODS-OF (ACTOR-OF (QUOTE TRAIL-APPEARANCE))))
 (SECOND-TO-LAST-CONS (METHODS-OF (ACTOR-OF (QUOTE TRAIL-APPEARANCE))))) 
(REMPROP (QUOTE TRAIL-APPEARANCE) (QUOTE ACTOR-LOAD)) 
(COMMENT THE FOLLOWING ARE THE ACTORS NEEDED FOR THE FOLLOWING METHODS) 
(COMMENT NOW FOR METHOD HELPERS (IE FUNCTIONS WHICH DO TRANSMISSIONS)) 
(DEFINE-FORM
 (THE-COMPILER-ISNT-COMPILING-THE-FIRST-HELPER-RIGHT)
 (LET
  ((*MESSAGE '(PRINT YOUR NOTHING)))
  (QUICK-COMPILED-ASK
   '#,(METHOD-AT-POSITION (|(PRINT YOUR ?)| 0) SOMETHING)
   '#,(ACTOR-OF (QUOTE SOMETHING))))) 
(DEFINE-FORM
 (DIRECTOR-CLEAR-STAGE)
 (CLEARSCREEN)
 (LET
  ((STAGE-VISIBLE
    (LET
     ((MYSELF (ACTOR-OF (QUOTE STAGE))) (*MESSAGE '(RECALL YOUR VISIBILITY)))
     (QUICK-COMPILED-ASK
      '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
      '#,(ACTOR-OF (QUOTE STAGE))))))
  (LET
   ((MYSELF (ACTOR-OF (QUOTE THE-CAST)))
    (*MESSAGE
     '(SEQUENTIALLY (ASK EACH OF YOUR VISIBLE-PARTS SET YOUR VISIBILITY TO NIL))))
   (QUICK-COMPILED-ASK
    '#,(METHOD-AT-POSITION (|(SEQUENTIALLY (ASK EACH OF YOUR ? %) %)| 0) SOMETHING)
    '#,(ACTOR-OF (QUOTE THE-CAST))))
  (LET
   ((MYSELF (ACTOR-OF (QUOTE THE-CAST))) (*MESSAGE '(SET YOUR VISIBLE-PARTS TO NIL)))
   (QUICK-COMPILED-ASK
    '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
    '#,(ACTOR-OF (QUOTE THE-CAST))))
  (COND (STAGE-VISIBLE
         (LET
          ((MYSELF (ACTOR-OF (QUOTE STAGE))) (*MESSAGE '(SHOW)))
          (QUICK-COMPILED-ASK
           '#,(METHOD-AT-POSITION ((SHOW) 0) PERFORMER)
           '#,(ACTOR-OF (QUOTE STAGE))))))
  (LET
   ((MYSELF (ACTOR-OF (QUOTE THE-TRAILS))) (*MESSAGE '(SHOW)))
   (QUICK-COMPILED-ASK
    '#,(METHOD-AT-POSITION ((SHOW) 0) PERFORMER)
    '#,(ACTOR-OF (QUOTE THE-TRAILS)))))) 
(DEFINE-FORM
 (APPEARANCE-SETUP-DRAW)
 (PENUP)
 (DIRECTOR-SETTURTLE
  (LET
   ((*MESSAGE '(RECALL YOUR STATE)))
   (QUICK-COMPILED-ASK
    '#,(METHOD-AT-POSITION ((RECALL YOUR STATE) 0) PERFORMER)
    '#,(ACTOR-OF (QUOTE PERFORMER)))))
 (EVAL
  (LET
   ((*MESSAGE '(RECALL YOUR DRAW-MODE)))
   (QUICK-COMPILED-ASK
    '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
    '#,(ACTOR-OF (QUOTE PERFORMER)))))) 
(DEFINE-FORM
 (APPEARANCE-SETUP-ERASE)
 (PENUP)
 (DIRECTOR-SETTURTLE
  (LET
   ((*MESSAGE '(RECALL YOUR STATE)))
   (QUICK-COMPILED-ASK
    '#,(METHOD-AT-POSITION ((RECALL YOUR STATE) 0) PERFORMER)
    '#,(ACTOR-OF (QUOTE PERFORMER)))))
 (EVAL
  (LET
   ((*MESSAGE '(RECALL YOUR ERASE-MODE)))
   (QUICK-COMPILED-ASK
    '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
    '#,(ACTOR-OF (QUOTE PERFORMER)))))) 
(DEFINE-FORM
 (GENERATE-APPEARANCE-CODE-FOR-PART PART WHOLE-ABSOLUTE-SIZE)
 (LET*
  (((NIL PART-SIZE (NIL DRAWING-FORM) SCALE (NIL HOW-TO-GET-TO-CENTER) (NIL PEN-COLOR))
    (COND ((LET
            ((MYSELF (ACTOR-OF PART)) (*MESSAGE '(RECALL YOUR HOW-TO-DRAW)))
            (QUICK-COMPILED-ASK
             '#,(METHOD-AT-POSITION ((RECALL YOUR HOW-TO-DRAW) 0) PERFORMER)
             '#,(ACTOR-OF (QUOTE PERFORMER)))))
          (T
           (LET
            ((MYSELF (ACTOR-OF PART)) (*MESSAGE '(FUSE YOUR PARTS)))
            (QUICK-COMPILED-ASK
             '#,(METHOD-AT-POSITION ((FUSE YOUR PARTS) 0) PERFORMER)
             '#,(ACTOR-OF (QUOTE PERFORMER))))
           (LET
            ((MYSELF (ACTOR-OF PART)) (*MESSAGE '(RECALL YOUR HOW-TO-DRAW)))
            (QUICK-COMPILED-ASK
             '#,(METHOD-AT-POSITION ((RECALL YOUR HOW-TO-DRAW) 0) PERFORMER)
             '#,(ACTOR-OF (QUOTE PERFORMER)))))))
   (HEADING-FROM-WHOLE
    (LET
     ((MYSELF (ACTOR-OF PART)) (*MESSAGE '(RECALL YOUR HEADING-FROM-WHOLE)))
     (QUICK-COMPILED-ASK
      '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
      '#,(ACTOR-OF (QUOTE PERFORMER)))))
   (DISTANCE-FROM-WHOLE
    (LET
     ((MYSELF (ACTOR-OF PART)) (*MESSAGE '(RECALL YOUR DISTANCE-FROM-WHOLE)))
     (QUICK-COMPILED-ASK
      '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
      '#,(ACTOR-OF (QUOTE PERFORMER)))))
   (RELATIVE-HEADING
    (LET
     ((MYSELF (ACTOR-OF PART)) (*MESSAGE '(RECALL YOUR RELATIVE-HEADING)))
     (QUICK-COMPILED-ASK
      '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
      '#,(ACTOR-OF (QUOTE PERFORMER)))))
   (HOW-TO-GET-TO-PART
    '(PROGN
      !,
        (COND ((FLONUM-EQUAL DISTANCE-FROM-WHOLE 0.0) NIL)
              ((FLONUM-EQUAL HEADING-FROM-WHOLE 0.0)
               '((FORWARD (*$ ,DISTANCE-FROM-WHOLE SIZE))))
              (T
               '((RIGHT ,HEADING-FROM-WHOLE)
                 (FORWARD (*$ ,DISTANCE-FROM-WHOLE SIZE))
                 (LEFT ,HEADING-FROM-WHOLE))))
      !,(COND ((NOT (FLONUM-EQUAL RELATIVE-HEADING 0.0)) '((RIGHT ,RELATIVE-HEADING))))))
   (SCALE-FACTOR (//$ (*$ SCALE PART-SIZE) WHOLE-ABSOLUTE-SIZE)))
  '(PROGN
    (THINGUP)
    ,HOW-TO-GET-TO-PART
    (LET
     ((*DIRECTOR-TURTLE-SCALING-FACTOR
       (*$ *DIRECTOR-TURTLE-SCALING-FACTOR SIZE ,SCALE-FACTOR)))
     ,HOW-TO-GET-TO-CENTER
     (PENCOLOR (QUOTE ,PEN-COLOR))
     (THINGDOWN)
     ,DRAWING-FORM
     (THINGUP)
     (PROGN !,(REVERSE-DISPLAY-LIST (REST HOW-TO-GET-TO-CENTER))))
    (PROGN !,(REVERSE-DISPLAY-LIST (REST HOW-TO-GET-TO-PART)))))) 
(DEFINE-FORM
 (RUN-LISP-FOR-PERFORMER ACTION)
 (LET
  ((VISIBLE
    (LET
     ((*MESSAGE '(RECALL YOUR VISIBILITY)))
     (QUICK-COMPILED-ASK
      '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
      '#,(ACTOR-OF (QUOTE PERFORMER)))))
   (PEN-STATE
    (LET
     ((*MESSAGE '(RECALL YOUR PEN-STATE)))
     (QUICK-COMPILED-ASK
      '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
      '#,(ACTOR-OF (QUOTE PERFORMER)))))
   (START-STATE
    (LET
     ((*MESSAGE '(RECALL YOUR STATE)))
     (QUICK-COMPILED-ASK
      '#,(METHOD-AT-POSITION ((RECALL YOUR STATE) 0) PERFORMER)
      '#,(ACTOR-OF (QUOTE PERFORMER))))))
  (AND
   VISIBLE
   (LET
    ((*MESSAGE '(HIDE)))
    (QUICK-COMPILED-ASK
     '#,(METHOD-AT-POSITION ((HIDE) 0) PERFORMER)
     '#,(ACTOR-OF (QUOTE PERFORMER)))))
  (LOGO-PENUP)
  (SETTURTLE START-STATE)
  (LET
   ((MYSELF (ACTOR-OF (QUOTE THE-TURTLE)))
    (*MESSAGE '(PERFORM ,(OR PEN-STATE '(PENUP)))))
   (QUICK-COMPILED-ASK
    '#,(METHOD-AT-POSITION (|(PERFORM %)| 0) THE-TURTLE)
    '#,(ACTOR-OF (QUOTE THE-TURTLE))))
  (EVAL ACTION)
  (LET
   ((NEW-STATE
     (LET
      ((*MESSAGE '(SET YOUR STATE TO (,($XCOR) ,($YCOR) ,($HEADING)))))
      (QUICK-COMPILED-ASK
       '#,(METHOD-AT-POSITION (|(SET YOUR STATE TO ?)| 0) PERFORMER)
       '#,(ACTOR-OF (QUOTE PERFORMER))))))
   (COND (PEN-STATE
          (LET
           ((MYSELF (ACTOR-OF (QUOTE THE-TRAILS)))
            (*MESSAGE '(MOVING FROM ,START-STATE TO ,NEW-STATE WITH ,PEN-STATE)))
           (QUICK-COMPILED-ASK
            '#,(METHOD-AT-POSITION (|(MOVING FROM ? TO ? WITH ?)| 0) THE-TRAILS)
            '#,(ACTOR-OF (QUOTE THE-TRAILS)))))))
  (COND (VISIBLE
         (LET
          ((*MESSAGE '(SHOW)))
          (QUICK-COMPILED-ASK
           '#,(METHOD-AT-POSITION ((SHOW) 0) PERFORMER)
           '#,(ACTOR-OF (QUOTE PERFORMER)))))
        (T NO-VALUE)))) 
(DEFINE-FORM
 (RECOMPUTE-RELATIVE-STATE NEW-STATE WHOLE WHOLE-STATE)
 (LET
  (((WHOLE-X WHOLE-Y WHOLE-HEADING) WHOLE-STATE))
  (THINGUP)
  (SETXY WHOLE-X WHOLE-Y)
  (LET
   ((*MESSAGE
     '(SET
       YOUR
       DISTANCE-FROM-WHOLE
       TO
       ,(//$ (RANGE NEW-STATE) (ASK ,WHOLE RECALL YOUR ABSOLUTE-SIZE)))))
   (QUICK-COMPILED-ASK
    '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
    '#,(ACTOR-OF (QUOTE PERFORMER))))
  (LET
   ((*MESSAGE '(SET YOUR HEADING-FROM-WHOLE TO ,(-$ (BEARING NEW-STATE) WHOLE-HEADING))))
   (QUICK-COMPILED-ASK
    '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
    '#,(ACTOR-OF (QUOTE PERFORMER))))
  (LET
   ((*MESSAGE '(SET YOUR RELATIVE-HEADING TO ,(-$ (THIRD NEW-STATE) WHOLE-HEADING))))
   (QUICK-COMPILED-ASK
    '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
    '#,(ACTOR-OF (QUOTE PERFORMER)))))) 
(DEFINE-FORM
 (RECOMPUTE-STATE WHOLE WHOLE-STATE)
 (COND (WHOLE
        (LET
         (((WHOLE-X WHOLE-Y WHOLE-HEADING) WHOLE-STATE))
         (THINGUP)
         (SETXY WHOLE-X WHOLE-Y)
         (SETHEADING WHOLE-HEADING)
         (RIGHT
          (LET
           ((*MESSAGE '(RECALL YOUR HEADING-FROM-WHOLE)))
           (QUICK-COMPILED-ASK
            '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
            '#,(ACTOR-OF (QUOTE PERFORMER)))))
         (FORWARD
          (*$
           (LET
            ((*MESSAGE '(RECALL YOUR DISTANCE-FROM-WHOLE)))
            (QUICK-COMPILED-ASK
             '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
             '#,(ACTOR-OF (QUOTE PERFORMER))))
           (LET
            ((MYSELF (ACTOR-OF WHOLE)) (*MESSAGE '(RECALL YOUR ABSOLUTE-SIZE)))
            (QUICK-COMPILED-ASK
             '#,(METHOD-AT-POSITION ((RECALL YOUR ABSOLUTE-SIZE) 0) PERFORMER)
             '#,(ACTOR-OF (QUOTE PERFORMER))))))
         (SETHEADING
          (+$
           (LET
            ((*MESSAGE '(RECALL YOUR RELATIVE-HEADING)))
            (QUICK-COMPILED-ASK
             '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
             '#,(ACTOR-OF (QUOTE PERFORMER))))
           WHOLE-HEADING))
         (LET
          ((*MESSAGE '(SET YOUR STATE TO (,($XCOR) ,($YCOR) ,($HEADING)))))
          (QUICK-COMPILED-ASK
           '#,(METHOD-AT-POSITION (|(SET YOUR STATE TO ?)| 0) PERFORMER)
           '#,(ACTOR-OF (QUOTE PERFORMER)))))))) 
(DEFINE-FORM
 (MAKE-INNER-DRAWER)
 (LET
  ((DRAW-PROCEDURE
    (LET
     ((*MESSAGE '(RECALL YOUR DRAW-PROCEDURE)))
     (QUICK-COMPILED-ASK
      '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
      '#,(ACTOR-OF (QUOTE PERFORMER))))))
  (COND (DRAW-PROCEDURE
         (CONS
          DRAW-PROCEDURE
          (MAPCAR
           (FUNCTION
            (LAMBDA (ARG)
              (COND ((OR (ATOM ARG) (REST ARG)) '(QUOTE ,(ASK MYSELF RECALL YOUR ,ARG)))
                    (T '(QUOTE ,(ASK MYSELF RECALL YOUR ,(FIRST ARG)))))))
           (LET
            ((*MESSAGE '(RECALL YOUR DRAWING-ARGS)))
            (QUICK-COMPILED-ASK
             '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
             '#,(ACTOR-OF (QUOTE PERFORMER)))))))))) 
(COMMENT NOW THE DEFINITIONS OF THE METHODS OF THE ABOVE ACTORS) 
(DEFUN D0368 NIL
  ((LAMBDA (FILE-NAME)
     (LET
      ((VISIBLE?
        (LET
         ((*MESSAGE '(RECALL YOUR VISIBILITY)))
         (QUICK-COMPILED-ASK
          '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
          '#,(ACTOR-OF (QUOTE PERFORMER))))))
      (AND
       VISIBLE?
       (LET
        ((*MESSAGE '(HIDE)))
        (QUICK-COMPILED-ASK
         '#,(METHOD-AT-POSITION ((HIDE) 0) PERFORMER)
         '#,(ACTOR-OF (QUOTE PERFORMER)))))
      (LET
       ((COMPILATION
         (RUN-WITH-METHOD-INVISIBLE
          (LET
           ((*MESSAGE '(!,*MESSAGE)))
           (COMPILED-ASK
            '#,(LIST
                (METHOD-AT-POSITION (|(SAVE ?)| 0) PERFORMER)
                (METHOD-AT-POSITION (|(SAVE %)| 0) SOMETHING))
            '#,(ACTOR-OF (QUOTE PERFORMER))))
          MYSELF
          *METHOD-BEING-RUN))
        (DRAW-PROCEDURES
         (LET
          ((*MESSAGE '(RECALL YOUR DRAW-PROCEDURES)))
          (QUICK-COMPILED-ASK
           '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
           '#,(ACTOR-OF (QUOTE PERFORMER))))))
       (AND
        VISIBLE?
        (LET
         ((*MESSAGE '(SHOW)))
         (QUICK-COMPILED-ASK
          '#,(METHOD-AT-POSITION ((SHOW) 0) PERFORMER)
          '#,(ACTOR-OF (QUOTE PERFORMER)))))
       (COND (FILE-NAME
              (LET
               ((FILE-OBJECT (OPEN FILE-NAME 'APPEND)))
               (MAPC
                (FUNCTION
                 (LAMBDA (PROCEDURE)
                   (DEFUNIZE
                    PROCEDURE
                    (GET-INTERPRETIVE-DEFINITION PROCEDURE)
                    FILE-OBJECT)))
                DRAW-PROCEDURES)
               (CLOSE FILE-OBJECT)))
             (T
              '(PROGN-COMPILE
                ,COMPILATION
                (MAPCAR
                 (FUNCTION
                  (LAMBDA (PROCEDURE)
                    (DEFUNIZE PROCEDURE (GET-INTERPRETIVE-DEFINITION PROCEDURE))))
                 DRAW-PROCEDURES)))))))
   (CADR *MESSAGE))) 
(DEFUN |(SAVE ?)| (OBJECT) (AND (EQ (CAR OBJECT) (QUOTE SAVE)) (ONE-LONG (CDR OBJECT)))) 
(DEFPROP |(SAVE ?)| (SAVE ?) PATTERN) 
(DEFUN D0367 NIL
  (AND
   (RUN-WITH-METHOD-INVISIBLE
    (LET
     ((*MESSAGE '(!,*MESSAGE)))
     (COMPILED-ASK
      '#,(LIST
          (METHOD-AT-POSITION ((UNMAKE) 0) PERFORMER)
          (METHOD-AT-POSITION ((UNMAKE) 0) SOMETHING))
      '#,(ACTOR-OF (QUOTE PERFORMER))))
    MYSELF
    *METHOD-BEING-RUN)
   (COND ((LET
           ((*MESSAGE '(RECALL YOUR VISIBILITY)))
           (QUICK-COMPILED-ASK
            '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
            '#,(ACTOR-OF (QUOTE PERFORMER))))
          (LET
           ((*MESSAGE '(HIDE)))
           (QUICK-COMPILED-ASK
            '#,(METHOD-AT-POSITION ((HIDE) 0) PERFORMER)
            '#,(ACTOR-OF (QUOTE PERFORMER)))))))) 
(DEFUN D0366 NIL
  ((LAMBDA (ANOTHER-PERFORMER INTERPOLATION-NAME)
     (LET
      ((INTERPOLATION-DRAWER (APPEND-ATOMS 'DRAW- INTERPOLATION-NAME))
       (TO-DRAW-SELF
        (DRAW-FORM
         (LET
          ((*MESSAGE '(RECALL YOUR HOW-TO-DRAW)))
          (QUICK-COMPILED-ASK
           '#,(METHOD-AT-POSITION ((RECALL YOUR HOW-TO-DRAW) 0) PERFORMER)
           '#,(ACTOR-OF (QUOTE PERFORMER))))))
       (TO-DRAW-OTHER
        (DRAW-FORM
         (LET
          ((MYSELF (ACTOR-OF ANOTHER-PERFORMER)) (*MESSAGE '(RECALL YOUR HOW-TO-DRAW)))
          (QUICK-COMPILED-ASK
           '#,(METHOD-AT-POSITION ((RECALL YOUR HOW-TO-DRAW) 0) PERFORMER)
           '#,(ACTOR-OF (QUOTE PERFORMER)))))))
      (PUTPROP
       INTERPOLATION-DRAWER
       '(LAMBDA (SIZE AMOUNT COLORS COLOR-CHANGE-FREQUENCY)
          (DISPLAY-INTERPOLATION
           (FLOAT AMOUNT)
           COLORS
           COLOR-CHANGE-FREQUENCY
           (QUOTE ,(INTERPOLATE-TWO-CALLS TO-DRAW-SELF TO-DRAW-OTHER))))
       'EXPR)
      (LET
       ((MYSELF (ACTOR-OF (QUOTE INTERPOLATION)))
        (*MESSAGE '(MAKE ,INTERPOLATION-NAME)))
       (QUICK-COMPILED-ASK
        '#,(METHOD-AT-POSITION (|(MAKE ?)| 0) PERFORMER)
        '#,(ACTOR-OF (QUOTE INTERPOLATION))))
      (LET
       ((MYSELF (ACTOR-OF INTERPOLATION-NAME))
        (*MESSAGE
         '(SET
           YOUR
           SIZE
           TO
           ,(INTEGER-AVERAGE
             '(,(ASK MYSELF RECALL YOUR SIZE) ,(ASK ,ANOTHER-PERFORMER RECALL YOUR SIZE)))))
        )
       (QUICK-COMPILED-ASK
        '#,(METHOD-AT-POSITION (|(SET YOUR SIZE TO ?)| 0) PERFORMER)
        '#,(ACTOR-OF (QUOTE PERFORMER))))
      (LET
       ((MYSELF (ACTOR-OF INTERPOLATION-NAME))
        (*MESSAGE
         '(WHEN                                   DRAWING
           USE                                    ,INTERPOLATION-DRAWER
           OF                                     SIZE
           AMOUNT                                 (COLORS)
           (COLOR-CHANGE-FREQUENCY))))
       (QUICK-COMPILED-ASK
        '#,(METHOD-AT-POSITION (|(WHEN DRAWING USE ? OF %)| 0) PERFORMER)
        '#,(ACTOR-OF (QUOTE PERFORMER))))
      INTERPOLATION-NAME))
   (CAR (CDDDDR *MESSAGE)) (CADR *MESSAGE))) 
(DEFUN |(MAKE ? INTERPOLATION TO ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE MAKE))
   (AND
    (EQ (CADDR OBJECT) (QUOTE INTERPOLATION))
    (AND (EQ (CADDDR OBJECT) (QUOTE TO)) (ONE-LONG (CDDDDR OBJECT)))))) 
(DEFPROP |(MAKE ? INTERPOLATION TO ?)| (MAKE ? INTERPOLATION TO ?) PATTERN) 
(DEFUN D0363 NIL
  ((LAMBDA (WHOLE)
     (LET
      ((OLD-WHOLE
        (LET
         ((*MESSAGE '(RECALL YOUR WHOLE)))
         (QUICK-COMPILED-ASK
          '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
          '#,(ACTOR-OF (QUOTE PERFORMER)))))
       (VISIBLE
        (LET
         ((*MESSAGE '(RECALL YOUR VISIBILITY)))
         (QUICK-COMPILED-ASK
          '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
          '#,(ACTOR-OF (QUOTE PERFORMER))))))
      (RUN-WITH-METHOD-INVISIBLE
       (LET
        ((*MESSAGE '(!,*MESSAGE)))
        (COMPILED-ASK
         '#,(LIST
             (METHOD-AT-POSITION (|(SET YOUR WHOLE TO ?)| 0) PERFORMER)
             (METHOD-AT-POSITION (|(SET YOUR WHOLE TO ?)| 0) SOMETHING))
         '#,(ACTOR-OF (QUOTE PERFORMER))))
       MYSELF
       *METHOD-BEING-RUN)
      (COND ((NOT (ACTOR-EQ (ACTOR-OF OLD-WHOLE T) (ACTOR-OF WHOLE T)))
             (COND (VISIBLE
                    (LET
                     ((MYSELF (ACTOR-OF WHOLE))
                      (*MESSAGE
                       '(SET
                         YOUR
                         VISIBLE-PARTS
                         TO
                         ,(CONS-IF-NOT-MEMBER
                           (QUOTE-IF-NEED-BE ,MYSELF)
                           (ASK ,WHOLE RECALL YOUR VISIBLE-PARTS)))))
                     (QUICK-COMPILED-ASK
                      '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
                      '#,(ACTOR-OF (QUOTE PERFORMER))))
                    (LET
                     ((MYSELF (ACTOR-OF WHOLE)) (*MESSAGE '(SET YOUR VISIBILITY TO T)))
                     (QUICK-COMPILED-ASK
                      '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
                      '#,(ACTOR-OF (QUOTE PERFORMER))))))
             (AND
              (EXISTS? OLD-WHOLE)
              (LET
               ((MYSELF (ACTOR-OF OLD-WHOLE))
                (*MESSAGE
                 '(SET
                   YOUR
                   VISIBLE-PARTS
                   TO
                   ,(SAFE-DELETE
                     (QUOTE-IF-NEED-BE ,MYSELF)
                     (ASK ,OLD-WHOLE RECALL YOUR VISIBLE-PARTS)))))
               (QUICK-COMPILED-ASK
                '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
                '#,(ACTOR-OF (QUOTE PERFORMER)))))
             (LET
              ((*MESSAGE '(SET YOUR VISIBILITY TO NIL)))
              (QUICK-COMPILED-ASK
               '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
               '#,(ACTOR-OF (QUOTE PERFORMER))))
             (LET
              ((*MESSAGE
                '(SET
                  YOUR
                  SIZE
                  TO
                  ,(//$
                    (*$ 1000.0 (ASK MYSELF RECALL YOUR ABSOLUTE-SIZE))
                    (ASK ,WHOLE RECALL YOUR ABSOLUTE-SIZE)))))
              (QUICK-COMPILED-ASK
               '#,(METHOD-AT-POSITION (|(SET YOUR SIZE TO ?)| 0) PERFORMER)
               '#,(ACTOR-OF (QUOTE PERFORMER))))
             (RECOMPUTE-RELATIVE-STATE
              (LET
               ((*MESSAGE '(RECALL YOUR STATE)))
               (QUICK-COMPILED-ASK
                '#,(METHOD-AT-POSITION ((RECALL YOUR STATE) 0) PERFORMER)
                '#,(ACTOR-OF (QUOTE PERFORMER))))
              WHOLE
              (LET
               ((MYSELF (ACTOR-OF WHOLE)) (*MESSAGE '(RECALL YOUR STATE)))
               (QUICK-COMPILED-ASK
                '#,(METHOD-AT-POSITION ((RECALL YOUR STATE) 0) PERFORMER)
                '#,(ACTOR-OF (QUOTE PERFORMER)))))
             (COND (VISIBLE
                    (LET
                     ((*MESSAGE '(SET YOUR VISIBILITY TO T)))
                     (QUICK-COMPILED-ASK
                      '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
                      '#,(ACTOR-OF (QUOTE PERFORMER)))))))))
     WHOLE)
   (CAR (CDDDDR *MESSAGE)))) 
(DEFUN D0362 NIL
  ((LAMBDA (MESSAGES)
     (LET
      ((ORIGINAL-STATE
        (LET
         ((*MESSAGE '(RECALL YOUR STATE)))
         (QUICK-COMPILED-ASK
          '#,(METHOD-AT-POSITION ((RECALL YOUR STATE) 0) PERFORMER)
          '#,(ACTOR-OF (QUOTE PERFORMER)))))
       (ORIGINAL-PEN-STATE
        (LET
         ((*MESSAGE '(RECALL YOUR PEN-STATE)))
         (QUICK-COMPILED-ASK
          '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
          '#,(ACTOR-OF (QUOTE PERFORMER)))))
       (ORIGINAL-PEN-TYPE
        (LET
         ((*MESSAGE '(RECALL YOUR PEN-TYPE)))
         (QUICK-COMPILED-ASK
          '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
          '#,(ACTOR-OF (QUOTE PERFORMER))))))
      (UNWIND-PROTECT
       (LET*
        ((DISPLAY-PACKAGE
          (DISPLAY-PACKAGE
           '(ASK
             ,MYSELF
             DO
             THE
             FOLLOWING
             (SET YOUR PEN-TYPE TO NORMAL)
             (PEN DOWN)
             !,MESSAGES
             (KEEP DOING UNTIL NULL TICK))))
         (DISPLAY-LIST (NREVERSE (GET DISPLAY-PACKAGE 'DISPLAY-LIST)))
         (DRAW-PROCEDURE-NAME (APPEND-ATOMS 'DRAW- (NAME-OF MYSELF))))
        (COND (DISPLAY-LIST
               (PUT-FUNCTION-DEFINITION
                DRAW-PROCEDURE-NAME
                '(LAMBDA (NIL) !,DISPLAY-LIST))
               (LET
                ((*MESSAGE '(WHEN DRAWING USE ,DRAW-PROCEDURE-NAME OF SIZE)))
                (QUICK-COMPILED-ASK
                 '#,(METHOD-AT-POSITION (|(WHEN DRAWING USE ? OF %)| 0) PERFORMER)
                 '#,(ACTOR-OF (QUOTE PERFORMER)))))
              (T (WARNING MYSELF '(|No appearance results from running| ,MESSAGES)))))
       (LET
        ((*MESSAGE '(SET YOUR STATE TO ,ORIGINAL-STATE)))
        (QUICK-COMPILED-ASK
         '#,(METHOD-AT-POSITION (|(SET YOUR STATE TO ?)| 0) PERFORMER)
         '#,(ACTOR-OF (QUOTE PERFORMER))))
       (LET
        ((*MESSAGE '(SET YOUR PEN-STATE TO ,ORIGINAL-PEN-STATE)))
        (QUICK-COMPILED-ASK
         '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
         '#,(ACTOR-OF (QUOTE PERFORMER))))
       (LET
        ((*MESSAGE '(SET YOUR PEN-TYPE TO ,ORIGINAL-PEN-TYPE)))
        (QUICK-COMPILED-ASK
         '#,(METHOD-AT-POSITION (|(SET YOUR PEN-TYPE TO ?)| 0) PERFORMER)
         '#,(ACTOR-OF (QUOTE PERFORMER)))))))
   (CDDDR *MESSAGE))) 
(DEFUN |(WHEN DRAWING DO %)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE WHEN))
   (AND (EQ (CADR OBJECT) (QUOTE DRAWING)) (EQ (CADDR OBJECT) (QUOTE DO))))) 
(DEFPROP |(WHEN DRAWING DO %)| (WHEN DRAWING DO %) PATTERN) 
(DEFUN D0360 NIL
  ((LAMBDA (DRAW-ARGS DRAW-PROCEDURE)
     (LET
      ((*MESSAGE '(SET YOUR DRAW-PROCEDURE TO ,DRAW-PROCEDURE)))
      (QUICK-COMPILED-ASK
       '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
       '#,(ACTOR-OF (QUOTE PERFORMER))))
     (COND ((NOT (INTERNEDP DRAW-PROCEDURE))
            (LET
             ((*MESSAGE
               '(SET
                 YOUR
                 DRAW-PROCEDURES
                 TO
                 ,(CONS-IF-NOT-MEMBER
                   (QUOTE-IF-NEED-BE ,DRAW-PROCEDURE)
                   (ASK MYSELF RECALL YOUR DRAW-PROCEDURES)))))
             (QUICK-COMPILED-ASK
              '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
              '#,(ACTOR-OF (QUOTE PERFORMER))))))
     (LET*
      (((SHAPE-ARGS NON-SHAPE-ARGS) (SEPERATE-SHAPE-ARGS DRAW-ARGS))
       (APPEARANCE-VARIABLES (UNION '(HOW-TO-DRAW COLORS) NON-SHAPE-ARGS)))
      (LET
       ((*MESSAGE '(SET YOUR DRAWING-ARGS TO ,DRAW-ARGS)))
       (QUICK-COMPILED-ASK
        '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
        '#,(ACTOR-OF (QUOTE PERFORMER))))
      (LET
       ((*MESSAGE '(SET YOUR NON-SHAPE-DRAWING-ARGS TO ,NON-SHAPE-ARGS)))
       (QUICK-COMPILED-ASK
        '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
        '#,(ACTOR-OF (QUOTE PERFORMER))))
      (LET
       ((*MESSAGE '(SET YOUR APPEARANCE-VARIABLES TO ,APPEARANCE-VARIABLES)))
       (QUICK-COMPILED-ASK
        '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
        '#,(ACTOR-OF (QUOTE PERFORMER))))
      (LET
       ((*MESSAGE
         '(SET
           YOUR
           VARIABLES-TO-COPY-UPON-CREATION
           TO
           ,(UNION
             APPEARANCE-VARIABLES
             (ASK MYSELF RECALL YOUR VARIABLES-TO-COPY-UPON-CREATION)))))
       (QUICK-COMPILED-ASK
        '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
        '#,(ACTOR-OF (QUOTE PERFORMER))))
      (MAPC
       (FUNCTION
        (LAMBDA (SHAPE-ARG)
          (COND ((EQ SHAPE-ARG 'SIZE))
                (T
                 (LET
                  ((*MESSAGE
                    '(DO
                      WHEN
                      RECEIVING
                      (SET YOUR ,SHAPE-ARG TO ?NEW-VALUE)
                      (DO-OLD-BEHAVIOR)
                      (ASK MYSELF SET YOUR VALIDITY-OF-HOW-TO-DRAW TO NIL)
                      NEW-VALUE)))
                  (QUICK-COMPILED-ASK
                   '#,(METHOD-AT-POSITION (|(DO WHEN RECEIVING ? %)| 0) SOMETHING)
                   '#,(ACTOR-OF (QUOTE PERFORMER))))))))
       SHAPE-ARGS)
      (MAPC
       (FUNCTION
        (LAMBDA (NON-SHAPE-ARG)
          (LET
           ((*MESSAGE
             '(DO
               WHEN
               RECEIVING
               (SET YOUR ,NON-SHAPE-ARG TO ?NEW-VALUE)
               (LET
                ((HOW-TO-DRAW (ASK MYSELF RECALL YOUR HOW-TO-DRAW)))
                (DO-OLD-BEHAVIOR)
                (ASK
                 MYSELF
                 SET
                 YOUR
                 HOW-TO-DRAW
                 TO
                 ,(COMMA
                   (AND HOW-TO-DRAW (REPLACE-NTH 2 HOW-TO-DRAW (MAKE-INNER-DRAWER))))))
               NEW-VALUE)))
           (QUICK-COMPILED-ASK
            '#,(METHOD-AT-POSITION (|(DO WHEN RECEIVING ? %)| 0) SOMETHING)
            '#,(ACTOR-OF (QUOTE PERFORMER))))))
       NON-SHAPE-ARGS))
     NO-VALUE)
   (CDR (CDDDDR *MESSAGE)) (CADDDR *MESSAGE))) 
(DEFUN |(WHEN DRAWING USE ? OF %)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE WHEN))
   (AND
    (EQ (CADR OBJECT) (QUOTE DRAWING))
    (AND (EQ (CADDR OBJECT) (QUOTE USE)) (EQ (CAR (CDDDDR OBJECT)) (QUOTE OF)))))) 
(DEFPROP |(WHEN DRAWING USE ? OF %)| (WHEN DRAWING USE ? OF %) PATTERN) 
(DEFUN D0358 NIL
  (LET
   ((VISIBLE-PARTS
     (LET
      ((*MESSAGE '(RECALL YOUR VISIBLE-PARTS)))
      (QUICK-COMPILED-ASK
       '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
       '#,(ACTOR-OF (QUOTE PERFORMER))))))
   (COND (VISIBLE-PARTS
          (LET
           ((DRAW-PROCEDURE
             (FUSE-PARTS
              VISIBLE-PARTS
              (LET
               ((*MESSAGE '(RECALL YOUR ABSOLUTE-SIZE)))
               (QUICK-COMPILED-ASK
                '#,(METHOD-AT-POSITION ((RECALL YOUR ABSOLUTE-SIZE) 0) PERFORMER)
                '#,(ACTOR-OF (QUOTE PERFORMER)))))))
           (LET
            ((*MESSAGE '(SET YOUR STANDARDIZE-SIZE? TO NIL)))
            (QUICK-COMPILED-ASK
             '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
             '#,(ACTOR-OF (QUOTE PERFORMER))))
           (LET
            ((*MESSAGE '(SET YOUR STANDARDIZE-CENTER? TO NIL)))
            (QUICK-COMPILED-ASK
             '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
             '#,(ACTOR-OF (QUOTE PERFORMER))))
           (LET
            ((*MESSAGE
              '(SET
                YOUR
                DRAW-PROCEDURES
                TO
                ,(APPLY 'UNION (ASK-EACH ,VISIBLE-PARTS RECALL YOUR DRAW-PROCEDURES)))))
            (QUICK-COMPILED-ASK
             '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
             '#,(ACTOR-OF (QUOTE PERFORMER))))
           (LET
            ((*MESSAGE '(WHEN DRAWING USE ,DRAW-PROCEDURE OF ABSOLUTE-SIZE)))
            (QUICK-COMPILED-ASK
             '#,(METHOD-AT-POSITION (|(WHEN DRAWING USE ? OF %)| 0) PERFORMER)
             '#,(ACTOR-OF (QUOTE PERFORMER))))
           (LET
            ((*PROTECT-ALL-ACTORS NIL))
            (LET
             ((*MESSAGE '(SEQUENTIALLY (ASK EACH OF YOUR VISIBLE-PARTS UNMAKE))))
             (QUICK-COMPILED-ASK
              '#,(METHOD-AT-POSITION
                  (|(SEQUENTIALLY (ASK EACH OF YOUR ? %) %)| 0)
                  SOMETHING)
              '#,(ACTOR-OF (QUOTE PERFORMER)))))
           (LET
            ((*MESSAGE '(REDISPLAY)))
            (QUICK-COMPILED-ASK
             '#,(METHOD-AT-POSITION ((REDISPLAY) 0) PERFORMER)
             '#,(ACTOR-OF (QUOTE PERFORMER))))))))) 
(DEFUN D0357 NIL
  (LET
   ((CURRENT-APPEARANCE
     (LET
      ((*MESSAGE '(RECALL YOUR CURRENT-APPEARANCE)))
      (QUICK-COMPILED-ASK
       '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
       '#,(ACTOR-OF (QUOTE PERFORMER)))))
    (CURRENT-APPEARANCE-AND-STATE
     (LET
      ((*MESSAGE '(RECALL YOUR CURRENT-APPEARANCE-AND-STATE)))
      (QUICK-COMPILED-ASK
       '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
       '#,(ACTOR-OF (QUOTE PERFORMER)))))
    (STATE-CHANGED
     (LET
      ((*MESSAGE '(RECALL YOUR STATE-CHANGED)))
      (QUICK-COMPILED-ASK
       '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
       '#,(ACTOR-OF (QUOTE PERFORMER))))))
   (LET
    ((APPEARANCE-CHANGED
      (OR
       (NULL CURRENT-APPEARANCE)
       (LET
        ((*MESSAGE '(RECALL YOUR APPEARANCE-CHANGED)))
        (QUICK-COMPILED-ASK
         '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
         '#,(ACTOR-OF (QUOTE PERFORMER)))))))
    (COND (APPEARANCE-CHANGED
           (SETQ CURRENT-APPEARANCE
                 (LET
                  ((MYSELF (ACTOR-OF (QUOTE APPEARANCE)))
                   (*MESSAGE '(MAKE APPEARANCE OF ,MYSELF)))
                  (QUICK-COMPILED-ASK
                   '#,(METHOD-AT-POSITION (|(MAKE APPEARANCE OF ?)| 0) APPEARANCE)
                   '#,(ACTOR-OF (QUOTE APPEARANCE)))))
           (LET
            ((*MESSAGE '(SET YOUR CURRENT-APPEARANCE TO ,CURRENT-APPEARANCE)))
            (QUICK-COMPILED-ASK
             '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
             '#,(ACTOR-OF (QUOTE PERFORMER))))
           (LET
            ((*MESSAGE '(SET YOUR APPEARANCE-CHANGED TO NIL)))
            (QUICK-COMPILED-ASK
             '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
             '#,(ACTOR-OF (QUOTE PERFORMER))))))
    (COND ((OR APPEARANCE-CHANGED STATE-CHANGED)
           (LET
            ((*MESSAGE '(SET YOUR STATE-CHANGED TO NIL)))
            (QUICK-COMPILED-ASK
             '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
             '#,(ACTOR-OF (QUOTE PERFORMER))))
           (SETQ CURRENT-APPEARANCE-AND-STATE
                 (LET
                  ((*MESSAGE
                    '(SET
                      YOUR
                      CURRENT-APPEARANCE-AND-STATE
                      TO
                      ,(COMPILE-USING
                        APPEARANCE
                        (ASK
                         ,CURRENT-APPEARANCE
                         MAKE
                         AN
                         INSTANCE
                         AT
                         ,(ASK MYSELF RECALL YOUR STATE))))))
                  (QUICK-COMPILED-ASK
                   '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
                   '#,(ACTOR-OF (QUOTE PERFORMER)))))))
    CURRENT-APPEARANCE-AND-STATE))) 
(DEFUN D0356 NIL
  (COND ((LET
          ((*MESSAGE '(RECALL YOUR VISIBILITY)))
          (QUICK-COMPILED-ASK
           '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
           '#,(ACTOR-OF (QUOTE PERFORMER))))
         (LET
          ((*MESSAGE '(ERASE)))
          (QUICK-COMPILED-ASK
           '#,(METHOD-AT-POSITION ((ERASE) 0) PERFORMER)
           '#,(ACTOR-OF (QUOTE PERFORMER))))
         (LET
          ((*MESSAGE '(DISPLAY)))
          (QUICK-COMPILED-ASK
           '#,(METHOD-AT-POSITION ((DISPLAY) 0) PERFORMER)
           '#,(ACTOR-OF (QUOTE PERFORMER))))))) 
(DEFUN D0355 NIL
  (LET
   ((PEN-TYPE
     (LET
      ((*MESSAGE '(RECALL YOUR PEN-TYPE)))
      (QUICK-COMPILED-ASK
       '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
       '#,(ACTOR-OF (QUOTE PERFORMER))))))
   (LET
    (
     (*MESSAGE
      '(SET
        YOUR
        PEN-STATE
        TO
        ,
         (COND ((EQ PEN-TYPE 'NORMAL) '(PENDOWN))
               ((EQ PEN-TYPE 'XOR) '(XORDOWN))
               ((EQ PEN-TYPE 'ERASER) '(ERASERDOWN))
               (T
                (WARNING
                 MYSELF
                 '(|My pen-type| ,PEN-TYPE |is invalid so Pen Down message ignored|)))))))
    (QUICK-COMPILED-ASK
     '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
     '#,(ACTOR-OF (QUOTE PERFORMER)))))) 
(DEFUN D0354 NIL
  (LET
   ((*MESSAGE '(SET YOUR PEN-STATE TO NIL)))
   (QUICK-COMPILED-ASK
    '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
    '#,(ACTOR-OF (QUOTE PERFORMER))))) 
(DEFUN D0353 NIL
  ((LAMBDA (NEW-PEN-TYPE)
     (RUN-WITH-METHOD-INVISIBLE
      (LET
       ((*MESSAGE '(!,*MESSAGE)))
       (COMPILED-ASK
        '#,(LIST
            (METHOD-AT-POSITION (|(SET YOUR PEN-TYPE TO ?)| 0) PERFORMER)
            (METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING))
        '#,(ACTOR-OF (QUOTE PERFORMER))))
      MYSELF
      *METHOD-BEING-RUN)
     (COND ((LET
             ((*MESSAGE '(RECALL YOUR PEN-STATE)))
             (QUICK-COMPILED-ASK
              '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
              '#,(ACTOR-OF (QUOTE PERFORMER))))
            (LET
             ((*MESSAGE '(PEN DOWN)))
             (QUICK-COMPILED-ASK
              '#,(METHOD-AT-POSITION ((PEN DOWN) 0) PERFORMER)
              '#,(ACTOR-OF (QUOTE PERFORMER))))))
     NEW-PEN-TYPE)
   (CAR (CDDDDR *MESSAGE)))) 
(DEFUN |(SET YOUR PEN-TYPE TO ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE SET))
   (AND
    (EQ (CADR OBJECT) (QUOTE YOUR))
    (AND
     (EQ (CADDR OBJECT) (QUOTE PEN-TYPE))
     (AND (EQ (CADDDR OBJECT) (QUOTE TO)) (ONE-LONG (CDDDDR OBJECT))))))) 
(DEFPROP |(SET YOUR PEN-TYPE TO ?)| (SET YOUR PEN-TYPE TO ?) PATTERN) 
(DEFUN D0352 NIL ((LAMBDA (ACTION) (RUN-LISP-FOR-PERFORMER ACTION)) (CADR *MESSAGE))) 
(DEFUN |(RUN ?)| (OBJECT) (AND (EQ (CAR OBJECT) (QUOTE RUN)) (ONE-LONG (CDR OBJECT)))) 
(DEFPROP |(RUN ?)| (RUN ?) PATTERN) 
(DEFUN D0351 NIL ((LAMBDA (FORM) (RUN-LISP-FOR-PERFORMER FORM)) *MESSAGE)) 
(DEFUN |({or DELX DELY SETX SETY} ?)| (OBJECT)
  (AND (MEMQ (CAR OBJECT) (QUOTE (DELX DELY SETX SETY))) (ONE-LONG (CDR OBJECT)))) 
(DEFPROP |({or DELX DELY SETX SETY} ?)| ({or DELX DELY SETX SETY} ?) PATTERN) 
(DEFUN D0350 NIL
  ((LAMBDA (AMOUNT DIRECTION) (RUN-LISP-FOR-PERFORMER '(,DIRECTION ,AMOUNT)))
   (CADDR *MESSAGE) (CADR *MESSAGE))) 
(DEFUN |(TURN {MEMQ ? '(RIGHT LEFT)} ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE TURN))
   (AND (LET ((? (CADR OBJECT))) (MEMQ ? '(RIGHT LEFT))) (ONE-LONG (CDDR OBJECT))))) 
(DEFPROP |(TURN {MEMQ ? '(RIGHT LEFT)} ?)| (TURN {MEMQ ? '(RIGHT LEFT)} ?) PATTERN) 
(DEFUN D0349 NIL
  ((LAMBDA (AMOUNT DIRECTION) (RUN-LISP-FOR-PERFORMER '(,DIRECTION ,AMOUNT)))
   (CADDR *MESSAGE) (CADR *MESSAGE))) 
(DEFUN |(MOVE {MEMQ ? '(FORWARD BACK)} ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE MOVE))
   (AND (LET ((? (CADR OBJECT))) (MEMQ ? '(FORWARD BACK))) (ONE-LONG (CDDR OBJECT))))) 
(DEFPROP |(MOVE {MEMQ ? '(FORWARD BACK)} ?)| (MOVE {MEMQ ? '(FORWARD BACK)} ?) PATTERN) 
(DEFUN D0348 NIL
  ((LAMBDA (AMOUNT) (RUN-LISP-FOR-PERFORMER '(DELY ,(-$ (FLOAT AMOUNT)))))
   (CADDR *MESSAGE))) 
(DEFUN |(MOVE DOWN ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE MOVE))
   (AND (EQ (CADR OBJECT) (QUOTE DOWN)) (ONE-LONG (CDDR OBJECT))))) 
(DEFPROP |(MOVE DOWN ?)| (MOVE DOWN ?) PATTERN) 
(DEFUN D0347 NIL
  ((LAMBDA (AMOUNT) (RUN-LISP-FOR-PERFORMER '(DELY ,AMOUNT))) (CADDR *MESSAGE))) 
(DEFUN |(MOVE UP ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE MOVE))
   (AND (EQ (CADR OBJECT) (QUOTE UP)) (ONE-LONG (CDDR OBJECT))))) 
(DEFPROP |(MOVE UP ?)| (MOVE UP ?) PATTERN) 
(DEFUN D0346 NIL
  ((LAMBDA (AMOUNT) (RUN-LISP-FOR-PERFORMER '(DELX ,AMOUNT))) (CADDR *MESSAGE))) 
(DEFUN |(MOVE RIGHT ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE MOVE))
   (AND (EQ (CADR OBJECT) (QUOTE RIGHT)) (ONE-LONG (CDDR OBJECT))))) 
(DEFPROP |(MOVE RIGHT ?)| (MOVE RIGHT ?) PATTERN) 
(DEFUN D0345 NIL
  ((LAMBDA (AMOUNT) (RUN-LISP-FOR-PERFORMER '(DELX ,(-$ (FLOAT AMOUNT)))))
   (CADDR *MESSAGE))) 
(DEFUN |(MOVE LEFT ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE MOVE))
   (AND (EQ (CADR OBJECT) (QUOTE LEFT)) (ONE-LONG (CDDR OBJECT))))) 
(DEFPROP |(MOVE LEFT ?)| (MOVE LEFT ?) PATTERN) 
(DEFUN D0344 NIL ((LAMBDA (FORM) (RUN-LISP-FOR-PERFORMER FORM)) *MESSAGE)) 
(DEFUN |({or SETXY DELXY} ? ?)| (OBJECT)
  (AND (MEMQ (CAR OBJECT) (QUOTE (SETXY DELXY))) (ONE-LONG (CDDR OBJECT)))) 
(DEFPROP |({or SETXY DELXY} ? ?)| ({or SETXY DELXY} ? ?) PATTERN) 
(DEFPROP |MACRO-(SETHEADING ?NEW-HEADING)PERFORMER| T MACRO-DEFINITION-FORM) 
(DEFINE-MACRO
 (|MACRO-(SETHEADING ?NEW-HEADING)PERFORMER| MYSELF MESSAGE-FORM)
 ((LAMBDA (NEW-HEADING) '(ASK ,MYSELF SET YOUR HEADING TO ,NEW-HEADING))
  (CADR MESSAGE-FORM))) 
(DEFUN |(SETHEADING ?)| (OBJECT)
  (AND (EQ (CAR OBJECT) (QUOTE SETHEADING)) (ONE-LONG (CDR OBJECT)))) 
(DEFPROP |(SETHEADING ?)| (SETHEADING ?) PATTERN) 
(DEFPROP |MACRO-(SETTURTLE ?NEW-STATE)PERFORMER| T MACRO-DEFINITION-FORM) 
(DEFINE-MACRO
 (|MACRO-(SETTURTLE ?NEW-STATE)PERFORMER| MYSELF MESSAGE-FORM)
 ((LAMBDA (NEW-STATE) '(ASK ,MYSELF SET YOUR STATE TO ,NEW-STATE)) (CADR MESSAGE-FORM))) 
(DEFUN |(SETTURTLE ?)| (OBJECT)
  (AND (EQ (CAR OBJECT) (QUOTE SETTURTLE)) (ONE-LONG (CDR OBJECT)))) 
(DEFPROP |(SETTURTLE ?)| (SETTURTLE ?) PATTERN) 
(DEFUN D0342 NIL
  ((LAMBDA (NEW-STATE)
     (LET
      ((VISIBLE?
        (LET
         ((*MESSAGE '(RECALL YOUR VISIBILITY)))
         (QUICK-COMPILED-ASK
          '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
          '#,(ACTOR-OF (QUOTE PERFORMER)))))
       (WHOLE
        (LET
         ((*MESSAGE '(RECALL YOUR WHOLE)))
         (QUICK-COMPILED-ASK
          '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
          '#,(ACTOR-OF (QUOTE PERFORMER)))))
       (OLD-STATE
        (RUN-WITH-METHOD-INVISIBLE
         (LET
          ((*MESSAGE '(RECALL YOUR STATE)))
          (QUICK-COMPILED-ASK
           '#,(METHOD-AT-POSITION ((RECALL YOUR STATE) 0) PERFORMER)
           '#,(ACTOR-OF (QUOTE PERFORMER))))
         MYSELF
         *METHOD-BEING-RUN))
       (NEW-STATE (MAPCAR 'FLOAT NEW-STATE)))
      (COND ((NOT (STATE-EQUAL OLD-STATE NEW-STATE))
             (COND (VISIBLE?
                    (LET
                     ((*MESSAGE '(HIDE)))
                     (QUICK-COMPILED-ASK
                      '#,(METHOD-AT-POSITION ((HIDE) 0) PERFORMER)
                      '#,(ACTOR-OF (QUOTE PERFORMER))))))
             (COND (WHOLE
                    (RECOMPUTE-RELATIVE-STATE
                     NEW-STATE
                     WHOLE
                     (LET
                      ((MYSELF (ACTOR-OF WHOLE)) (*MESSAGE '(RECALL YOUR STATE)))
                      (QUICK-COMPILED-ASK
                       '#,(METHOD-AT-POSITION ((RECALL YOUR STATE) 0) PERFORMER)
                       '#,(ACTOR-OF (QUOTE PERFORMER)))))))
             (LET
              ((*MESSAGE '(SET YOUR STATE-CHANGED TO T)))
              (QUICK-COMPILED-ASK
               '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
               '#,(ACTOR-OF (QUOTE PERFORMER))))
             (RUN-WITH-METHOD-INVISIBLE
              (LET
               ((*MESSAGE '(SET YOUR STATE TO ,NEW-STATE)))
               (QUICK-COMPILED-ASK
                '#,(METHOD-AT-POSITION (|(SET YOUR STATE TO ?)| 0) PERFORMER)
                '#,(ACTOR-OF (QUOTE PERFORMER))))
              MYSELF
              *METHOD-BEING-RUN)
             (LET
              ((*MESSAGE
                '(SEQUENTIALLY
                  (ASK EACH OF YOUR PARTS NOTICE THAT STATE OF ,MYSELF IS NOW ,NEW-STATE))))
              (QUICK-COMPILED-ASK
               '#,(METHOD-AT-POSITION
                   (|(SEQUENTIALLY (ASK EACH OF YOUR ? %) %)| 0)
                   SOMETHING)
               '#,(ACTOR-OF (QUOTE PERFORMER))))
             (COND (VISIBLE?
                    (LET
                     ((*MESSAGE '(SHOW)))
                     (QUICK-COMPILED-ASK
                      '#,(METHOD-AT-POSITION ((SHOW) 0) PERFORMER)
                      '#,(ACTOR-OF (QUOTE PERFORMER))))))))
      NEW-STATE))
   (CAR (CDDDDR *MESSAGE)))) 
(DEFUN D0341 NIL
  ((LAMBDA (WHOLE-STATE WHOLE) (RECOMPUTE-STATE WHOLE WHOLE-STATE))
   (CADDDR (CDDDDR *MESSAGE)) (CAR (CDDDDR *MESSAGE)))) 
(DEFUN |(NOTICE THAT STATE OF ? IS NOW ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE NOTICE))
   (AND
    (EQ (CADR OBJECT) (QUOTE THAT))
    (AND
     (EQ (CADDR OBJECT) (QUOTE STATE))
     (AND
      (EQ (CADDDR OBJECT) (QUOTE OF))
      (AND
       (EQ (CADR (CDDDDR OBJECT)) (QUOTE IS))
       (AND (EQ (CADDR (CDDDDR OBJECT)) (QUOTE NOW)) (ONE-LONG (CDDDR (CDDDDR OBJECT)))))))))
  ) 
(DEFPROP |(NOTICE THAT STATE OF ? IS NOW ?)| (NOTICE THAT STATE OF ? IS NOW ?) PATTERN) 
(DEFUN D0340 NIL
  ((LAMBDA (WHOLE-STATE WHOLE) (RECOMPUTE-STATE WHOLE WHOLE-STATE))
   (CADDDR (CDDDDR *MESSAGE)) (CAR (CDDDDR *MESSAGE)))) 
(DEFUN |(RECOMPUTE YOUR STATE SINCE ? IS NOW ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE RECOMPUTE))
   (AND
    (EQ (CADR OBJECT) (QUOTE YOUR))
    (AND
     (EQ (CADDR OBJECT) (QUOTE STATE))
     (AND
      (EQ (CADDDR OBJECT) (QUOTE SINCE))
      (AND
       (EQ (CADR (CDDDDR OBJECT)) (QUOTE IS))
       (AND (EQ (CADDR (CDDDDR OBJECT)) (QUOTE NOW)) (ONE-LONG (CDDDR (CDDDDR OBJECT)))))))))
  ) 
(DEFPROP
 |(RECOMPUTE YOUR STATE SINCE ? IS NOW ?)|
 (RECOMPUTE YOUR STATE SINCE ? IS NOW ?)
 PATTERN) 
(DEFUN D0339 NIL
  (OR
   (RUN-WITH-METHOD-INVISIBLE
    (LET
     ((*MESSAGE '(RECALL YOUR STATE)))
     (COMPILED-ASK
      '#,(LIST
          (METHOD-AT-POSITION ((RECALL YOUR STATE) 0) PERFORMER)
          (METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING))
      '#,(ACTOR-OF (QUOTE PERFORMER))))
    MYSELF
    *METHOD-BEING-RUN)
   (LET
    ((WHOLE
      (LET
       ((*MESSAGE '(RECALL YOUR WHOLE)))
       (QUICK-COMPILED-ASK
        '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
        '#,(ACTOR-OF (QUOTE PERFORMER))))))
    (COND (WHOLE
           (LET
            ((*MESSAGE
              '(RECOMPUTE YOUR STATE SINCE ,WHOLE IS NOW ,(ASK ,WHOLE RECALL YOUR STATE))))
            (QUICK-COMPILED-ASK
             '#,(METHOD-AT-POSITION
                 (|(RECOMPUTE YOUR STATE SINCE ? IS NOW ?)| 0)
                 PERFORMER)
             '#,(ACTOR-OF (QUOTE PERFORMER))))))))) 
(DEFUN D0338 NIL
  ((LAMBDA (Y X)
     (PENUP)
     (SETXY X Y)
     (BEARING
      (LET
       ((*MESSAGE '(RECALL YOUR STATE)))
       (QUICK-COMPILED-ASK
        '#,(METHOD-AT-POSITION ((RECALL YOUR STATE) 0) PERFORMER)
        '#,(ACTOR-OF (QUOTE PERFORMER))))))
   (CADR (CADDDR *MESSAGE)) (CAR (CADDDR *MESSAGE)))) 
(DEFUN |(YIELD HEADING FROM (? ? %))| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE YIELD))
   (AND
    (EQ (CADR OBJECT) (QUOTE HEADING))
    (AND
     (EQ (CADDR OBJECT) (QUOTE FROM))
     (AND
      (AND (LISTP (CADDDR OBJECT)) (LISTP (CDR (CADDDR OBJECT))))
      (NULL (CDDDDR OBJECT))))))) 
(DEFPROP |(YIELD HEADING FROM (? ? %))| (YIELD HEADING FROM (? ? %)) PATTERN) 
(DEFUN D0337 NIL
  ((LAMBDA (Y X)
     (PENUP)
     (SETTURTLE
      (LET
       ((*MESSAGE '(RECALL YOUR STATE)))
       (QUICK-COMPILED-ASK
        '#,(METHOD-AT-POSITION ((RECALL YOUR STATE) 0) PERFORMER)
        '#,(ACTOR-OF (QUOTE PERFORMER)))))
     (BEARING X Y))
   (CADR (CADDDR *MESSAGE)) (CAR (CADDDR *MESSAGE)))) 
(DEFUN |(YIELD HEADING TO (? ? %))| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE YIELD))
   (AND
    (EQ (CADR OBJECT) (QUOTE HEADING))
    (AND
     (EQ (CADDR OBJECT) (QUOTE TO))
     (AND
      (AND (LISTP (CADDDR OBJECT)) (LISTP (CDR (CADDDR OBJECT))))
      (NULL (CDDDDR OBJECT))))))) 
(DEFPROP |(YIELD HEADING TO (? ? %))| (YIELD HEADING TO (? ? %)) PATTERN) 
(DEFUN D0336 NIL
  ((LAMBDA (Y X)
     (PENUP)
     (SETTURTLE
      (LET
       ((*MESSAGE '(RECALL YOUR STATE)))
       (QUICK-COMPILED-ASK
        '#,(METHOD-AT-POSITION ((RECALL YOUR STATE) 0) PERFORMER)
        '#,(ACTOR-OF (QUOTE PERFORMER)))))
     (RANGE X Y))
   (CADR (CADDDR *MESSAGE)) (CAR (CADDDR *MESSAGE)))) 
(DEFUN |(YIELD DISTANCE TO (? ? %))| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE YIELD))
   (AND
    (EQ (CADR OBJECT) (QUOTE DISTANCE))
    (AND
     (EQ (CADDR OBJECT) (QUOTE TO))
     (AND
      (AND (LISTP (CADDDR OBJECT)) (LISTP (CDR (CADDDR OBJECT))))
      (NULL (CDDDDR OBJECT))))))) 
(DEFPROP |(YIELD DISTANCE TO (? ? %))| (YIELD DISTANCE TO (? ? %)) PATTERN) 
(DEFUN D0335 NIL
  ((LAMBDA (FOLLOWUP COLORS UNITS NUMBER)
     (LET
      ((*MESSAGE '(PREPARE TO MIX COLORS WITH ,COLORS)))
      (QUICK-COMPILED-ASK
       '#,(METHOD-AT-POSITION (|(PREPARE TO MIX COLORS WITH ?)| 0) PERFORMER)
       '#,(ACTOR-OF (QUOTE PERFORMER))))
     (LET
      ((*MESSAGE
        '(SET
          YOUR
          (INCREMENT YOUR COLOR-MIX BY SPEED)
          TO
          ,(//$ (NUMBER-OF-TICKS NUMBER UNITS)))))
      (QUICK-COMPILED-ASK
       '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
       '#,(ACTOR-OF (QUOTE PERFORMER))))
     (LET
      ((*MESSAGE '(SEQUENTIALLY (GRADUALLY INCREMENT YOUR COLOR-MIX BY 1.0) !,FOLLOWUP)))
      (QUICK-COMPILED-ASK
       '#,(METHOD-AT-POSITION (|(SEQUENTIALLY (GRADUALLY % ?) %)| 0) SOMETHING)
       '#,(ACTOR-OF (QUOTE PERFORMER)))))
   (CDDR *MESSAGE) (CADDR (CDDDDR (CDDADR *MESSAGE))) (CADR (CDDADR *MESSAGE))
   (CAR (CDDADR *MESSAGE)))) 
(DEFUN |(SEQUENTIALLY (DO IN ? ? {or CHANGE SET} YOUR COLORS TO ?) %)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE SEQUENTIALLY))
   (AND
    (LISTP (CADR OBJECT))
    (EQ (CAADR OBJECT) (QUOTE DO))
    (AND
     (LISTP (CDADR OBJECT))
     (EQ (CADADR OBJECT) (QUOTE IN))
     (AND
      (LISTP (CDDADR OBJECT))
      (AND
       (LISTP (CDR (CDDADR OBJECT)))
       (AND
        (LISTP (CDDR (CDDADR OBJECT)))
        (MEMQ (CADDR (CDDADR OBJECT)) (QUOTE (CHANGE SET)))
        (AND
         (LISTP (CDDDR (CDDADR OBJECT)))
         (EQ (CADDDR (CDDADR OBJECT)) (QUOTE YOUR))
         (AND
          (LISTP (CDDDDR (CDDADR OBJECT)))
          (EQ (CAR (CDDDDR (CDDADR OBJECT))) (QUOTE COLORS))
          (AND
           (LISTP (CDR (CDDDDR (CDDADR OBJECT))))
           (EQ (CADR (CDDDDR (CDDADR OBJECT))) (QUOTE TO))
           (ONE-LONG (CDDR (CDDDDR (CDDADR OBJECT)))))))))))))) 
(DEFPROP
 |(SEQUENTIALLY (DO IN ? ? {or CHANGE SET} YOUR COLORS TO ?) %)|
 (SEQUENTIALLY (DO IN ? ? {or CHANGE SET} YOUR COLORS TO ?) %)
 PATTERN) 
(DEFUN D0334 NIL
  ((LAMBDA (COLORS)
     (LET
      ((*MESSAGE
        '(DO
          WHEN
          RECEIVING
          (SET YOUR COLOR-MIX TO ?NEW-VALUE)
          (LET
           ((OLD-COLORS (ASK MYSELF RECALL YOUR COLORS)))
           (ASK
            MYSELF
            SET
            YOUR
            COLORS
            TO
            ,(COMMA
              (MIX-COLORS
               OLD-COLORS
               (COLOR-DIFFERENCES OLD-COLORS (QUOTE ,COLORS))
               NEW-VALUE)))
           (DO-OLD-BEHAVIOR)))))
      (QUICK-COMPILED-ASK
       '#,(METHOD-AT-POSITION (|(DO WHEN RECEIVING ? %)| 0) SOMETHING)
       '#,(ACTOR-OF (QUOTE PERFORMER)))))
   (CADR (CDDDDR *MESSAGE)))) 
(DEFUN |(PREPARE TO MIX COLORS WITH ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE PREPARE))
   (AND
    (EQ (CADR OBJECT) (QUOTE TO))
    (AND
     (EQ (CADDR OBJECT) (QUOTE MIX))
     (AND
      (EQ (CADDDR OBJECT) (QUOTE COLORS))
      (AND (EQ (CAR (CDDDDR OBJECT)) (QUOTE WITH)) (ONE-LONG (CDR (CDDDDR OBJECT))))))))) 
(DEFPROP |(PREPARE TO MIX COLORS WITH ?)| (PREPARE TO MIX COLORS WITH ?) PATTERN) 
(DEFPROP |MACRO-(SHRINK ?AMOUNT)PERFORMER| T MACRO-DEFINITION-FORM) 
(DEFINE-MACRO
 (|MACRO-(SHRINK ?AMOUNT)PERFORMER| MYSELF MESSAGE-FORM)
 ((LAMBDA (AMOUNT)
    '(ASK ,MYSELF INCREMENT YOUR SIZE BY `(MINUS (QUOTE-IF-NEED-BE ,AMOUNT))))
  (CADR MESSAGE-FORM))) 
(DEFUN |(SHRINK ?)| (OBJECT)
  (AND (EQ (CAR OBJECT) (QUOTE SHRINK)) (ONE-LONG (CDR OBJECT)))) 
(DEFPROP |(SHRINK ?)| (SHRINK ?) PATTERN) 
(DEFPROP |MACRO-({or GROW SHRINK} BY FACTOR ?FACTOR)PERFORMER| T MACRO-DEFINITION-FORM) 
(DEFINE-MACRO
 (|MACRO-({or GROW SHRINK} BY FACTOR ?FACTOR)PERFORMER| MYSELF MESSAGE-FORM)
 ((LAMBDA (FACTOR) '(ASK ,MYSELF MULTIPLY YOUR SIZE BY ,FACTOR)) (CADDDR MESSAGE-FORM))) 
(DEFUN |({or GROW SHRINK} BY FACTOR ?)| (OBJECT)
  (AND
   (MEMQ (CAR OBJECT) (QUOTE (GROW SHRINK)))
   (AND
    (EQ (CADR OBJECT) (QUOTE BY))
    (AND (EQ (CADDR OBJECT) (QUOTE FACTOR)) (ONE-LONG (CDDDR OBJECT)))))) 
(DEFPROP |({or GROW SHRINK} BY FACTOR ?)| ({or GROW SHRINK} BY FACTOR ?) PATTERN) 
(DEFPROP |MACRO-(GROW ?AMOUNT)PERFORMER| T MACRO-DEFINITION-FORM) 
(DEFINE-MACRO
 (|MACRO-(GROW ?AMOUNT)PERFORMER| MYSELF MESSAGE-FORM)
 ((LAMBDA (AMOUNT) '(ASK ,MYSELF INCREMENT YOUR SIZE BY ,AMOUNT)) (CADR MESSAGE-FORM))) 
(DEFUN |(GROW ?)| (OBJECT) (AND (EQ (CAR OBJECT) (QUOTE GROW)) (ONE-LONG (CDR OBJECT)))) 
(DEFPROP |(GROW ?)| (GROW ?) PATTERN) 
(DEFUN D0333 NIL ((LAMBDA (FORM) (RUN-LISP-FOR-PERFORMER FORM)) *MESSAGE)) 
(DEFUN |({or FD FORWARD BK BACK RT RIGHT LT LEFT} ?)| (OBJECT)
  (AND
   (MEMQ (CAR OBJECT) (QUOTE (FD FORWARD BK BACK RT RIGHT LT LEFT)))
   (ONE-LONG (CDR OBJECT)))) 
(DEFPROP
 |({or FD FORWARD BK BACK RT RIGHT LT LEFT} ?)|
 ({or FD FORWARD BK BACK RT RIGHT LT LEFT} ?)
 PATTERN) 
(DEFUN D0332 NIL
  ((LAMBDA (NEW-VALUE)
     (COND ((AND
             (NOT NEW-VALUE)
             (LET
              ((*MESSAGE '(RECALL YOUR VISIBILITY)))
              (QUICK-COMPILED-ASK
               '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
               '#,(ACTOR-OF (QUOTE PERFORMER)))))
            (LET
             ((*MESSAGE '(HIDE)))
             (QUICK-COMPILED-ASK
              '#,(METHOD-AT-POSITION ((HIDE) 0) PERFORMER)
              '#,(ACTOR-OF (QUOTE PERFORMER))))
            (RUN-WITH-METHOD-INVISIBLE
             (LET
              ((*MESSAGE '(!,*MESSAGE)))
              (COMPILED-ASK
               '#,(LIST
                   (METHOD-AT-POSITION
                    (|(SET YOUR VALIDITY-OF-HOW-TO-DRAW TO ?)| 0)
                    PERFORMER)
                   (METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING))
               '#,(ACTOR-OF (QUOTE PERFORMER))))
             MYSELF
             *METHOD-BEING-RUN)
            (LET
             ((*MESSAGE '(SHOW)))
             (QUICK-COMPILED-ASK
              '#,(METHOD-AT-POSITION ((SHOW) 0) PERFORMER)
              '#,(ACTOR-OF (QUOTE PERFORMER))))
            NEW-VALUE)
           (T
            (RUN-WITH-METHOD-INVISIBLE
             (LET
              ((*MESSAGE '(!,*MESSAGE)))
              (COMPILED-ASK
               '#,(LIST
                   (METHOD-AT-POSITION
                    (|(SET YOUR VALIDITY-OF-HOW-TO-DRAW TO ?)| 0)
                    PERFORMER)
                   (METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING))
               '#,(ACTOR-OF (QUOTE PERFORMER))))
             MYSELF
             *METHOD-BEING-RUN))))
   (CAR (CDDDDR *MESSAGE)))) 
(DEFUN |(SET YOUR VALIDITY-OF-HOW-TO-DRAW TO ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE SET))
   (AND
    (EQ (CADR OBJECT) (QUOTE YOUR))
    (AND
     (EQ (CADDR OBJECT) (QUOTE VALIDITY-OF-HOW-TO-DRAW))
     (AND (EQ (CADDDR OBJECT) (QUOTE TO)) (ONE-LONG (CDDDDR OBJECT))))))) 
(DEFPROP
 |(SET YOUR VALIDITY-OF-HOW-TO-DRAW TO ?)|
 (SET YOUR VALIDITY-OF-HOW-TO-DRAW TO ?)
 PATTERN) 
(DEFUN D0331 NIL
  ((LAMBDA (NEW-COLORS)
     (LET
      ((HOW-TO-DRAW
        (LET
         ((*MESSAGE '(RECALL YOUR HOW-TO-DRAW)))
         (QUICK-COMPILED-ASK
          '#,(METHOD-AT-POSITION ((RECALL YOUR HOW-TO-DRAW) 0) PERFORMER)
          '#,(ACTOR-OF (QUOTE PERFORMER))))))
      (LET
       ((*MESSAGE
         '(SET
           YOUR
           HOW-TO-DRAW
           TO
           ,(AND HOW-TO-DRAW (REPLACE-NTH 5 HOW-TO-DRAW '(QUOTE ,(FIRST NEW-COLORS)))))))
       (QUICK-COMPILED-ASK
        '#,(METHOD-AT-POSITION (|(SET YOUR HOW-TO-DRAW TO ?)| 0) PERFORMER)
        '#,(ACTOR-OF (QUOTE PERFORMER))))
      (RUN-WITH-METHOD-INVISIBLE
       (LET
        ((*MESSAGE '(!,*MESSAGE)))
        (COMPILED-ASK
         '#,(LIST
             (METHOD-AT-POSITION (|(SET YOUR COLORS TO ?)| 0) PERFORMER)
             (METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING))
         '#,(ACTOR-OF (QUOTE PERFORMER))))
       MYSELF
       *METHOD-BEING-RUN)))
   (CAR (CDDDDR *MESSAGE)))) 
(DEFUN |(SET YOUR COLORS TO ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE SET))
   (AND
    (EQ (CADR OBJECT) (QUOTE YOUR))
    (AND
     (EQ (CADDR OBJECT) (QUOTE COLORS))
     (AND (EQ (CADDDR OBJECT) (QUOTE TO)) (ONE-LONG (CDDDDR OBJECT))))))) 
(DEFPROP |(SET YOUR COLORS TO ?)| (SET YOUR COLORS TO ?) PATTERN) 
(DEFUN D0330 NIL
  ((LAMBDA (NEW-VALUE)
     (LET
      ((*MESSAGE '(SET YOUR VALIDITY-OF-HOW-TO-DRAW TO T)))
      (QUICK-COMPILED-ASK
       '#,(METHOD-AT-POSITION (|(SET YOUR VALIDITY-OF-HOW-TO-DRAW TO ?)| 0) PERFORMER)
       '#,(ACTOR-OF (QUOTE PERFORMER))))
     (LET
      ((*MESSAGE '(SET YOUR APPEARANCE-CHANGED TO T)))
      (QUICK-COMPILED-ASK
       '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
       '#,(ACTOR-OF (QUOTE PERFORMER))))
     (COND ((AND
             NEW-VALUE
             (LET
              ((*MESSAGE '(RECALL YOUR VISIBILITY)))
              (QUICK-COMPILED-ASK
               '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
               '#,(ACTOR-OF (QUOTE PERFORMER))))
             (NOT
              (EQUAL
               (LET
                ((*MESSAGE '(RECALL YOUR HOW-TO-DRAW)))
                (QUICK-COMPILED-ASK
                 '#,(METHOD-AT-POSITION ((RECALL YOUR HOW-TO-DRAW) 0) PERFORMER)
                 '#,(ACTOR-OF (QUOTE PERFORMER))))
               NEW-VALUE)))
            (LET
             ((*MESSAGE '(HIDE)))
             (QUICK-COMPILED-ASK
              '#,(METHOD-AT-POSITION ((HIDE) 0) PERFORMER)
              '#,(ACTOR-OF (QUOTE PERFORMER))))
            (RUN-WITH-METHOD-INVISIBLE
             (LET
              ((*MESSAGE '(!,*MESSAGE)))
              (COMPILED-ASK
               '#,(LIST
                   (METHOD-AT-POSITION (|(SET YOUR HOW-TO-DRAW TO ?)| 0) PERFORMER)
                   (METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING))
               '#,(ACTOR-OF (QUOTE PERFORMER))))
             MYSELF
             *METHOD-BEING-RUN)
            (LET
             ((*MESSAGE '(SHOW)))
             (QUICK-COMPILED-ASK
              '#,(METHOD-AT-POSITION ((SHOW) 0) PERFORMER)
              '#,(ACTOR-OF (QUOTE PERFORMER))))
            NEW-VALUE)
           (T
            (RUN-WITH-METHOD-INVISIBLE
             (LET
              ((*MESSAGE '(!,*MESSAGE)))
              (COMPILED-ASK
               '#,(LIST
                   (METHOD-AT-POSITION (|(SET YOUR HOW-TO-DRAW TO ?)| 0) PERFORMER)
                   (METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING))
               '#,(ACTOR-OF (QUOTE PERFORMER))))
             MYSELF
             *METHOD-BEING-RUN))))
   (CAR (CDDDDR *MESSAGE)))) 
(DEFUN |(SET YOUR HOW-TO-DRAW TO ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE SET))
   (AND
    (EQ (CADR OBJECT) (QUOTE YOUR))
    (AND
     (EQ (CADDR OBJECT) (QUOTE HOW-TO-DRAW))
     (AND (EQ (CADDDR OBJECT) (QUOTE TO)) (ONE-LONG (CDDDDR OBJECT))))))) 
(DEFPROP |(SET YOUR HOW-TO-DRAW TO ?)| (SET YOUR HOW-TO-DRAW TO ?) PATTERN) 
(DEFUN D0328 NIL
  ((LAMBDA (NEW-SIZE)
     (LET
      ((OLD-SIZE
        (RUN-WITH-METHOD-INVISIBLE
         (LET
          ((*MESSAGE '(RECALL YOUR ABSOLUTE-SIZE)))
          (QUICK-COMPILED-ASK
           '#,(METHOD-AT-POSITION ((RECALL YOUR ABSOLUTE-SIZE) 0) PERFORMER)
           '#,(ACTOR-OF (QUOTE PERFORMER))))
         MYSELF
         *METHOD-BEING-RUN))
       (NEW-SIZE (FLOAT NEW-SIZE)))
      (COND ((AND OLD-SIZE (FLONUM-EQUAL OLD-SIZE NEW-SIZE)))
            (T
             (RUN-WITH-METHOD-INVISIBLE
              (LET
               ((*MESSAGE '(!,*MESSAGE)))
               (COMPILED-ASK
                '#,(LIST
                    (METHOD-AT-POSITION (|(SET YOUR ABSOLUTE-SIZE TO ?)| 0) PERFORMER)
                    (METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING))
                '#,(ACTOR-OF (QUOTE PERFORMER))))
              MYSELF
              *METHOD-BEING-RUN)
             (LET
              ((HOW-TO-DRAW
                (LET
                 ((*MESSAGE '(RECALL YOUR HOW-TO-DRAW)))
                 (QUICK-COMPILED-ASK
                  '#,(METHOD-AT-POSITION ((RECALL YOUR HOW-TO-DRAW) 0) PERFORMER)
                  '#,(ACTOR-OF (QUOTE PERFORMER)))))
               (VISIBILITY
                (LET
                 ((*MESSAGE '(RECALL YOUR VISIBILITY)))
                 (QUICK-COMPILED-ASK
                  '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
                  '#,(ACTOR-OF (QUOTE PERFORMER))))))
              (COND (VISIBILITY
                     (LET
                      ((*MESSAGE '(HIDE)))
                      (QUICK-COMPILED-ASK
                       '#,(METHOD-AT-POSITION ((HIDE) 0) PERFORMER)
                       '#,(ACTOR-OF (QUOTE PERFORMER))))))
              (LET
               ((*MESSAGE
                 '(SET
                   YOUR
                   HOW-TO-DRAW
                   TO
                   ,(AND HOW-TO-DRAW (REPLACE-NTH 1 HOW-TO-DRAW NEW-SIZE)))))
               (QUICK-COMPILED-ASK
                '#,(METHOD-AT-POSITION (|(SET YOUR HOW-TO-DRAW TO ?)| 0) PERFORMER)
                '#,(ACTOR-OF (QUOTE PERFORMER))))
              (LET
               ((*MESSAGE
                 '(SEQUENTIALLY
                   (ASK
                    EACH
                    OF
                    YOUR
                    PARTS
                    NOTICE
                    THAT
                    ,MYSELF
                    HAS
                    GROWN
                    BY
                    ,(//$ NEW-SIZE OLD-SIZE)))))
               (QUICK-COMPILED-ASK
                '#,(METHOD-AT-POSITION
                    (|(SEQUENTIALLY (ASK EACH OF YOUR ? %) %)| 0)
                    SOMETHING)
                '#,(ACTOR-OF (QUOTE PERFORMER))))
              (COND (VISIBILITY
                     (LET
                      ((*MESSAGE '(SHOW)))
                      (QUICK-COMPILED-ASK
                       '#,(METHOD-AT-POSITION ((SHOW) 0) PERFORMER)
                       '#,(ACTOR-OF (QUOTE PERFORMER)))))))))
      NEW-SIZE))
   (CAR (CDDDDR *MESSAGE)))) 
(DEFUN |(SET YOUR ABSOLUTE-SIZE TO ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE SET))
   (AND
    (EQ (CADR OBJECT) (QUOTE YOUR))
    (AND
     (EQ (CADDR OBJECT) (QUOTE ABSOLUTE-SIZE))
     (AND (EQ (CADDDR OBJECT) (QUOTE TO)) (ONE-LONG (CDDDDR OBJECT))))))) 
(DEFPROP |(SET YOUR ABSOLUTE-SIZE TO ?)| (SET YOUR ABSOLUTE-SIZE TO ?) PATTERN) 
(DEFUN D0327 NIL
  ((LAMBDA (NEW-SIZE)
     (RUN-WITH-METHOD-INVISIBLE
      (LET
       ((*MESSAGE '(!,*MESSAGE)))
       (COMPILED-ASK
        '#,(LIST
            (METHOD-AT-POSITION (|(SET YOUR SIZE TO ?)| 0) PERFORMER)
            (METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING))
        '#,(ACTOR-OF (QUOTE PERFORMER))))
      MYSELF
      *METHOD-BEING-RUN)
     (LET
      ((WHOLE
        (LET
         ((*MESSAGE '(RECALL YOUR WHOLE)))
         (QUICK-COMPILED-ASK
          '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
          '#,(ACTOR-OF (QUOTE PERFORMER))))))
      (COND (WHOLE
             (LET
              ((*MESSAGE
                '(RECOMPUTE                          YOUR
                  ABSOLUTE-SIZE                      SINCE
                  ,WHOLE                             IS
                  NOW
                  ,(ASK ,WHOLE RECALL YOUR ABSOLUTE-SIZE))))
              (QUICK-COMPILED-ASK
               '#,(METHOD-AT-POSITION
                   (|(RECOMPUTE YOUR ABSOLUTE-SIZE SINCE ? IS NOW ?)| 0)
                   PERFORMER)
               '#,(ACTOR-OF (QUOTE PERFORMER)))))
            (T
             (LET
              ((*MESSAGE '(SET YOUR ABSOLUTE-SIZE TO ,(FLOAT NEW-SIZE))))
              (QUICK-COMPILED-ASK
               '#,(METHOD-AT-POSITION (|(SET YOUR ABSOLUTE-SIZE TO ?)| 0) PERFORMER)
               '#,(ACTOR-OF (QUOTE PERFORMER)))))))
     NEW-SIZE)
   (CAR (CDDDDR *MESSAGE)))) 
(DEFUN |(SET YOUR SIZE TO ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE SET))
   (AND
    (EQ (CADR OBJECT) (QUOTE YOUR))
    (AND
     (EQ (CADDR OBJECT) (QUOTE SIZE))
     (AND (EQ (CADDDR OBJECT) (QUOTE TO)) (ONE-LONG (CDDDDR OBJECT))))))) 
(DEFPROP |(SET YOUR SIZE TO ?)| (SET YOUR SIZE TO ?) PATTERN) 
(DEFUN D0325 NIL
  ((LAMBDA (FACTOR WHOLE)
     (LET
      ((*MESSAGE
        '(SET
          YOUR
          ABSOLUTE-SIZE
          TO
          ,(TIMES
            (OR (ASK MYSELF RECALL YOUR ABSOLUTE-SIZE) 1)
            (QUOTE-IF-NEED-BE ,FACTOR)))))
      (QUICK-COMPILED-ASK
       '#,(METHOD-AT-POSITION (|(SET YOUR ABSOLUTE-SIZE TO ?)| 0) PERFORMER)
       '#,(ACTOR-OF (QUOTE PERFORMER))))
     (LET
      ((*MESSAGE
        '(RECOMPUTE YOUR STATE SINCE ,WHOLE IS NOW ,(ASK ,WHOLE RECALL YOUR STATE))))
      (QUICK-COMPILED-ASK
       '#,(METHOD-AT-POSITION (|(RECOMPUTE YOUR STATE SINCE ? IS NOW ?)| 0) PERFORMER)
       '#,(ACTOR-OF (QUOTE PERFORMER))))
     NO-VALUE)
   (CADDR (CDDDDR *MESSAGE)) (CADDR *MESSAGE))) 
(DEFUN |(NOTICE THAT ? HAS GROWN BY ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE NOTICE))
   (AND
    (EQ (CADR OBJECT) (QUOTE THAT))
    (AND
     (EQ (CADDDR OBJECT) (QUOTE HAS))
     (AND
      (EQ (CAR (CDDDDR OBJECT)) (QUOTE GROWN))
      (AND (EQ (CADR (CDDDDR OBJECT)) (QUOTE BY)) (ONE-LONG (CDDR (CDDDDR OBJECT))))))))) 
(DEFPROP |(NOTICE THAT ? HAS GROWN BY ?)| (NOTICE THAT ? HAS GROWN BY ?) PATTERN) 
(DEFUN D0324 NIL
  ((LAMBDA (WHOLE-SIZE)
     (LET
      ((*MESSAGE
        '(SET
          YOUR
          ABSOLUTE-SIZE
          TO
          ,(*$ WHOLE-SIZE 1.0E-3 (FLOAT (ASK MYSELF RECALL YOUR SIZE))))))
      (QUICK-COMPILED-ASK
       '#,(METHOD-AT-POSITION (|(SET YOUR ABSOLUTE-SIZE TO ?)| 0) PERFORMER)
       '#,(ACTOR-OF (QUOTE PERFORMER)))))
   (CADDDR (CDDDDR *MESSAGE)))) 
(DEFUN |(RECOMPUTE YOUR ABSOLUTE-SIZE SINCE ? IS NOW ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE RECOMPUTE))
   (AND
    (EQ (CADR OBJECT) (QUOTE YOUR))
    (AND
     (EQ (CADDR OBJECT) (QUOTE ABSOLUTE-SIZE))
     (AND
      (EQ (CADDDR OBJECT) (QUOTE SINCE))
      (AND
       (EQ (CADR (CDDDDR OBJECT)) (QUOTE IS))
       (AND (EQ (CADDR (CDDDDR OBJECT)) (QUOTE NOW)) (ONE-LONG (CDDDR (CDDDDR OBJECT)))))))))
  ) 
(DEFPROP
 |(RECOMPUTE YOUR ABSOLUTE-SIZE SINCE ? IS NOW ?)|
 (RECOMPUTE YOUR ABSOLUTE-SIZE SINCE ? IS NOW ?)
 PATTERN) 
(DEFUN D0323 NIL
  (OR
   (RUN-WITH-METHOD-INVISIBLE
    (LET
     ((*MESSAGE '(RECALL YOUR ABSOLUTE-SIZE)))
     (COMPILED-ASK
      '#,(LIST
          (METHOD-AT-POSITION ((RECALL YOUR ABSOLUTE-SIZE) 0) PERFORMER)
          (METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING))
      '#,(ACTOR-OF (QUOTE PERFORMER))))
    MYSELF
    *METHOD-BEING-RUN)
   (LET
    ((WHOLE
      (LET
       ((*MESSAGE '(RECALL YOUR WHOLE)))
       (QUICK-COMPILED-ASK
        '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
        '#,(ACTOR-OF (QUOTE PERFORMER))))))
    (COND (WHOLE
           (LET
            ((*MESSAGE
              '(RECOMPUTE                           YOUR
                ABSOLUTE-SIZE                       SINCE
                ,WHOLE                              IS
                NOW
                ,(ASK ,WHOLE RECALL YOUR ABSOLUTE-SIZE))))
            (QUICK-COMPILED-ASK
             '#,(METHOD-AT-POSITION
                 (|(RECOMPUTE YOUR ABSOLUTE-SIZE SINCE ? IS NOW ?)| 0)
                 PERFORMER)
             '#,(ACTOR-OF (QUOTE PERFORMER)))))
          (T
           (LET
            ((*MESSAGE
              '(SET YOUR ABSOLUTE-SIZE TO ,(FLOAT (ASK MYSELF RECALL YOUR SIZE)))))
            (QUICK-COMPILED-ASK
             '#,(METHOD-AT-POSITION (|(SET YOUR ABSOLUTE-SIZE TO ?)| 0) PERFORMER)
             '#,(ACTOR-OF (QUOTE PERFORMER))))))))) 
(DEFUN D0322 NIL
  (LET
   ((HOW-TO-DRAW
     (RUN-WITH-METHOD-INVISIBLE
      (LET
       ((*MESSAGE '(RECALL YOUR HOW-TO-DRAW)))
       (COMPILED-ASK
        '#,(LIST
            (METHOD-AT-POSITION ((RECALL YOUR HOW-TO-DRAW) 0) PERFORMER)
            (METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING))
        '#,(ACTOR-OF (QUOTE PERFORMER))))
      MYSELF
      *METHOD-BEING-RUN))
    (STILL-VALID
     (LET
      ((*MESSAGE '(RECALL YOUR VALIDITY-OF-HOW-TO-DRAW)))
      (QUICK-COMPILED-ASK
       '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
       '#,(ACTOR-OF (QUOTE PERFORMER))))))
   (COND ((AND STILL-VALID HOW-TO-DRAW))
         (T
          (LET
           ((DRAWING-FORM (MAKE-INNER-DRAWER)))
           (COND (DRAWING-FORM
                  (LET*
                   ((STANDARDIZE-SIZE?
                     (LET
                      ((*MESSAGE '(RECALL YOUR STANDARDIZE-SIZE?)))
                      (QUICK-COMPILED-ASK
                       '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
                       '#,(ACTOR-OF (QUOTE PERFORMER)))))
                    (STANDARDIZE-CENTER?
                     (LET
                      ((*MESSAGE '(RECALL YOUR STANDARDIZE-CENTER?)))
                      (QUICK-COMPILED-ASK
                       '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
                       '#,(ACTOR-OF (QUOTE PERFORMER)))))
                    (ABSOLUTE-SIZE
                     (LET
                      ((*MESSAGE '(RECALL YOUR ABSOLUTE-SIZE)))
                      (QUICK-COMPILED-ASK
                       '#,(METHOD-AT-POSITION ((RECALL YOUR ABSOLUTE-SIZE) 0) PERFORMER)
                       '#,(ACTOR-OF (QUOTE PERFORMER)))))
                    ((HOW-TO-GET-TO-CENTER SCALE)
                     (COND ((AND STANDARDIZE-CENTER? STANDARDIZE-SIZE?)
                            (HOW-TO-GET-TO-CENTER-AND-SCALE DRAWING-FORM 1.0))
                           (STANDARDIZE-CENTER?
                            '(,(HOW-TO-GET-TO-CENTER DRAWING-FORM) ,(//$ ABSOLUTE-SIZE)))
                           (STANDARDIZE-SIZE?
                            '(NIL
                              ,(SECOND (HOW-TO-GET-TO-CENTER-AND-SCALE DRAWING-FORM 
1.0))))
                           (T '(NIL ,(//$ ABSOLUTE-SIZE))))))
                   (RUN-WITH-METHOD-INVISIBLE
                    (LET
                     ((*MESSAGE
                       '(SET
                         YOUR
                         HOW-TO-DRAW
                         TO
                         (DRAW-SCALED-AND-CENTERED
                          ,ABSOLUTE-SIZE
                          (QUOTE ,DRAWING-FORM)
                          ,SCALE
                          (QUOTE ,HOW-TO-GET-TO-CENTER)
                          (QUOTE ,(FIRST (ASK MYSELF RECALL YOUR COLORS)))))))
                     (QUICK-COMPILED-ASK
                      '#,(METHOD-AT-POSITION (|(SET YOUR HOW-TO-DRAW TO ?)| 0) PERFORMER)
                      '#,(ACTOR-OF (QUOTE PERFORMER))))
                    MYSELF
                    *METHOD-BEING-RUN))))))))) 
(DEFUN D0321 NIL
  ((LAMBDA (ACT)
     (LET
      ((MYSELF (ACTOR-OF (QUOTE THE-TURTLE)))
       (*MESSAGE '(SET YOUR ACTIONS-PERFORMED TO NIL)))
      (QUICK-COMPILED-ASK
       '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
       '#,(ACTOR-OF (QUOTE THE-TURTLE))))
     (UNWIND-PROTECT
      (PROGN
       (LET
        ((MYSELF (ACTOR-OF (QUOTE THE-TURTLE)))
         (*MESSAGE '(SET YOUR PERFORM-OR-RECALL TO RECALL)))
        (QUICK-COMPILED-ASK
         '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
         '#,(ACTOR-OF (QUOTE THE-TURTLE))))
       (LET ((*MESSAGE '(,ACT))) (CASES MYSELF))
       (NREVERSE
        (LET
         ((MYSELF (ACTOR-OF (QUOTE THE-TURTLE)))
          (*MESSAGE '(RECALL YOUR ACTIONS-PERFORMED)))
         (QUICK-COMPILED-ASK
          '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
          '#,(ACTOR-OF (QUOTE THE-TURTLE))))))
      (LET
       ((MYSELF (ACTOR-OF (QUOTE THE-TURTLE)))
        (*MESSAGE '(SET YOUR PERFORM-OR-RECALL TO PERFORM)))
       (QUICK-COMPILED-ASK
        '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
        '#,(ACTOR-OF (QUOTE THE-TURTLE))))))
   (CAADDR *MESSAGE))) 
(DEFUN |(RECALL YOUR ({or DISPLAY ERASE} ACTIONS))| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE RECALL))
   (AND
    (EQ (CADR OBJECT) (QUOTE YOUR))
    (AND
     (AND
      (LISTP (CADDR OBJECT))
      (MEMQ (CAADDR OBJECT) (QUOTE (DISPLAY ERASE)))
      (EQUAL (CDADDR OBJECT) (QUOTE (ACTIONS))))
     (NULL (CDDDR OBJECT)))))) 
(DEFPROP
 |(RECALL YOUR ({or DISPLAY ERASE} ACTIONS))|
 (RECALL YOUR ({or DISPLAY ERASE} ACTIONS))
 PATTERN) 
(DEFUN D0320 NIL
  (PENUP)
  (SETTURTLE
   (LET
    ((*MESSAGE '(RECALL YOUR STATE)))
    (QUICK-COMPILED-ASK
     '#,(METHOD-AT-POSITION ((RECALL YOUR STATE) 0) PERFORMER)
     '#,(ACTOR-OF (QUOTE PERFORMER)))))
  (LET
   ((MYSELF (ACTOR-OF (QUOTE THE-TURTLE)))
    (*MESSAGE
     '(PERFORM
       (ERASERDOWN)
       (FILLWINDOW
        (PLUS
         :TVSTEP
         (MIN (DISTANCE-TO-NEAREST-WALL) ,(ASK MYSELF RECALL YOUR ABSOLUTE-SIZE)))))))
   (QUICK-COMPILED-ASK
    '#,(METHOD-AT-POSITION (|(PERFORM %)| 0) THE-TURTLE)
    '#,(ACTOR-OF (QUOTE THE-TURTLE))))) 
(DEFUN D0319 NIL
  ((LAMBDA (VALUE)
     (COND ((NULL VALUE)
            (LET
             ((*MESSAGE '(DO WHEN RECEIVING (ERASE) (ASK MYSELF ERASE BY CLEARING AREA))))
             (QUICK-COMPILED-ASK
              '#,(METHOD-AT-POSITION (|(DO WHEN RECEIVING ? %)| 0) SOMETHING)
              '#,(ACTOR-OF (QUOTE PERFORMER))))))
     (RUN-WITH-METHOD-INVISIBLE
      (LET
       ((*MESSAGE '(!,*MESSAGE)))
       (COMPILED-ASK
        '#,(LIST
            (METHOD-AT-POSITION (|(SET YOUR ERASABILITY TO ?)| 0) PERFORMER)
            (METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING))
        '#,(ACTOR-OF (QUOTE PERFORMER))))
      MYSELF
      *METHOD-BEING-RUN))
   (CAR (CDDDDR *MESSAGE)))) 
(DEFUN |(SET YOUR ERASABILITY TO ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE SET))
   (AND
    (EQ (CADR OBJECT) (QUOTE YOUR))
    (AND
     (EQ (CADDR OBJECT) (QUOTE ERASABILITY))
     (AND (EQ (CADDDR OBJECT) (QUOTE TO)) (ONE-LONG (CDDDDR OBJECT))))))) 
(DEFPROP |(SET YOUR ERASABILITY TO ?)| (SET YOUR ERASABILITY TO ?) PATTERN) 
(DEFUN D0318 NIL
  (LET
   ((VISIBLE-PARTS
     (LET
      ((*MESSAGE '(RECALL YOUR VISIBLE-PARTS)))
      (QUICK-COMPILED-ASK
       '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
       '#,(ACTOR-OF (QUOTE PERFORMER))))))
   (COND (VISIBLE-PARTS
          (DIRECTOR-MAPCAR
           (FUNCTION
            (LAMBDA (ACTOR)
              (LET
               ((MYSELF (ACTOR-OF ACTOR)) (*MESSAGE '(JUST HIDE)))
               (QUICK-COMPILED-ASK
                '#,(METHOD-AT-POSITION ((JUST HIDE) 0) PERFORMER)
                '#,(ACTOR-OF (QUOTE PERFORMER))))))
           VISIBLE-PARTS))
         (T
          (PENUP)
          (SETTURTLE
           (LET
            ((*MESSAGE '(RECALL YOUR STATE)))
            (QUICK-COMPILED-ASK
             '#,(METHOD-AT-POSITION ((RECALL YOUR STATE) 0) PERFORMER)
             '#,(ACTOR-OF (QUOTE PERFORMER)))))
          (EVAL
           (LET
            ((*MESSAGE '(RECALL YOUR ERASE-MODE)))
            (QUICK-COMPILED-ASK
             '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
             '#,(ACTOR-OF (QUOTE PERFORMER)))))
          (LET
           ((MYSELF (ACTOR-OF (QUOTE THE-TURTLE)))
            (*MESSAGE '(PERFORM ,(ASK MYSELF RECALL YOUR HOW-TO-DRAW))))
           (QUICK-COMPILED-ASK
            '#,(METHOD-AT-POSITION (|(PERFORM %)| 0) THE-TURTLE)
            '#,(ACTOR-OF (QUOTE THE-TURTLE)))))))
  NO-VALUE) 
(DEFUN D0317 NIL
  (LET
   ((VISIBLE-PARTS
     (LET
      ((*MESSAGE '(RECALL YOUR VISIBLE-PARTS)))
      (QUICK-COMPILED-ASK
       '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
       '#,(ACTOR-OF (QUOTE PERFORMER))))))
   (COND (VISIBLE-PARTS
          (DIRECTOR-MAPCAR
           (FUNCTION
            (LAMBDA (ACTOR)
              (LET
               ((MYSELF (ACTOR-OF ACTOR)) (*MESSAGE '(JUST SHOW)))
               (QUICK-COMPILED-ASK
                '#,(METHOD-AT-POSITION ((JUST SHOW) 0) PERFORMER)
                '#,(ACTOR-OF (QUOTE PERFORMER))))))
           VISIBLE-PARTS))
         (T
          (PENUP)
          (SETTURTLE
           (LET
            ((*MESSAGE '(RECALL YOUR STATE)))
            (QUICK-COMPILED-ASK
             '#,(METHOD-AT-POSITION ((RECALL YOUR STATE) 0) PERFORMER)
             '#,(ACTOR-OF (QUOTE PERFORMER)))))
          (EVAL
           (LET
            ((*MESSAGE '(RECALL YOUR DRAW-MODE)))
            (QUICK-COMPILED-ASK
             '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
             '#,(ACTOR-OF (QUOTE PERFORMER)))))
          (LET
           ((MYSELF (ACTOR-OF (QUOTE THE-TURTLE)))
            (*MESSAGE '(PERFORM ,(ASK MYSELF RECALL YOUR HOW-TO-DRAW))))
           (QUICK-COMPILED-ASK
            '#,(METHOD-AT-POSITION (|(PERFORM %)| 0) THE-TURTLE)
            '#,(ACTOR-OF (QUOTE THE-TURTLE)))))))
  NO-VALUE) 
(DEFUN D0316 NIL
  (COND ((LET
          ((*MESSAGE '(RECALL YOUR VISIBILITY)))
          (QUICK-COMPILED-ASK
           '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
           '#,(ACTOR-OF (QUOTE PERFORMER))))
         (LET
          ((*MESSAGE '(DISPLAY)))
          (QUICK-COMPILED-ASK
           '#,(METHOD-AT-POSITION ((DISPLAY) 0) PERFORMER)
           '#,(ACTOR-OF (QUOTE PERFORMER))))))) 
(DEFUN D0314 NIL
  (LET
   ((*MESSAGE '(SEQUENTIALLY (ASK EACH OF YOUR PARTS HIDE ALL))))
   (QUICK-COMPILED-ASK
    '#,(METHOD-AT-POSITION (|(SEQUENTIALLY (ASK EACH OF YOUR ? %) %)| 0) SOMETHING)
    '#,(ACTOR-OF (QUOTE PERFORMER))))
  (LET
   ((*MESSAGE '(HIDE)))
   (QUICK-COMPILED-ASK
    '#,(METHOD-AT-POSITION ((HIDE) 0) PERFORMER)
    '#,(ACTOR-OF (QUOTE PERFORMER))))) 
(DEFUN D0313 NIL
  (LET
   ((*MESSAGE '(SET YOUR VISIBILITY TO NIL)))
   (QUICK-COMPILED-ASK
    '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
    '#,(ACTOR-OF (QUOTE PERFORMER))))
  (LET
   ((*MESSAGE '(ERASE)))
   (QUICK-COMPILED-ASK
    '#,(METHOD-AT-POSITION ((ERASE) 0) PERFORMER)
    '#,(ACTOR-OF (QUOTE PERFORMER))))) 
(DEFUN D0311 NIL
  (LET
   ((WHOLE
     (OR
      (LET
       ((*MESSAGE '(RECALL YOUR WHOLE)))
       (QUICK-COMPILED-ASK
        '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
        '#,(ACTOR-OF (QUOTE PERFORMER))))
      'THE-CAST)))
   (COND (WHOLE
          (LET
           ((MYSELF (ACTOR-OF WHOLE))
            (*MESSAGE
             '(SET
               YOUR
               VISIBLE-PARTS
               TO
               ,(SAFE-DELETE
                 (QUOTE-IF-NEED-BE ,MYSELF)
                 (ASK ,WHOLE RECALL YOUR VISIBLE-PARTS)))))
           (QUICK-COMPILED-ASK
            '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
            '#,(ACTOR-OF (QUOTE PERFORMER))))))
   (COND ((LET
           ((*MESSAGE '(RECALL YOUR VISIBILITY)))
           (QUICK-COMPILED-ASK
            '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
            '#,(ACTOR-OF (QUOTE PERFORMER))))
          (LET
           ((*MESSAGE '(JUST HIDE)))
           (QUICK-COMPILED-ASK
            '#,(METHOD-AT-POSITION ((JUST HIDE) 0) PERFORMER)
            '#,(ACTOR-OF (QUOTE PERFORMER)))))))) 
(DEFUN D0309 NIL
  (LET
   ((*MESSAGE '(SEQUENTIALLY (ASK EACH OF YOUR PARTS SHOW ALL))))
   (QUICK-COMPILED-ASK
    '#,(METHOD-AT-POSITION (|(SEQUENTIALLY (ASK EACH OF YOUR ? %) %)| 0) SOMETHING)
    '#,(ACTOR-OF (QUOTE PERFORMER))))
  (LET
   ((*MESSAGE '(SHOW)))
   (QUICK-COMPILED-ASK
    '#,(METHOD-AT-POSITION ((SHOW) 0) PERFORMER)
    '#,(ACTOR-OF (QUOTE PERFORMER))))) 
(DEFUN D0308 NIL
  (LET
   ((*MESSAGE '(SET YOUR VISIBILITY TO T)))
   (QUICK-COMPILED-ASK
    '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
    '#,(ACTOR-OF (QUOTE PERFORMER))))
  (LET
   ((*MESSAGE '(DISPLAY)))
   (QUICK-COMPILED-ASK
    '#,(METHOD-AT-POSITION ((DISPLAY) 0) PERFORMER)
    '#,(ACTOR-OF (QUOTE PERFORMER))))) 
(DEFUN D0306 NIL
  (LET
   ((WHOLE
     (OR
      (LET
       ((*MESSAGE '(RECALL YOUR WHOLE)))
       (QUICK-COMPILED-ASK
        '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
        '#,(ACTOR-OF (QUOTE PERFORMER))))
      'THE-CAST)))
   (COND (WHOLE
          (LET
           ((MYSELF (ACTOR-OF WHOLE))
            (*MESSAGE
             '(SET
               YOUR
               VISIBLE-PARTS
               TO
               ,(CONS-IF-NOT-MEMBER
                 (QUOTE-IF-NEED-BE ,MYSELF)
                 (ASK ,WHOLE RECALL YOUR VISIBLE-PARTS)))))
           (QUICK-COMPILED-ASK
            '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
            '#,(ACTOR-OF (QUOTE PERFORMER))))))
   (COND ((NOT
           (LET
            ((*MESSAGE '(RECALL YOUR VISIBILITY)))
            (QUICK-COMPILED-ASK
             '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
             '#,(ACTOR-OF (QUOTE PERFORMER)))))
          (LET
           ((*MESSAGE '(JUST SHOW)))
           (QUICK-COMPILED-ASK
            '#,(METHOD-AT-POSITION ((JUST SHOW) 0) PERFORMER)
            '#,(ACTOR-OF (QUOTE PERFORMER)))))))) 
(DEFUN D0305 NIL
  (LET
   ((DRAW-PROCEDURE-NAME
     (LET
      ((*MESSAGE '(RECALL YOUR DRAW-PROCEDURE)))
      (QUICK-COMPILED-ASK
       '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
       '#,(ACTOR-OF (QUOTE PERFORMER))))))
   (LET
    ((DRAW-PROCEDURE (SECOND (GETL DRAW-PROCEDURE-NAME '(EXPR LEXPR)))))
    (COND (DRAW-PROCEDURE (DEFUNIZE DRAW-PROCEDURE-NAME DRAW-PROCEDURE)))))) 
(DEFUN D0304 NIL
  (LET
   ((INSTANCE
     (RUN-WITH-METHOD-INVISIBLE
      (LET
       ((*MESSAGE '(!,*MESSAGE)))
       (COMPILED-ASK
        '#,(LIST
            (METHOD-AT-POSITION (|(MAKE ?)| 0) PERFORMER)
            (METHOD-AT-POSITION (|(MAKE ?)| 0) SOMETHING))
        '#,(ACTOR-OF (QUOTE PERFORMER))))
      MYSELF
      *METHOD-BEING-RUN))
    (DEFAULT-WHOLE
     (LET
      ((*MESSAGE '(RECALL YOUR DEFAULT-WHOLE)))
      (QUICK-COMPILED-ASK
       '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
       '#,(ACTOR-OF (QUOTE PERFORMER))))))
   (AND
    DEFAULT-WHOLE
    (LET
     ((MYSELF (ACTOR-OF INSTANCE)) (*MESSAGE '(SET YOUR WHOLE TO ,DEFAULT-WHOLE)))
     (QUICK-COMPILED-ASK
      '#,(METHOD-AT-POSITION (|(SET YOUR WHOLE TO ?)| 0) PERFORMER)
      '#,(ACTOR-OF (QUOTE PERFORMER)))))
   INSTANCE)) 
(DEFUN D0303 NIL
  ((LAMBDA (ELEMENT)
     (RECALL-VALUE-OF-ELEMENT ELEMENT (QUOTE STATE) (QUOTE (XCOR YCOR HEADING))))
   (CADDR *MESSAGE))) 
(DEFUN |(RECALL YOUR {MEMQ ? (QUOTE (XCOR YCOR HEADING))})| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE RECALL))
   (AND
    (EQ (CADR OBJECT) (QUOTE YOUR))
    (AND
     (LET ((? (CADDR OBJECT))) (MEMQ ? (QUOTE (XCOR YCOR HEADING))))
     (NULL (CDDDR OBJECT)))))) 
(DEFPROP
 |(RECALL YOUR {MEMQ ? (QUOTE (XCOR YCOR HEADING))})|
 (RECALL YOUR {MEMQ ? (QUOTE (XCOR YCOR HEADING))})
 PATTERN) 
(DEFUN D0302 NIL
  ((LAMBDA (NEW-VALUE)
     (RUN-WITH-METHOD-INVISIBLE
      (LET
       ((*MESSAGE '(!,*MESSAGE)))
       (COMPILED-ASK
        '#,(LIST
            (METHOD-AT-POSITION (|(SET YOUR STATE TO ?)| 0) PERFORMER)
            (METHOD-AT-POSITION (|(SET YOUR STATE TO ?)| 1) PERFORMER))
        '#,(ACTOR-OF (QUOTE PERFORMER))))
      MYSELF
      *METHOD-BEING-RUN)
     (SET-EACH-COMPONENT
      (QUOTE (XCOR YCOR HEADING))
      NEW-VALUE
      '#,(METHOD-AT-POSITION
          (|(SET YOUR {MEMQ ? (QUOTE (XCOR YCOR HEADING))} TO ?)| 0)
          PERFORMER))
     NEW-VALUE)
   (CAR (CDDDDR *MESSAGE)))) 
(DEFUN |(SET YOUR STATE TO ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE SET))
   (AND
    (EQ (CADR OBJECT) (QUOTE YOUR))
    (AND
     (EQ (CADDR OBJECT) (QUOTE STATE))
     (AND (EQ (CADDDR OBJECT) (QUOTE TO)) (ONE-LONG (CDDDDR OBJECT))))))) 
(DEFPROP |(SET YOUR STATE TO ?)| (SET YOUR STATE TO ?) PATTERN) 
(DEFUN D0301 NIL
  ((LAMBDA (VALUE-OF-ELEMENT ELEMENT)
     (SET-VALUE-OF-ELEMENT
      ELEMENT
      VALUE-OF-ELEMENT
      (QUOTE STATE)
      (QUOTE (XCOR YCOR HEADING))))
   (CAR (CDDDDR *MESSAGE)) (CADDR *MESSAGE))) 
(DEFUN |(SET YOUR {MEMQ ? (QUOTE (XCOR YCOR HEADING))} TO ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE SET))
   (AND
    (EQ (CADR OBJECT) (QUOTE YOUR))
    (AND
     (LET ((? (CADDR OBJECT))) (MEMQ ? (QUOTE (XCOR YCOR HEADING))))
     (AND (EQ (CADDDR OBJECT) (QUOTE TO)) (ONE-LONG (CDDDDR OBJECT))))))) 
(DEFPROP
 |(SET YOUR {MEMQ ? (QUOTE (XCOR YCOR HEADING))} TO ?)|
 (SET YOUR {MEMQ ? (QUOTE (XCOR YCOR HEADING))} TO ?)
 PATTERN) 
(DEFUN D0300 NIL
  ((LAMBDA (ELEMENT)
     (RECALL-VALUE-OF-ELEMENT ELEMENT (QUOTE POSITION) (QUOTE (XCOR YCOR))))
   (CADDR *MESSAGE))) 
(DEFUN |(RECALL YOUR {MEMQ ? (QUOTE (XCOR YCOR))})| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE RECALL))
   (AND
    (EQ (CADR OBJECT) (QUOTE YOUR))
    (AND (LET ((? (CADDR OBJECT))) (MEMQ ? (QUOTE (XCOR YCOR)))) (NULL (CDDDR OBJECT)))))) 
(DEFPROP
 |(RECALL YOUR {MEMQ ? (QUOTE (XCOR YCOR))})|
 (RECALL YOUR {MEMQ ? (QUOTE (XCOR YCOR))})
 PATTERN) 
(DEFUN D0299 NIL
  ((LAMBDA (NEW-VALUE)
     (RUN-WITH-METHOD-INVISIBLE
      (LET
       ((*MESSAGE '(!,*MESSAGE)))
       (COMPILED-ASK
        '#,(LIST
            (METHOD-AT-POSITION (|(SET YOUR POSITION TO ?)| 0) PERFORMER)
            (METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING))
        '#,(ACTOR-OF (QUOTE PERFORMER))))
      MYSELF
      *METHOD-BEING-RUN)
     (SET-EACH-COMPONENT
      (QUOTE (XCOR YCOR))
      NEW-VALUE
      '#,(METHOD-AT-POSITION
          (|(SET YOUR {MEMQ ? (QUOTE (XCOR YCOR))} TO ?)| 0)
          PERFORMER))
     NEW-VALUE)
   (CAR (CDDDDR *MESSAGE)))) 
(DEFUN |(SET YOUR POSITION TO ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE SET))
   (AND
    (EQ (CADR OBJECT) (QUOTE YOUR))
    (AND
     (EQ (CADDR OBJECT) (QUOTE POSITION))
     (AND (EQ (CADDDR OBJECT) (QUOTE TO)) (ONE-LONG (CDDDDR OBJECT))))))) 
(DEFPROP |(SET YOUR POSITION TO ?)| (SET YOUR POSITION TO ?) PATTERN) 
(DEFUN D0298 NIL
  ((LAMBDA (VALUE-OF-ELEMENT ELEMENT)
     (SET-VALUE-OF-ELEMENT ELEMENT VALUE-OF-ELEMENT (QUOTE POSITION) (QUOTE (XCOR YCOR))))
   (CAR (CDDDDR *MESSAGE)) (CADDR *MESSAGE))) 
(DEFUN |(SET YOUR {MEMQ ? (QUOTE (XCOR YCOR))} TO ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE SET))
   (AND
    (EQ (CADR OBJECT) (QUOTE YOUR))
    (AND
     (LET ((? (CADDR OBJECT))) (MEMQ ? (QUOTE (XCOR YCOR))))
     (AND (EQ (CADDDR OBJECT) (QUOTE TO)) (ONE-LONG (CDDDDR OBJECT))))))) 
(DEFPROP
 |(SET YOUR {MEMQ ? (QUOTE (XCOR YCOR))} TO ?)|
 (SET YOUR {MEMQ ? (QUOTE (XCOR YCOR))} TO ?)
 PATTERN) 
(DEFUN D0297 (MESSAGE)
  (COND ((AND
          (EQ (CAR MESSAGE) (QUOTE SET))
          (AND
           (EQ (CADR MESSAGE) (QUOTE YOUR))
           (COND ((AND
                   (AND
                    (LET ((? (CADDR MESSAGE))) (MEMQ ? (QUOTE (XCOR YCOR))))
                    (AND (EQ (CADDDR MESSAGE) (QUOTE TO)) (ONE-LONG (CDDDDR MESSAGE))))
                   (METHOD-IF-NOT-HIDDEN
                    '#,(METHOD-AT-POSITION
                        (|(SET YOUR {MEMQ ? (QUOTE (XCOR YCOR))} TO ?)| 0)
                        PERFORMER))))
                 ((AND
                   (AND
                    (EQ (CADDR MESSAGE) (QUOTE POSITION))
                    (AND (EQ (CADDDR MESSAGE) (QUOTE TO)) (ONE-LONG (CDDDDR MESSAGE))))
                   (METHOD-IF-NOT-HIDDEN
                    '#,(METHOD-AT-POSITION (|(SET YOUR POSITION TO ?)| 0) PERFORMER))))
                 ((AND
                   (AND
                    (LET ((? (CADDR MESSAGE))) (MEMQ ? (QUOTE (XCOR YCOR HEADING))))
                    (AND (EQ (CADDDR MESSAGE) (QUOTE TO)) (ONE-LONG (CDDDDR MESSAGE))))
                   (METHOD-IF-NOT-HIDDEN
                    '#,(METHOD-AT-POSITION
                        (|(SET YOUR {MEMQ ? (QUOTE (XCOR YCOR HEADING))} TO ?)| 0)
                        PERFORMER))))
                 ((AND
                   (AND
                    (EQ (CADDR MESSAGE) (QUOTE STATE))
                    (AND (EQ (CADDDR MESSAGE) (QUOTE TO)) (ONE-LONG (CDDDDR MESSAGE))))
                   (METHOD-IF-NOT-HIDDEN
                    '#,(METHOD-AT-POSITION (|(SET YOUR STATE TO ?)| 0) PERFORMER))))
                 ((AND
                   (AND
                    (EQ (CADDR MESSAGE) (QUOTE ERASABILITY))
                    (AND (EQ (CADDDR MESSAGE) (QUOTE TO)) (ONE-LONG (CDDDDR MESSAGE))))
                   (METHOD-IF-NOT-HIDDEN
                    '#,(METHOD-AT-POSITION (|(SET YOUR ERASABILITY TO ?)| 0) PERFORMER))))
                 ((AND
                   (AND
                    (EQ (CADDR MESSAGE) (QUOTE SIZE))
                    (AND (EQ (CADDDR MESSAGE) (QUOTE TO)) (ONE-LONG (CDDDDR MESSAGE))))
                   (METHOD-IF-NOT-HIDDEN
                    '#,(METHOD-AT-POSITION (|(SET YOUR SIZE TO ?)| 0) PERFORMER))))
                 ((AND
                   (AND
                    (EQ (CADDR MESSAGE) (QUOTE ABSOLUTE-SIZE))
                    (AND (EQ (CADDDR MESSAGE) (QUOTE TO)) (ONE-LONG (CDDDDR MESSAGE))))
                   (METHOD-IF-NOT-HIDDEN
                    '#,(METHOD-AT-POSITION (|(SET YOUR ABSOLUTE-SIZE TO ?)| 0) PERFORMER))))
                 ((AND
                   (AND
                    (EQ (CADDR MESSAGE) (QUOTE HOW-TO-DRAW))
                    (AND (EQ (CADDDR MESSAGE) (QUOTE TO)) (ONE-LONG (CDDDDR MESSAGE))))
                   (METHOD-IF-NOT-HIDDEN
                    '#,(METHOD-AT-POSITION (|(SET YOUR HOW-TO-DRAW TO ?)| 0) PERFORMER))))
                 ((AND
                   (AND
                    (EQ (CADDR MESSAGE) (QUOTE COLORS))
                    (AND (EQ (CADDDR MESSAGE) (QUOTE TO)) (ONE-LONG (CDDDDR MESSAGE))))
                   (METHOD-IF-NOT-HIDDEN
                    '#,(METHOD-AT-POSITION (|(SET YOUR COLORS TO ?)| 0) PERFORMER))))
                 ((AND
                   (AND
                    (EQ (CADDR MESSAGE) (QUOTE VALIDITY-OF-HOW-TO-DRAW))
                    (AND (EQ (CADDDR MESSAGE) (QUOTE TO)) (ONE-LONG (CDDDDR MESSAGE))))
                   (METHOD-IF-NOT-HIDDEN
                    '#,(METHOD-AT-POSITION
                        (|(SET YOUR VALIDITY-OF-HOW-TO-DRAW TO ?)| 0)
                        PERFORMER))))))))
        ((AND
          (EQ (CAR MESSAGE) (QUOTE RECALL))
          (AND
           (EQ (CADR MESSAGE) (QUOTE YOUR))
           (COND ((AND
                   (AND
                    (LET ((? (CADDR MESSAGE))) (MEMQ ? (QUOTE (XCOR YCOR))))
                    (NULL (CDDDR MESSAGE)))
                   (METHOD-IF-NOT-HIDDEN
                    '#,(METHOD-AT-POSITION
                        (|(RECALL YOUR {MEMQ ? (QUOTE (XCOR YCOR))})| 0)
                        PERFORMER))))
                 ((AND
                   (AND
                    (LET ((? (CADDR MESSAGE))) (MEMQ ? (QUOTE (XCOR YCOR HEADING))))
                    (NULL (CDDDR MESSAGE)))
                   (METHOD-IF-NOT-HIDDEN
                    '#,(METHOD-AT-POSITION
                        (|(RECALL YOUR {MEMQ ? (QUOTE (XCOR YCOR HEADING))})| 0)
                        PERFORMER))))
                 ((AND
                   (EQUAL (CDDR MESSAGE) (QUOTE (DRAW-PROCEDURE-BODY)))
                   (METHOD-IF-NOT-HIDDEN
                    '#,(METHOD-AT-POSITION
                        ((RECALL YOUR DRAW-PROCEDURE-BODY) 0)
                        PERFORMER))))
                 ((AND
                   (AND
                    (AND
                     (LISTP (CADDR MESSAGE))
                     (MEMQ (CAADDR MESSAGE) (QUOTE (DISPLAY ERASE)))
                     (EQUAL (CDADDR MESSAGE) (QUOTE (ACTIONS))))
                    (NULL (CDDDR MESSAGE)))
                   (METHOD-IF-NOT-HIDDEN
                    '#,(METHOD-AT-POSITION
                        (|(RECALL YOUR ({or DISPLAY ERASE} ACTIONS))| 0)
                        PERFORMER))))
                 ((AND
                   (EQUAL (CDDR MESSAGE) (QUOTE (HOW-TO-DRAW)))
                   (METHOD-IF-NOT-HIDDEN
                    '#,(METHOD-AT-POSITION ((RECALL YOUR HOW-TO-DRAW) 0) PERFORMER))))
                 ((AND
                   (EQUAL (CDDR MESSAGE) (QUOTE (ABSOLUTE-SIZE)))
                   (METHOD-IF-NOT-HIDDEN
                    '#,(METHOD-AT-POSITION ((RECALL YOUR ABSOLUTE-SIZE) 0) PERFORMER))))))))
        ((AND
          (AND (EQ (CAR MESSAGE) (QUOTE MAKE)) (ONE-LONG (CDR MESSAGE)))
          (METHOD-IF-NOT-HIDDEN '#,(METHOD-AT-POSITION (|(MAKE ?)| 0) PERFORMER))))
        ((AND
          (EQ (CAR MESSAGE) (QUOTE SHOW))
          (COND ((AND
                  (NULL (CDR MESSAGE))
                  (METHOD-IF-NOT-HIDDEN '#,(METHOD-AT-POSITION ((SHOW) 0) PERFORMER))))
                ((AND
                  (EQUAL (CDR MESSAGE) (QUOTE (ALL)))
                  (METHOD-IF-NOT-HIDDEN '#,(METHOD-AT-POSITION ((SHOW ALL) 0) PERFORMER))))))
         )
        ((AND
          (EQ (CAR MESSAGE) (QUOTE JUST))
          (COND ((AND
                  (EQUAL (CDR MESSAGE) (QUOTE (SHOW)))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION ((JUST SHOW) 0) PERFORMER))))
                ((AND
                  (EQUAL (CDR MESSAGE) (QUOTE (HIDE)))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION ((JUST HIDE) 0) PERFORMER)))))))
        ((AND
          (EQ (CAR MESSAGE) (QUOTE HIDE))
          (COND ((AND
                  (NULL (CDR MESSAGE))
                  (METHOD-IF-NOT-HIDDEN '#,(METHOD-AT-POSITION ((HIDE) 0) PERFORMER))))
                ((AND
                  (EQUAL (CDR MESSAGE) (QUOTE (ALL)))
                  (METHOD-IF-NOT-HIDDEN '#,(METHOD-AT-POSITION ((HIDE ALL) 0) PERFORMER))))))
         )
        ((AND
          (EQUAL MESSAGE (QUOTE (REDISPLAY)))
          (METHOD-IF-NOT-HIDDEN '#,(METHOD-AT-POSITION ((REDISPLAY) 0) PERFORMER))))
        ((AND
          (EQUAL MESSAGE (QUOTE (DISPLAY)))
          (METHOD-IF-NOT-HIDDEN '#,(METHOD-AT-POSITION ((DISPLAY) 0) PERFORMER))))
        ((AND
          (EQ (CAR MESSAGE) (QUOTE ERASE))
          (COND ((AND
                  (NULL (CDR MESSAGE))
                  (METHOD-IF-NOT-HIDDEN '#,(METHOD-AT-POSITION ((ERASE) 0) PERFORMER))))
                ((AND
                  (EQUAL (CDR MESSAGE) (QUOTE (BY CLEARING AREA)))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION ((ERASE BY CLEARING AREA) 0) PERFORMER)))))))
        ((AND
          (AND
           (EQ (CAR MESSAGE) (QUOTE RECOMPUTE))
           (AND
            (EQ (CADR MESSAGE) (QUOTE YOUR))
            (AND
             (EQ (CADDR MESSAGE) (QUOTE ABSOLUTE-SIZE))
             (AND
              (EQ (CADDDR MESSAGE) (QUOTE SINCE))
              (AND
               (EQ (CADR (CDDDDR MESSAGE)) (QUOTE IS))
               (AND
                (EQ (CADDR (CDDDDR MESSAGE)) (QUOTE NOW))
                (ONE-LONG (CDDDR (CDDDDR MESSAGE)))))))))
          (METHOD-IF-NOT-HIDDEN
           '#,(METHOD-AT-POSITION
               (|(RECOMPUTE YOUR ABSOLUTE-SIZE SINCE ? IS NOW ?)| 0)
               PERFORMER))))
        ((AND
          (AND
           (EQ (CAR MESSAGE) (QUOTE NOTICE))
           (AND
            (EQ (CADR MESSAGE) (QUOTE THAT))
            (AND
             (EQ (CADDDR MESSAGE) (QUOTE HAS))
             (AND
              (EQ (CAR (CDDDDR MESSAGE)) (QUOTE GROWN))
              (AND
               (EQ (CADR (CDDDDR MESSAGE)) (QUOTE BY))
               (ONE-LONG (CDDR (CDDDDR MESSAGE))))))))
          (METHOD-IF-NOT-HIDDEN
           '#,(METHOD-AT-POSITION (|(NOTICE THAT ? HAS GROWN BY ?)| 0) PERFORMER))))
        ((AND
          (AND
           (MEMQ (CAR MESSAGE) (QUOTE (FD FORWARD BK BACK RT RIGHT LT LEFT)))
           (ONE-LONG (CDR MESSAGE)))
          (METHOD-IF-NOT-HIDDEN
           '#,(METHOD-AT-POSITION
               (|({or FD FORWARD BK BACK RT RIGHT LT LEFT} ?)| 0)
               PERFORMER))))
        ((AND
          (AND (EQ (CAR MESSAGE) (QUOTE GROW)) (ONE-LONG (CDR MESSAGE)))
          (METHOD-IF-NOT-HIDDEN '#,(METHOD-AT-POSITION (|(GROW ?)| 0) PERFORMER))))
        ((AND
          (AND
           (MEMQ (CAR MESSAGE) (QUOTE (GROW SHRINK)))
           (AND
            (EQ (CADR MESSAGE) (QUOTE BY))
            (AND (EQ (CADDR MESSAGE) (QUOTE FACTOR)) (ONE-LONG (CDDDR MESSAGE)))))
          (METHOD-IF-NOT-HIDDEN
           '#,(METHOD-AT-POSITION (|({or GROW SHRINK} BY FACTOR ?)| 0) PERFORMER))))
        ((AND
          (AND (EQ (CAR MESSAGE) (QUOTE SHRINK)) (ONE-LONG (CDR MESSAGE)))
          (METHOD-IF-NOT-HIDDEN '#,(METHOD-AT-POSITION (|(SHRINK ?)| 0) PERFORMER))))
        ((AND
          (AND
           (EQ (CAR MESSAGE) (QUOTE PREPARE))
           (AND
            (EQ (CADR MESSAGE) (QUOTE TO))
            (AND
             (EQ (CADDR MESSAGE) (QUOTE MIX))
             (AND
              (EQ (CADDDR MESSAGE) (QUOTE COLORS))
              (AND
               (EQ (CAR (CDDDDR MESSAGE)) (QUOTE WITH))
               (ONE-LONG (CDR (CDDDDR MESSAGE))))))))
          (METHOD-IF-NOT-HIDDEN
           '#,(METHOD-AT-POSITION (|(PREPARE TO MIX COLORS WITH ?)| 0) PERFORMER))))
        ((AND
          (AND
           (EQ (CAR MESSAGE) (QUOTE SEQUENTIALLY))
           (AND
            (LISTP (CADR MESSAGE))
            (EQ (CAADR MESSAGE) (QUOTE DO))
            (AND
             (LISTP (CDADR MESSAGE))
             (EQ (CADADR MESSAGE) (QUOTE IN))
             (AND
              (LISTP (CDDADR MESSAGE))
              (AND
               (LISTP (CDR (CDDADR MESSAGE)))
               (AND
                (LISTP (CDDR (CDDADR MESSAGE)))
                (MEMQ (CADDR (CDDADR MESSAGE)) (QUOTE (CHANGE SET)))
                (AND
                 (LISTP (CDDDR (CDDADR MESSAGE)))
                 (EQ (CADDDR (CDDADR MESSAGE)) (QUOTE YOUR))
                 (AND
                  (LISTP (CDDDDR (CDDADR MESSAGE)))
                  (EQ (CAR (CDDDDR (CDDADR MESSAGE))) (QUOTE COLORS))
                  (AND
                   (LISTP (CDR (CDDDDR (CDDADR MESSAGE))))
                   (EQ (CADR (CDDDDR (CDDADR MESSAGE))) (QUOTE TO))
                   (ONE-LONG (CDDR (CDDDDR (CDDADR MESSAGE)))))))))))))
          (METHOD-IF-NOT-HIDDEN
           '#,(METHOD-AT-POSITION
               (|(SEQUENTIALLY (DO IN ? ? {or CHANGE SET} YOUR COLORS TO ?) %)| 0)
               PERFORMER))))
        ((AND
          (EQ (CAR MESSAGE) (QUOTE YIELD))
          (COND ((AND
                  (AND
                   (EQ (CADR MESSAGE) (QUOTE DISTANCE))
                   (AND
                    (EQ (CADDR MESSAGE) (QUOTE TO))
                    (AND
                     (AND (LISTP (CADDDR MESSAGE)) (LISTP (CDR (CADDDR MESSAGE))))
                     (NULL (CDDDDR MESSAGE)))))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION (|(YIELD DISTANCE TO (? ? %))| 0) PERFORMER))))
                ((AND
                  (EQ (CADR MESSAGE) (QUOTE HEADING))
                  (COND ((AND
                          (AND
                           (EQ (CADDR MESSAGE) (QUOTE TO))
                           (AND
                            (AND
                             (LISTP (CADDDR MESSAGE))
                             (LISTP (CDR (CADDDR MESSAGE))))
                            (NULL (CDDDDR MESSAGE))))
                          (METHOD-IF-NOT-HIDDEN
                           '#,(METHOD-AT-POSITION
                               (|(YIELD HEADING TO (? ? %))| 0)
                               PERFORMER))))
                        ((AND
                          (AND
                           (EQ (CADDR MESSAGE) (QUOTE FROM))
                           (AND
                            (AND
                             (LISTP (CADDDR MESSAGE))
                             (LISTP (CDR (CADDDR MESSAGE))))
                            (NULL (CDDDDR MESSAGE))))
                          (METHOD-IF-NOT-HIDDEN
                           '#,(METHOD-AT-POSITION
                               (|(YIELD HEADING FROM (? ? %))| 0)
                               PERFORMER))))))))))
        ((AND
          (EQUAL MESSAGE (QUOTE (RECALL YOUR STATE)))
          (METHOD-IF-NOT-HIDDEN
           '#,(METHOD-AT-POSITION ((RECALL YOUR STATE) 0) PERFORMER))))
        ((AND
          (AND
           (EQ (CAR MESSAGE) (QUOTE RECOMPUTE))
           (AND
            (EQ (CADR MESSAGE) (QUOTE YOUR))
            (AND
             (EQ (CADDR MESSAGE) (QUOTE STATE))
             (AND
              (EQ (CADDDR MESSAGE) (QUOTE SINCE))
              (AND
               (EQ (CADR (CDDDDR MESSAGE)) (QUOTE IS))
               (AND
                (EQ (CADDR (CDDDDR MESSAGE)) (QUOTE NOW))
                (ONE-LONG (CDDDR (CDDDDR MESSAGE)))))))))
          (METHOD-IF-NOT-HIDDEN
           '#,(METHOD-AT-POSITION
               (|(RECOMPUTE YOUR STATE SINCE ? IS NOW ?)| 0)
               PERFORMER))))
        ((AND
          (AND
           (EQ (CAR MESSAGE) (QUOTE NOTICE))
           (AND
            (EQ (CADR MESSAGE) (QUOTE THAT))
            (AND
             (EQ (CADDR MESSAGE) (QUOTE STATE))
             (AND
              (EQ (CADDDR MESSAGE) (QUOTE OF))
              (AND
               (EQ (CADR (CDDDDR MESSAGE)) (QUOTE IS))
               (AND
                (EQ (CADDR (CDDDDR MESSAGE)) (QUOTE NOW))
                (ONE-LONG (CDDDR (CDDDDR MESSAGE)))))))))
          (METHOD-IF-NOT-HIDDEN
           '#,(METHOD-AT-POSITION (|(NOTICE THAT STATE OF ? IS NOW ?)| 0) PERFORMER))))
        ((AND
          (AND
           (EQ (CAR MESSAGE) (QUOTE SET))
           (AND
            (EQ (CADR MESSAGE) (QUOTE YOUR))
            (AND
             (EQ (CADDR MESSAGE) (QUOTE STATE))
             (AND (EQ (CADDDR MESSAGE) (QUOTE TO)) (ONE-LONG (CDDDDR MESSAGE))))))
          (METHOD-IF-NOT-HIDDEN
           '#,(METHOD-AT-POSITION (|(SET YOUR STATE TO ?)| 1) PERFORMER))))
        ((AND
          (AND (EQ (CAR MESSAGE) (QUOTE SETTURTLE)) (ONE-LONG (CDR MESSAGE)))
          (METHOD-IF-NOT-HIDDEN '#,(METHOD-AT-POSITION (|(SETTURTLE ?)| 0) PERFORMER))))
        ((AND
          (AND (EQ (CAR MESSAGE) (QUOTE SETHEADING)) (ONE-LONG (CDR MESSAGE)))
          (METHOD-IF-NOT-HIDDEN '#,(METHOD-AT-POSITION (|(SETHEADING ?)| 0) PERFORMER))))
        ((AND
          (AND (MEMQ (CAR MESSAGE) (QUOTE (SETXY DELXY))) (ONE-LONG (CDDR MESSAGE)))
          (METHOD-IF-NOT-HIDDEN
           '#,(METHOD-AT-POSITION (|({or SETXY DELXY} ? ?)| 0) PERFORMER))))
        ((AND
          (EQ (CAR MESSAGE) (QUOTE MOVE))
          (COND ((AND
                  (AND (EQ (CADR MESSAGE) (QUOTE LEFT)) (ONE-LONG (CDDR MESSAGE)))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION (|(MOVE LEFT ?)| 0) PERFORMER))))
                ((AND
                  (AND (EQ (CADR MESSAGE) (QUOTE RIGHT)) (ONE-LONG (CDDR MESSAGE)))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION (|(MOVE RIGHT ?)| 0) PERFORMER))))
                ((AND
                  (AND (EQ (CADR MESSAGE) (QUOTE UP)) (ONE-LONG (CDDR MESSAGE)))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION (|(MOVE UP ?)| 0) PERFORMER))))
                ((AND
                  (AND (EQ (CADR MESSAGE) (QUOTE DOWN)) (ONE-LONG (CDDR MESSAGE)))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION (|(MOVE DOWN ?)| 0) PERFORMER))))
                ((AND
                  (AND
                   (LET ((? (CADR MESSAGE))) (MEMQ ? '(FORWARD BACK)))
                   (ONE-LONG (CDDR MESSAGE)))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION
                       (|(MOVE {MEMQ ? '(FORWARD BACK)} ?)| 0)
                       PERFORMER)))))))
        ((AND
          (AND
           (EQ (CAR MESSAGE) (QUOTE TURN))
           (AND
            (LET ((? (CADR MESSAGE))) (MEMQ ? '(RIGHT LEFT)))
            (ONE-LONG (CDDR MESSAGE))))
          (METHOD-IF-NOT-HIDDEN
           '#,(METHOD-AT-POSITION (|(TURN {MEMQ ? '(RIGHT LEFT)} ?)| 0) PERFORMER))))
        ((AND
          (AND
           (MEMQ (CAR MESSAGE) (QUOTE (DELX DELY SETX SETY)))
           (ONE-LONG (CDR MESSAGE)))
          (METHOD-IF-NOT-HIDDEN
           '#,(METHOD-AT-POSITION (|({or DELX DELY SETX SETY} ?)| 0) PERFORMER))))
        ((AND
          (AND (EQ (CAR MESSAGE) (QUOTE RUN)) (ONE-LONG (CDR MESSAGE)))
          (METHOD-IF-NOT-HIDDEN '#,(METHOD-AT-POSITION (|(RUN ?)| 0) PERFORMER))))
        ((AND
          (EQ (CAR MESSAGE) (QUOTE SET))
          (AND
           (EQ (CADR MESSAGE) (QUOTE YOUR))
           (COND ((AND
                   (AND
                    (EQ (CADDR MESSAGE) (QUOTE PEN-TYPE))
                    (AND (EQ (CADDDR MESSAGE) (QUOTE TO)) (ONE-LONG (CDDDDR MESSAGE))))
                   (METHOD-IF-NOT-HIDDEN
                    '#,(METHOD-AT-POSITION (|(SET YOUR PEN-TYPE TO ?)| 0) PERFORMER))))
                 ((AND
                   (AND
                    (EQ (CADDR MESSAGE) (QUOTE WHOLE))
                    (AND (EQ (CADDDR MESSAGE) (QUOTE TO)) (ONE-LONG (CDDDDR MESSAGE))))
                   (METHOD-IF-NOT-HIDDEN
                    '#,(METHOD-AT-POSITION (|(SET YOUR WHOLE TO ?)| 0) PERFORMER))))))))
        ((AND
          (EQ (CAR MESSAGE) (QUOTE PEN))
          (COND ((AND
                  (EQUAL (CDR MESSAGE) (QUOTE (UP)))
                  (METHOD-IF-NOT-HIDDEN '#,(METHOD-AT-POSITION ((PEN UP) 0) PERFORMER))))
                ((AND
                  (EQUAL (CDR MESSAGE) (QUOTE (DOWN)))
                  (METHOD-IF-NOT-HIDDEN '#,(METHOD-AT-POSITION ((PEN DOWN) 0) PERFORMER))))))
         )
        ((AND
          (EQUAL MESSAGE (QUOTE (REDISPLAY)))
          (METHOD-IF-NOT-HIDDEN '#,(METHOD-AT-POSITION ((REDISPLAY) 1) PERFORMER))))
        ((AND
          (EQUAL MESSAGE (QUOTE (CREATE NEW APPEARANCE)))
          (METHOD-IF-NOT-HIDDEN
           '#,(METHOD-AT-POSITION ((CREATE NEW APPEARANCE) 0) PERFORMER))))
        ((AND
          (EQUAL MESSAGE (QUOTE (FUSE YOUR PARTS)))
          (METHOD-IF-NOT-HIDDEN '#,(METHOD-AT-POSITION ((FUSE YOUR PARTS) 0) PERFORMER))))
        ((AND
          (EQ (CAR MESSAGE) (QUOTE WHEN))
          (AND
           (EQ (CADR MESSAGE) (QUOTE DRAWING))
           (COND ((AND
                   (AND
                    (EQ (CADDR MESSAGE) (QUOTE USE))
                    (EQ (CAR (CDDDDR MESSAGE)) (QUOTE OF)))
                   (METHOD-IF-NOT-HIDDEN
                    '#,(METHOD-AT-POSITION (|(WHEN DRAWING USE ? OF %)| 0) PERFORMER))))
                 ((AND
                   (EQ (CADDR MESSAGE) (QUOTE DO))
                   (METHOD-IF-NOT-HIDDEN
                    '#,(METHOD-AT-POSITION (|(WHEN DRAWING DO %)| 0) PERFORMER))))))))
        ((AND
          (AND
           (EQ (CAR MESSAGE) (QUOTE MAKE))
           (AND
            (EQ (CADDR MESSAGE) (QUOTE INTERPOLATION))
            (AND (EQ (CADDDR MESSAGE) (QUOTE TO)) (ONE-LONG (CDDDDR MESSAGE)))))
          (METHOD-IF-NOT-HIDDEN
           '#,(METHOD-AT-POSITION (|(MAKE ? INTERPOLATION TO ?)| 0) PERFORMER))))
        ((AND
          (EQUAL MESSAGE (QUOTE (UNMAKE)))
          (METHOD-IF-NOT-HIDDEN '#,(METHOD-AT-POSITION ((UNMAKE) 0) PERFORMER))))
        ((AND
          (AND (EQ (CAR MESSAGE) (QUOTE SAVE)) (ONE-LONG (CDR MESSAGE)))
          (METHOD-IF-NOT-HIDDEN '#,(METHOD-AT-POSITION (|(SAVE ?)| 0) PERFORMER)))))) 
(ASK PERFORMER CONSIDER ((XCOR SPEED) (YCOR SPEED)) SYNONYMS) 
(ASK PERFORMER CONSIDER ((GROW BY FACTOR SPEED) (SHRINK BY FACTOR SPEED)) SYNONYMS) 
(ASK PERFORMER CONSIDER ((GROW SPEED) (SHRINK SPEED)) SYNONYMS) 
(ASK
 PERFORMER
 CONSIDER
 ((TURN RIGHT SPEED) (TURN LEFT SPEED) (RIGHT SPEED) (LEFT SPEED))
 SYNONYMS) 
(ASK PERFORMER CONSIDER ((MOVE UP SPEED) (MOVE DOWN SPEED) (DELY SPEED)) SYNONYMS) 
(ASK PERFORMER CONSIDER ((MOVE RIGHT SPEED) (MOVE LEFT SPEED) (DELX SPEED)) SYNONYMS) 
(ASK
 PERFORMER
 CONSIDER
 ((MOVE FORWARD SPEED) SPEED (MOVE BACK SPEED) (FORWARD SPEED) (BACK SPEED))
 SYNONYMS) 
(ASK
 PERFORMER
 CONSIDER
 (SPEED (MOVE FORWARD SPEED) (MOVE BACK SPEED) (FORWARD SPEED) (BACK SPEED))
 SYNONYMS) 
(DEFUN D0373 NIL
  ((LAMBDA (STATE)
     (LET
      ((APPEARANCE-AND-STATE
        (LET
         ((*MESSAGE '(MAKE NIL)))
         (QUICK-COMPILED-ASK
          '#,(METHOD-AT-POSITION (|(MAKE ?)| 0) SOMETHING)
          '#,(ACTOR-OF (QUOTE APPEARANCE))))))
      (LET
       ((MYSELF (ACTOR-OF APPEARANCE-AND-STATE)) (*MESSAGE '(SET YOUR STATE TO ,STATE)))
       (QUICK-COMPILED-ASK
        '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
        '#,(ACTOR-OF (QUOTE APPEARANCE))))
      APPEARANCE-AND-STATE))
   (CAR (CDDDDR *MESSAGE)))) 
(DEFUN |(MAKE AN INSTANCE AT ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE MAKE))
   (AND
    (EQ (CADR OBJECT) (QUOTE AN))
    (AND
     (EQ (CADDR OBJECT) (QUOTE INSTANCE))
     (AND (EQ (CADDDR OBJECT) (QUOTE AT)) (ONE-LONG (CDDDDR OBJECT))))))) 
(DEFPROP |(MAKE AN INSTANCE AT ?)| (MAKE AN INSTANCE AT ?) PATTERN) 
(DEFUN D0371 NIL
  ((LAMBDA (PERFORMER)
     (LET
      ((APPEARANCE
        (LET
         ((*MESSAGE '(MAKE NIL)))
         (QUICK-COMPILED-ASK
          '#,(METHOD-AT-POSITION (|(MAKE ?)| 0) SOMETHING)
          '#,(ACTOR-OF (QUOTE APPEARANCE)))))
       (DRAW-PROCEDURES
        (LET
         ((MYSELF (ACTOR-OF PERFORMER)) (*MESSAGE '(RECALL YOUR DRAW-PROCEDURES)))
         (QUICK-COMPILED-ASK
          '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
          '#,(ACTOR-OF (QUOTE APPEARANCE))))))
      (LET
       ((MYSELF (ACTOR-OF APPEARANCE))
        (*MESSAGE
         '(DO
           WHEN
           RECEIVING
           (ERASE)
           (APPEARANCE-SETUP-ERASE)
           !,(ASK ,PERFORMER RECALL YOUR (ERASE ACTIONS)))))
       (QUICK-COMPILED-ASK
        '#,(METHOD-AT-POSITION (|(DO WHEN RECEIVING ? %)| 0) SOMETHING)
        '#,(ACTOR-OF (QUOTE APPEARANCE))))
      (LET
       ((MYSELF (ACTOR-OF APPEARANCE))
        (*MESSAGE
         '(DO
           WHEN
           RECEIVING
           (DISPLAY)
           (APPEARANCE-SETUP-DRAW)
           !,(ASK ,PERFORMER RECALL YOUR (DISPLAY ACTIONS)))))
       (QUICK-COMPILED-ASK
        '#,(METHOD-AT-POSITION (|(DO WHEN RECEIVING ? %)| 0) SOMETHING)
        '#,(ACTOR-OF (QUOTE APPEARANCE))))
      (COND (DRAW-PROCEDURES
             (LET
              ((MYSELF (ACTOR-OF APPEARANCE))
               (*MESSAGE '(SET YOUR DRAW-PROCEDURES TO ,DRAW-PROCEDURES)))
              (QUICK-COMPILED-ASK
               '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
               '#,(ACTOR-OF (QUOTE APPEARANCE))))))
      APPEARANCE))
   (CADDDR *MESSAGE))) 
(DEFUN |(MAKE APPEARANCE OF ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE MAKE))
   (AND
    (EQ (CADR OBJECT) (QUOTE APPEARANCE))
    (AND (EQ (CADDR OBJECT) (QUOTE OF)) (ONE-LONG (CDDDR OBJECT)))))) 
(DEFPROP |(MAKE APPEARANCE OF ?)| (MAKE APPEARANCE OF ?) PATTERN) 
(DEFUN D0370 NIL
  (LET
   ((DISPLAY-CODE
     (LAST-ELEMENT
      (LET
       ((*MESSAGE '(RECALL METHOD FOR DISPLAY)))
       (QUICK-COMPILED-ASK
        '#,(METHOD-AT-POSITION (|(RECALL METHOD FOR %)| 0) SOMETHING)
        '#,(ACTOR-OF (QUOTE APPEARANCE))))))
    (ERASE-CODE
     (LAST-ELEMENT
      (LET
       ((*MESSAGE '(RECALL METHOD FOR ERASE)))
       (QUICK-COMPILED-ASK
        '#,(METHOD-AT-POSITION (|(RECALL METHOD FOR %)| 0) SOMETHING)
        '#,(ACTOR-OF (QUOTE APPEARANCE)))))))
   (COND ((AND (NULL DISPLAY-CODE) (NULL ERASE-CODE))
          (SHOULDNT-HAPPEN
           'COMPILE-APPEARANCE
           '(,MYSELF |does not know how to erase or display|)))
         ((OR (EQUAL DISPLAY-CODE ERASE-CODE) (NULL ERASE-CODE))
          '(LAMBDA NIL ,DISPLAY-CODE))
         (T
          '(LAMBDA NIL
             (COND (:PENSTATE ,DISPLAY-CODE)
                   (:ERASERSTATE ,ERASE-CODE))))))) 
(DEFUN D0369 (MESSAGE)
  (COND ((AND
          (EQUAL MESSAGE (QUOTE (COMPILE AS FUNCTION)))
          (METHOD-IF-NOT-HIDDEN
           '#,(METHOD-AT-POSITION ((COMPILE AS FUNCTION) 0) APPEARANCE))))
        ((AND
          (EQ (CAR MESSAGE) (QUOTE MAKE))
          (COND ((AND
                  (AND
                   (EQ (CADR MESSAGE) (QUOTE APPEARANCE))
                   (AND (EQ (CADDR MESSAGE) (QUOTE OF)) (ONE-LONG (CDDDR MESSAGE))))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION (|(MAKE APPEARANCE OF ?)| 0) APPEARANCE))))
                ((AND
                  (AND
                   (EQ (CADR MESSAGE) (QUOTE AN))
                   (AND
                    (EQ (CADDR MESSAGE) (QUOTE INSTANCE))
                    (AND (EQ (CADDDR MESSAGE) (QUOTE AT)) (ONE-LONG (CDDDDR MESSAGE)))))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION (|(MAKE AN INSTANCE AT ?)| 0) APPEARANCE))))))))) 
(DEFUN D0375 NIL
  ((LAMBDA (ACTIONS)
     (COND ((NULL ACTIONS) NO-VALUE)
           ((EQ
             (LET
              ((*MESSAGE '(RECALL YOUR PERFORM-OR-RECALL)))
              (QUICK-COMPILED-ASK
               '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
               '#,(ACTOR-OF (QUOTE THE-TURTLE))))
             'RECALL)
            (LET
             ((*MESSAGE
               '(SET
                 YOUR
                 ACTIONS-PERFORMED
                 TO
                 ,(CONS-IF-NOT-MEMBER
                   (QUOTE-IF-NEED-BE (PROGN !,ACTIONS))
                   (ASK MYSELF RECALL YOUR ACTIONS-PERFORMED)))))
             (QUICK-COMPILED-ASK
              '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
              '#,(ACTOR-OF (QUOTE THE-TURTLE))))
            NO-VALUE)
           (T
            (LET
             ((STAGE-MODE
               (LET
                ((MYSELF (ACTOR-OF (QUOTE STAGE))) (*MESSAGE '(RECALL YOUR MODE)))
                (QUICK-COMPILED-ASK
                 '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
                 '#,(ACTOR-OF (QUOTE STAGE))))))
             (COND ((EQ STAGE-MODE 'NORMAL) (MAPC 'EVAL ACTIONS) NO-VALUE)
                   ((EQ STAGE-MODE 'SILENT) 'STAGE-IS-SILENT)
                   (T
                    (SHOULDNT-HAPPEN
                     'THE-TURTLE
                     '(|stage's mode is| ,STAGE-MODE |but should be normal or silent|)))))))
     )
   (CDR *MESSAGE))) 
(DEFUN |(PERFORM %)| (OBJECT) (EQ (CAR OBJECT) (QUOTE PERFORM))) 
(DEFPROP |(PERFORM %)| (PERFORM %) PATTERN) 
(DEFUN D0392 NIL (DIRECTOR-STARTDISPLAY) (DIRECTOR-WIPE)) 
(DEFUN D0391 NIL (DIRECTOR-STARTDISPLAY) (DIRECTOR-CLEAR-STAGE)) 
(DEFUN D0390 NIL (DIRECTOR-CLEAR-STAGE)) 
(DEFUN D0388 NIL
  (WIPE)
  (LET
   ((MYSELF (ACTOR-OF (QUOTE THE-CAST)))
    (*MESSAGE '(SEQUENTIALLY (ASK EACH OF YOUR VISIBLE-PARTS REDISPLAY))))
   (QUICK-COMPILED-ASK
    '#,(METHOD-AT-POSITION (|(SEQUENTIALLY (ASK EACH OF YOUR ? %) %)| 0) SOMETHING)
    '#,(ACTOR-OF (QUOTE THE-CAST))))
  (LET
   ((MYSELF (ACTOR-OF (QUOTE THE-TRAILS))) (*MESSAGE '(SHOW)))
   (QUICK-COMPILED-ASK
    '#,(METHOD-AT-POSITION ((SHOW) 0) PERFORMER)
    '#,(ACTOR-OF (QUOTE THE-TRAILS))))
  NO-VALUE) 
(DEFUN D0386 NIL
  (LET
   ((MYSELF (ACTOR-OF (QUOTE THE-CAST)))
    (*MESSAGE
     '(SEQUENTIALLY (BROADCAST OR ASK YOUR VISIBLE-PARTS CREATE NEW APPEARANCE))))
   (QUICK-COMPILED-ASK
    '#,(METHOD-AT-POSITION (|(SEQUENTIALLY (BROADCAST OR ASK YOUR ? %) %)| 0) SOMETHING)
    '#,(ACTOR-OF (QUOTE THE-CAST))))) 
(DEFUN D0385 NIL
  (LET
   ((MYSELF (ACTOR-OF (QUOTE STAGE))) (*MESSAGE '(FORGET YOUR HOW-TO-DRAW)))
   (QUICK-COMPILED-ASK
    '#,(METHOD-AT-POSITION (|(FORGET YOUR ?)| 0) SOMETHING)
    '#,(ACTOR-OF (QUOTE STAGE))))
  (TVSIZE
   (RUN-WITH-METHOD-INVISIBLE
    (LET
     ((*MESSAGE '(!,*MESSAGE)))
     (COMPILED-ASK
      '#,(LIST
          (METHOD-AT-POSITION (|(SET YOUR WIDTH TO ?)| 0) STAGE)
          (METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING))
      '#,(ACTOR-OF (QUOTE STAGE))))
    MYSELF
    *METHOD-BEING-RUN)
   (LET
    ((MYSELF (ACTOR-OF (QUOTE STAGE))) (*MESSAGE '(RECALL YOUR HEIGHT)))
    (QUICK-COMPILED-ASK
     '#,(METHOD-AT-POSITION ((RECALL YOUR HEIGHT) 0) STAGE)
     '#,(ACTOR-OF (QUOTE STAGE)))))
  (LET
   ((MYSELF (ACTOR-OF (QUOTE STAGE))) (*MESSAGE '(WIPE)))
   (QUICK-COMPILED-ASK
    '#,(METHOD-AT-POSITION ((WIPE) 0) STAGE)
    '#,(ACTOR-OF (QUOTE STAGE))))) 
(DEFUN |(SET YOUR WIDTH TO ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE SET))
   (AND
    (EQ (CADR OBJECT) (QUOTE YOUR))
    (AND
     (EQ (CADDR OBJECT) (QUOTE WIDTH))
     (AND (EQ (CADDDR OBJECT) (QUOTE TO)) (ONE-LONG (CDDDDR OBJECT))))))) 
(DEFPROP |(SET YOUR WIDTH TO ?)| (SET YOUR WIDTH TO ?) PATTERN) 
(DEFUN D0384 NIL
  (LET
   ((MYSELF (ACTOR-OF (QUOTE STAGE))) (*MESSAGE '(FORGET YOUR HOW-TO-DRAW)))
   (QUICK-COMPILED-ASK
    '#,(METHOD-AT-POSITION (|(FORGET YOUR ?)| 0) SOMETHING)
    '#,(ACTOR-OF (QUOTE STAGE))))
  (TVSIZE
   (LET
    ((MYSELF (ACTOR-OF (QUOTE STAGE))) (*MESSAGE '(RECALL YOUR WIDTH)))
    (QUICK-COMPILED-ASK
     '#,(METHOD-AT-POSITION ((RECALL YOUR WIDTH) 0) STAGE)
     '#,(ACTOR-OF (QUOTE STAGE))))
   (RUN-WITH-METHOD-INVISIBLE
    (LET
     ((*MESSAGE '(!,*MESSAGE)))
     (COMPILED-ASK
      '#,(LIST
          (METHOD-AT-POSITION (|(SET YOUR HEIGHT TO ?)| 0) STAGE)
          (METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING))
      '#,(ACTOR-OF (QUOTE STAGE))))
    MYSELF
    *METHOD-BEING-RUN))
  (LET
   ((MYSELF (ACTOR-OF (QUOTE STAGE))) (*MESSAGE '(WIPE)))
   (QUICK-COMPILED-ASK
    '#,(METHOD-AT-POSITION ((WIPE) 0) STAGE)
    '#,(ACTOR-OF (QUOTE STAGE))))) 
(DEFUN |(SET YOUR HEIGHT TO ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE SET))
   (AND
    (EQ (CADR OBJECT) (QUOTE YOUR))
    (AND
     (EQ (CADDR OBJECT) (QUOTE HEIGHT))
     (AND (EQ (CADDDR OBJECT) (QUOTE TO)) (ONE-LONG (CDDDDR OBJECT))))))) 
(DEFPROP |(SET YOUR HEIGHT TO ?)| (SET YOUR HEIGHT TO ?) PATTERN) 
(DEFUN D0383 NIL (-$ (FIRST (TURTLESIZE)) (*$ 2.0 :TVSTEP))) 
(DEFUN D0382 NIL (-$ (SECOND (TURTLESIZE)) (*$ 2.0 :TVSTEP))) 
(DEFUN D0381 NIL (SECOND (TVSIZE))) 
(DEFUN D0380 NIL (FIRST (TVSIZE))) 
(DEFUN D0379 NIL
  ((LAMBDA (NEW-VALUE)
     (RUN-WITH-METHOD-INVISIBLE
      (LET
       ((*MESSAGE '(!,*MESSAGE)))
       (COMPILED-ASK
        '#,(LIST
            (METHOD-AT-POSITION (|(SET YOUR WIDTH-OF-SCREEN TO ?)| 0) STAGE)
            (METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING))
        '#,(ACTOR-OF (QUOTE STAGE))))
      MYSELF
      *METHOD-BEING-RUN)
     (LET
      ((*MESSAGE '(SET YOUR VALIDITY-OF-HOW-TO-DRAW TO NIL)))
      (QUICK-COMPILED-ASK
       '#,(METHOD-AT-POSITION (|(SET YOUR VALIDITY-OF-HOW-TO-DRAW TO ?)| 0) PERFORMER)
       '#,(ACTOR-OF (QUOTE STAGE))))
     NEW-VALUE)
   (CAR (CDDDDR *MESSAGE)))) 
(DEFUN |(SET YOUR WIDTH-OF-SCREEN TO ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE SET))
   (AND
    (EQ (CADR OBJECT) (QUOTE YOUR))
    (AND
     (EQ (CADDR OBJECT) (QUOTE WIDTH-OF-SCREEN))
     (AND (EQ (CADDDR OBJECT) (QUOTE TO)) (ONE-LONG (CDDDDR OBJECT))))))) 
(DEFPROP |(SET YOUR WIDTH-OF-SCREEN TO ?)| (SET YOUR WIDTH-OF-SCREEN TO ?) PATTERN) 
(DEFUN D0378 NIL
  ((LAMBDA (NEW-VALUE)
     (RUN-WITH-METHOD-INVISIBLE
      (LET
       ((*MESSAGE '(!,*MESSAGE)))
       (COMPILED-ASK
        '#,(LIST
            (METHOD-AT-POSITION (|(SET YOUR HEIGHT-OF-SCREEN TO ?)| 0) STAGE)
            (METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING))
        '#,(ACTOR-OF (QUOTE STAGE))))
      MYSELF
      *METHOD-BEING-RUN)
     (LET
      ((*MESSAGE '(SET YOUR VALIDITY-OF-HOW-TO-DRAW TO NIL)))
      (QUICK-COMPILED-ASK
       '#,(METHOD-AT-POSITION (|(SET YOUR VALIDITY-OF-HOW-TO-DRAW TO ?)| 0) PERFORMER)
       '#,(ACTOR-OF (QUOTE STAGE))))
     NEW-VALUE)
   (CAR (CDDDDR *MESSAGE)))) 
(DEFUN |(SET YOUR HEIGHT-OF-SCREEN TO ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE SET))
   (AND
    (EQ (CADR OBJECT) (QUOTE YOUR))
    (AND
     (EQ (CADDR OBJECT) (QUOTE HEIGHT-OF-SCREEN))
     (AND (EQ (CADDDR OBJECT) (QUOTE TO)) (ONE-LONG (CDDDDR OBJECT))))))) 
(DEFPROP |(SET YOUR HEIGHT-OF-SCREEN TO ?)| (SET YOUR HEIGHT-OF-SCREEN TO ?) PATTERN) 
(DEFUN D0377 (MESSAGE)
  (COND ((AND
          (EQ (CAR MESSAGE) (QUOTE SET))
          (AND
           (EQ (CADR MESSAGE) (QUOTE YOUR))
           (COND ((AND
                   (AND
                    (EQ (CADDR MESSAGE) (QUOTE HEIGHT-OF-SCREEN))
                    (AND (EQ (CADDDR MESSAGE) (QUOTE TO)) (ONE-LONG (CDDDDR MESSAGE))))
                   (METHOD-IF-NOT-HIDDEN
                    '#,(METHOD-AT-POSITION (|(SET YOUR HEIGHT-OF-SCREEN TO ?)| 0) STAGE))))
                 ((AND
                   (AND
                    (EQ (CADDR MESSAGE) (QUOTE WIDTH-OF-SCREEN))
                    (AND (EQ (CADDDR MESSAGE) (QUOTE TO)) (ONE-LONG (CDDDDR MESSAGE))))
                   (METHOD-IF-NOT-HIDDEN
                    '#,(METHOD-AT-POSITION (|(SET YOUR WIDTH-OF-SCREEN TO ?)| 0) STAGE))))
                 ((AND
                   (AND
                    (EQ (CADDR MESSAGE) (QUOTE HEIGHT))
                    (AND (EQ (CADDDR MESSAGE) (QUOTE TO)) (ONE-LONG (CDDDDR MESSAGE))))
                   (METHOD-IF-NOT-HIDDEN
                    '#,(METHOD-AT-POSITION (|(SET YOUR HEIGHT TO ?)| 0) STAGE))))
                 ((AND
                   (AND
                    (EQ (CADDR MESSAGE) (QUOTE WIDTH))
                    (AND (EQ (CADDDR MESSAGE) (QUOTE TO)) (ONE-LONG (CDDDDR MESSAGE))))
                   (METHOD-IF-NOT-HIDDEN
                    '#,(METHOD-AT-POSITION (|(SET YOUR WIDTH TO ?)| 0) STAGE))))))))
        ((AND
          (EQ (CAR MESSAGE) (QUOTE RECALL))
          (AND
           (EQ (CADR MESSAGE) (QUOTE YOUR))
           (COND ((AND
                   (EQUAL (CDDR MESSAGE) (QUOTE (WIDTH)))
                   (METHOD-IF-NOT-HIDDEN
                    '#,(METHOD-AT-POSITION ((RECALL YOUR WIDTH) 0) STAGE))))
                 ((AND
                   (EQUAL (CDDR MESSAGE) (QUOTE (HEIGHT)))
                   (METHOD-IF-NOT-HIDDEN
                    '#,(METHOD-AT-POSITION ((RECALL YOUR HEIGHT) 0) STAGE))))
                 ((AND
                   (EQUAL (CDDR MESSAGE) (QUOTE (HEIGHT-OF-SCREEN)))
                   (METHOD-IF-NOT-HIDDEN
                    '#,(METHOD-AT-POSITION ((RECALL YOUR HEIGHT-OF-SCREEN) 0) STAGE))))
                 ((AND
                   (EQUAL (CDDR MESSAGE) (QUOTE (WIDTH-OF-SCREEN)))
                   (METHOD-IF-NOT-HIDDEN
                    '#,(METHOD-AT-POSITION ((RECALL YOUR WIDTH-OF-SCREEN) 0) STAGE))))))))
        ((AND
          (EQUAL MESSAGE (QUOTE (SAVE STAGE)))
          (METHOD-IF-NOT-HIDDEN '#,(METHOD-AT-POSITION ((SAVE STAGE) 0) STAGE))))
        ((AND
          (EQUAL MESSAGE (QUOTE (WIPE)))
          (METHOD-IF-NOT-HIDDEN '#,(METHOD-AT-POSITION ((WIPE) 0) STAGE))))
        ((AND
          (EQUAL MESSAGE (QUOTE (CLEAR)))
          (METHOD-IF-NOT-HIDDEN '#,(METHOD-AT-POSITION ((CLEAR) 0) STAGE))))
        ((AND
          (EQUAL MESSAGE (QUOTE (START DISPLAY)))
          (METHOD-IF-NOT-HIDDEN '#,(METHOD-AT-POSITION ((START DISPLAY) 0) STAGE))))
        ((AND
          (EQUAL MESSAGE (QUOTE (RESTART DISPLAY)))
          (METHOD-IF-NOT-HIDDEN '#,(METHOD-AT-POSITION ((RESTART DISPLAY) 0) STAGE)))))) 
(DEFUN D0402 NIL
  (LET
   ((STEPS
     (LET
      ((*MESSAGE '(RECALL YOUR STEPS-SINCE-LAST-APPEARANCE)))
      (QUICK-COMPILED-ASK
       '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
       '#,(ACTOR-OF (QUOTE THE-TRAILS))))))
   (COND (STEPS
          (LET
           ((*MESSAGE '(SET YOUR STEPS-SINCE-LAST-APPEARANCE TO NIL)))
           (QUICK-COMPILED-ASK
            '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
            '#,(ACTOR-OF (QUOTE THE-TRAILS))))
          (LET
           ((APPEARANCE
             (LET
              ((MYSELF (ACTOR-OF (QUOTE TRAIL-APPEARANCE))) (*MESSAGE '(MAKE NIL)))
              (QUICK-COMPILED-ASK
               '#,(METHOD-AT-POSITION (|(MAKE ?)| 0) SOMETHING)
               '#,(ACTOR-OF (QUOTE TRAIL-APPEARANCE))))))
           (LET
            ((MYSELF (ACTOR-OF APPEARANCE))
             (*MESSAGE '(DO WHEN RECEIVING (DISPLAY) !,STEPS)))
            (QUICK-COMPILED-ASK
             '#,(METHOD-AT-POSITION (|(DO WHEN RECEIVING ? %)| 0) SOMETHING)
             '#,(ACTOR-OF (QUOTE THE-TRAILS))))
           APPEARANCE))
         (T NO-VALUE)))) 
(DEFUN D0401 NIL NO-VALUE) 
(DEFUN D0400 NIL
  (MAPC
   'EVAL
   (LET
    ((*MESSAGE '(RECALL YOUR STEPS)))
    (QUICK-COMPILED-ASK
     '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
     '#,(ACTOR-OF (QUOTE THE-TRAILS)))))) 
(DEFUN |({or DISPLAY REDISPLAY})| (OBJECT)
  (AND (MEMQ (CAR OBJECT) (QUOTE (DISPLAY REDISPLAY))) (NULL (CDR OBJECT)))) 
(DEFPROP |({or DISPLAY REDISPLAY})| ({or DISPLAY REDISPLAY}) PATTERN) 
(DEFUN D0397 NIL
  ((LAMBDA (PENSTATE NEW-POSITION OLD-POSITION)
     (LET
      ((TRAIL-CODE
        '(PROGN
          (PENUP)
          (SETTURTLE (QUOTE ,OLD-POSITION))
          ,PENSTATE
          (SETTURTLE (QUOTE ,NEW-POSITION)))))
      (LET
       ((*MESSAGE
         '(SET
           YOUR
           STEPS
           TO
           ,(CONS (QUOTE-IF-NEED-BE ,TRAIL-CODE) (ASK MYSELF RECALL YOUR STEPS)))))
       (QUICK-COMPILED-ASK
        '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
        '#,(ACTOR-OF (QUOTE THE-TRAILS))))
      (LET
       ((*MESSAGE
         '(SET
           YOUR
           STEPS-SINCE-LAST-APPEARANCE
           TO
           ,(CONS
             (QUOTE-IF-NEED-BE ,TRAIL-CODE)
             (ASK MYSELF RECALL YOUR STEPS-SINCE-LAST-APPEARANCE)))))
       (QUICK-COMPILED-ASK
        '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
        '#,(ACTOR-OF (QUOTE THE-TRAILS))))))
   (CADDR (CDDDDR *MESSAGE)) (CAR (CDDDDR *MESSAGE)) (CADDR *MESSAGE))) 
(DEFUN |(MOVING FROM ? TO ? WITH ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE MOVING))
   (AND
    (EQ (CADR OBJECT) (QUOTE FROM))
    (AND
     (EQ (CADDDR OBJECT) (QUOTE TO))
     (AND (EQ (CADR (CDDDDR OBJECT)) (QUOTE WITH)) (ONE-LONG (CDDR (CDDDDR OBJECT)))))))) 
(DEFPROP |(MOVING FROM ? TO ? WITH ?)| (MOVING FROM ? TO ? WITH ?) PATTERN) 
(DEFUN D0396 NIL
  (LET
   ((*MESSAGE '(SET YOUR STEPS TO NIL)))
   (QUICK-COMPILED-ASK
    '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
    '#,(ACTOR-OF (QUOTE THE-TRAILS))))
  (LET
   ((*MESSAGE '(SET YOUR STEPS-SINCE-LAST-APPEARANCE TO NIL)))
   (QUICK-COMPILED-ASK
    '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
    '#,(ACTOR-OF (QUOTE THE-TRAILS))))) 
(DEFUN D0395 (MESSAGE)
  (COND ((AND
          (EQUAL MESSAGE (QUOTE (SET YOUR VISIBILITY TO NIL)))
          (METHOD-IF-NOT-HIDDEN
           '#,(METHOD-AT-POSITION ((SET YOUR VISIBILITY TO NIL) 0) THE-TRAILS))))
        ((AND
          (AND
           (EQ (CAR MESSAGE) (QUOTE MOVING))
           (AND
            (EQ (CADR MESSAGE) (QUOTE FROM))
            (AND
             (EQ (CADDDR MESSAGE) (QUOTE TO))
             (AND
              (EQ (CADR (CDDDDR MESSAGE)) (QUOTE WITH))
              (ONE-LONG (CDDR (CDDDDR MESSAGE)))))))
          (METHOD-IF-NOT-HIDDEN
           '#,(METHOD-AT-POSITION (|(MOVING FROM ? TO ? WITH ?)| 0) THE-TRAILS))))
        ((AND
          (AND (MEMQ (CAR MESSAGE) (QUOTE (DISPLAY REDISPLAY))) (NULL (CDR MESSAGE)))
          (METHOD-IF-NOT-HIDDEN
           '#,(METHOD-AT-POSITION (|({or DISPLAY REDISPLAY})| 0) THE-TRAILS))))
        ((AND
          (EQUAL MESSAGE (QUOTE (ERASE)))
          (METHOD-IF-NOT-HIDDEN '#,(METHOD-AT-POSITION ((ERASE) 0) THE-TRAILS))))
        ((AND
          (EQUAL MESSAGE (QUOTE (CREATE NEW APPEARANCE)))
          (METHOD-IF-NOT-HIDDEN
           '#,(METHOD-AT-POSITION ((CREATE NEW APPEARANCE) 0) THE-TRAILS)))))) 
(DEFUN D0406 NIL NIL) 
(DEFUN D0405 NIL '(LAMBDA NIL !,(REST (ASK MYSELF RECALL METHOD FOR DISPLAY)))) 
(DEFUN D0404 (MESSAGE)
  (COND ((AND
          (EQUAL MESSAGE (QUOTE (COMPILE AS FUNCTION)))
          (METHOD-IF-NOT-HIDDEN
           '#,(METHOD-AT-POSITION ((COMPILE AS FUNCTION) 0) TRAIL-APPEARANCE))))
        ((AND
          (EQUAL MESSAGE (QUOTE (ERASE)))
          (METHOD-IF-NOT-HIDDEN '#,(METHOD-AT-POSITION ((ERASE) 0) TRAIL-APPEARANCE)))))) 
(COMMENT AND NOW FOR THE ODDS AND ENDS) 
(ASK SOMETHING ADD PERFORMER TO YOUR LIST OF OFFSPRING) 
(ASK PERFORMER MAKE SYNONYM OBJECT) 
(REAP-SYMBOLS-IN-ACTOR (ACTOR-OF (QUOTE PERFORMER))) 
(ASK PERFORMER ADD THE-CAST TO YOUR LIST OF OFFSPRING) 
(REAP-SYMBOLS-IN-ACTOR (ACTOR-OF (QUOTE THE-CAST))) 
(ASK SOMETHING ADD APPEARANCE TO YOUR LIST OF OFFSPRING) 
(REAP-SYMBOLS-IN-ACTOR (ACTOR-OF (QUOTE APPEARANCE))) 
(ASK PERFORMER ADD INTERPOLATION TO YOUR LIST OF OFFSPRING) 
(ASK THE-CAST ADD INTERPOLATION TO YOUR LIST OF PARTS) 
(REAP-SYMBOLS-IN-ACTOR (ACTOR-OF (QUOTE INTERPOLATION))) 
(ASK SOMETHING ADD THE-TURTLE TO YOUR LIST OF OFFSPRING) 
(REAP-SYMBOLS-IN-ACTOR (ACTOR-OF (QUOTE THE-TURTLE))) 
(ASK PERFORMER ADD STAGE TO YOUR LIST OF OFFSPRING) 
(ASK THE-CAST ADD STAGE TO YOUR LIST OF PARTS) 
(ASK STAGE MAKE SYNONYM SCREEN) 
(REAP-SYMBOLS-IN-ACTOR (ACTOR-OF (QUOTE STAGE))) 
(ASK PERFORMER ADD THE-TRAILS TO YOUR LIST OF OFFSPRING) 
(ASK THE-CAST ADD THE-TRAILS TO YOUR LIST OF PARTS) 
(REAP-SYMBOLS-IN-ACTOR (ACTOR-OF (QUOTE THE-TRAILS))) 
(ASK APPEARANCE ADD TRAIL-APPEARANCE TO YOUR LIST OF OFFSPRING) 
(REAP-SYMBOLS-IN-ACTOR (ACTOR-OF (QUOTE TRAIL-APPEARANCE))) 