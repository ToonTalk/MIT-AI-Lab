;; -*-lisp-*- produced by Director (IN MACLISP)

(INCLUDE |ai:ken;declare >|) 
(INCLUDE |ai:ken;declare >|) 
(DEFCOMMENT SOME) 
(DEFINE-FORM
 (ADD-VARIABLE-PAIR-TO-ACTOR VARIABLE ALISTS NEW-PAIR)
 (COND ((NULL ALISTS) (MAKE-INTERNAL-VARIABLES MYSELF NEW-PAIR))
       ((SYMBOLP VARIABLE)
        (COND ((FIRST ALISTS) (NCONC (FIRST ALISTS) (LIST NEW-PAIR)))
              (T (REPLACE-FIRST ALISTS (LIST NEW-PAIR)))))
       (T
        (COND ((REST ALISTS) (NCONC (REST ALISTS) (LIST NEW-PAIR)))
              (T (REPLACE-REST ALISTS (LIST NEW-PAIR))))))) 
(DEFINE-FORM
 (RECALL-VALUE-OF-VARIABLE VARIABLE)
 (DO
  ((ACTOR MYSELF (PARENT-OF ACTOR)))
  ((NULL ACTOR) NOTHING-FOUND)
  (LET
   ((PAIR (LOOK-UP-VARIABLE-IN-ACTOR VARIABLE ACTOR)))
   (COND (PAIR (RETURN (SECOND PAIR))))))) 
(DEFINE-FORM
 (LOOK-UP-VARIABLE-IN-ACTOR VARIABLE ACTOR)
 (LET*
  ((ALISTS (INTERNAL-RECALL-YOUR-VARIABLE-OF ACTOR))
   (PAIR (ASSQ-ASSOC VARIABLE ALISTS)))
  (COND (PAIR
         (COND ((AND (THIRD PAIR) (NOT (ACTOR-EQ ACTOR MYSELF))) NIL)
               (T PAIR)))))) 
(DEFINE-FORM
 (VALUE-OF-SYNONYMS SYNONYMS)
 (DO
  ((S SYNONYMS (REST S))
   (VALUE NOTHING-FOUND)
   (ALISTS (INTERNAL-RECALL-YOUR-VARIABLE-OF MYSELF)))
  ((NULL S) VALUE)
  (LET
   ((NEW-VALUE (RECALL-VALUE-OF-VARIABLE (FIRST S))))
   (COND ((EQ NEW-VALUE NOTHING-FOUND))
         ((EQual NEW-VALUE VALUE) (FORGET-YOUR-VARIABLE (FIRST S) ALISTS NIL))
         ((EQ VALUE NOTHING-FOUND)
          (SETQ VALUE NEW-VALUE)
          (FORGET-YOUR-VARIABLE (FIRST S) ALISTS NIL))
         (T
          (SHOULDNT-HAPPEN
           'VALUE-OF-SYNONYMS
           '(|;Having trouble considering|
             ,SYNONYMS
             |synonyms, since one has a value of|
             ,VALUE
             |while|
             ,(FIRST S)
             |has a value of|
             ,NEW-VALUE))))))) 
(DEFINE-FORM
 (PROTECTED-ACTOR-BUT-OK NAME)
 (SHOULDNT-HAPPEN
  NAME
  '(|You are trying to unmake me and I'm protected.  Type (?) for help.|)
  '(|type "p " and I'll ignored this./
If you really want to kill|
    ,NAME
    |then remove its name from the variable *protected-actors/
and then type "(return t)"|))) 
(DEFINE-FORM
 (MAKE-KEEP-SENDING-TYPE-BODY SENDING-FUNCTION PATTERN ACTION)
 (LET*
  ((PATTERN-FORM (QUOTE-ALLOWING-EVAL-AND-UNPACK PATTERN))
   (ACTION-FORM (QUOTE-ALLOWING-EVAL-AND-UNPACK ACTION))
   (DATABASE-METHOD-FORM '(MAKE-NORMAL-METHOD ,PATTERN-FORM ,ACTION-FORM)))
  (COND ((AND (QUOTED? PATTERN-FORM) (QUOTED? ACTION-FORM))
         (LIST
          SENDING-FUNCTION
          PATTERN-FORM
          (LIST 'QUOTE-SHARP-COMMA DATABASE-METHOD-FORM)
          MYSELF))
        (T '(,SENDING-FUNCTION ,PATTERN-FORM ,DATABASE-METHOD-FORM ,MYSELF))))) 
(DEFINE-FORM
 (RUN-FIRST-TO-MATCH ITEMS METHOD METHOD-PREDICATE)
 (DO
  ((I ITEMS (REST I)))
  ((NULL I) 'DIRECTOR-SYMBOL-FOR-NOTHING-FOUND)
  (COND ((FUNCALL METHOD-PREDICATE (FIRST I))
         (LET ((*MESSAGE (FIRST I))) (RETURN (RUN-METHOD METHOD))))))) 
(DEFINE-FORM
 (RUN-FIRST-THATS-EQUAL ITEMS METHOD METHOD-PATTERN)
 (DO
  ((I ITEMS (REST I)))
  ((NULL I) 'DIRECTOR-SYMBOL-FOR-NOTHING-FOUND)
  (COND ((EQUAL METHOD-PATTERN (FIRST I))
         (LET ((*MESSAGE (FIRST I))) (RETURN (RUN-METHOD METHOD))))))) 
(DEFINE-FORM
 (MESSAGE-WITH-FOLLOWUP MESSAGE FOLLOWUP)
 (COND (FOLLOWUP '(SEQUENTIALLY ,MESSAGE !,FOLLOWUP))
       (T MESSAGE))) 
(DEFINE-FUNCTION
 IS-ANY-ANCESTOR-OF
 (ACTOR OTHER)
 (COND ((NULL ACTOR) NIL)
       ((ACTOR-EQ ACTOR OTHER) ACTOR)
       (ACTOR (IS-ANY-ANCESTOR-OF (PARENT-OF ACTOR) OTHER)))) 
(DEFCOMMENT PRINT) 
(SETQ *DEFAULT-FILE-OBJECT NIL) 
(DEFINE-FORM
 (COLLECT-ALL-VARIABLE-NAMES ACTOR)
 (LET
  (((ATOMIC-ALIST . NON-ATOMIC-ALIST) (INTERNAL-RECALL-YOUR-VARIABLE-OF ACTOR)))
  '(PARENT
    !,(DELQ 'INTERNAL-NAME-OF-ITEMS-MEMORIZED (MAPCAR 'CAR ATOMIC-ALIST))
    !,(MAPCAR 'CAR NON-ATOMIC-ALIST)))) 
(DEFINE-FORM
 (PRINT-NAME-VALUE NAME VALUE SYNONYMS FILE-OBJECT)
 (COND (NAME
        (TERPRI FILE-OBJECT)
        (PRINC '|My | FILE-OBJECT)
        (PRINC NAME FILE-OBJECT)
        (COND (SYNONYMS
               (PRINC '| (also known as | FILE-OBJECT)
               (PRINC-WITHOUT-PARENS SYNONYMS FILE-OBJECT)
               (PRINC '|)| FILE-OBJECT)))
        (PRINC '| is | FILE-OBJECT)
        (DICKS-PRIN1 VALUE FILE-OBJECT 'GRIND)))) 
(DEFINE-SIMPLE-MACRO
 (ADD-HELP-TO-ACTOR ACTOR PATTERN COMMENT)
 (*ADD-HELP-TO-ACTOR ACTOR PATTERN COMMENT)
 NIL) 
(COMMENT HERE COMES THE ACTORS THEMSELVES) 
(OR
 (GET-ACTOR (QUOTE SOMETHING))
 (PLACE-ACTOR-ON-NAME (LIST (QUOTE DIRECTOR-SYMBOL-FOR-ACTOR) NIL) (QUOTE SOMETHING))) 
(REPLACE-REST
 (ACTOR-OF (QUOTE SOMETHING))
 (LIST
  NIL
  (CONS
   (QUOTE VALUE-METHOD)
   (CONS
    (QUOTE
     (((NAME SOMETHING PRIVATE)
       (PRIVATE-VARIABLE-NAMES
        (OFFSPRING                               THINGS-TO-DO-NEXT
         NAME                                    SYNONYMS
         WHOLE                                   PARTS
         INTERNAL-NAME-OF-ITEMS-MEMORIZED))
       (CLOCK DEFAULT-CLOCK)
       (DEFAULT-SPEED 100.0))))
    (QUOTE ((INTERNAL-RECALL-YOUR-VARIABLE)))))
  (QUOTE (METHOD-SELECTOR D0059 TO-BE-FILLED-IN-WITH-SECOND-TO-LAST-CONS))
  (QUOTE (NORMAL-METHOD D0060 |(DO ONCE WHEN RECEIVING ? %)|))
  (QUOTE (NORMAL-METHOD D0061 |(DO WHEN RECEIVING ? %)|))
  (QUOTE (NORMAL-METHOD D0062 |(MACRO EXPAND WHEN RECEIVING ? %)|))
  (QUOTE (NORMAL-METHOD D0063 (RECALL YOUR SIBLINGS)))
  (QUOTE (NORMAL-METHOD D0064 (RECALL YOUR DESCENDANTS)))
  (QUOTE (NORMAL-METHOD D0065 (RECALL YOUR CHILDLESS-DESCENDANTS)))
  (QUOTE (NORMAL-METHOD D0066 (RECALL YOUR PARENT) ((PRIMITIVE? . T))))
  (QUOTE (NORMAL-METHOD D0067 |(SET YOUR PARENT TO ?)|))
  (QUOTE (NORMAL-METHOD D0070 |(SET YOUR WHOLE TO ?)|))
  (QUOTE (NORMAL-METHOD D0073 |(SET YOUR ? TO ?)| ((PRIMITIVE? . T))))
  (QUOTE (NORMAL-METHOD D0074 |(RECALL YOUR ?)| ((PRIMITIVE? . T))))
  (QUOTE (NORMAL-METHOD D0075 |(FORGET YOUR ?)|))
  (QUOTE (NORMAL-METHOD D0076 (FORGET EVERYTHING)))
  (QUOTE (NORMAL-METHOD D0077 |(CONSIDER ? SYNONYMS)|))
  (QUOTE (NORMAL-METHOD D0078 |(CONSIDER ? COMPONENTS OF ?)|))
  (QUOTE (NORMAL-METHOD D0079 |(WHEN REPRESENTING ? USE AN ARRAY OF SIZE ?)|))
  (QUOTE (NORMAL-METHOD D0080 |(DO ONLY FOR YOURSELF WHEN RECEIVING ? %)|))
  (QUOTE
   (MACRO-METHOD
    |MACRO-(CHANGE YOUR ?VARIABLE TO ?VALUE)SOMETHING|
    |(CHANGE YOUR ? TO ?)|))
  (QUOTE (MACRO-METHOD |MACRO-(TO %MESSAGE)SOMETHING| |(TO %)|))
  (QUOTE
   (MACRO-METHOD
    |MACRO-(INCREMENT YOUR ?VARIABLE BY ?AMOUNT)SOMETHING|
    |(INCREMENT YOUR ? BY ?)|))
  (QUOTE
   (MACRO-METHOD
    |MACRO-(MULTIPLY YOUR ?VARIABLE BY ?FACTOR)SOMETHING|
    |(MULTIPLY YOUR ? BY ?)|))
  (QUOTE
   (MACRO-METHOD
    |MACRO-(ADD ?VALUE TO YOUR LIST OF ?LIST-NAME)SOMETHING|
    |(ADD ? TO YOUR LIST OF ?)|))
  (QUOTE
   (MACRO-METHOD
    |MACRO-(ADD ?VALUE TO YOUR LIST OF ?VARIABLE REGARDLESS)SOMETHING|
    |(ADD ? TO YOUR LIST OF ? REGARDLESS)|))
  (QUOTE
   (MACRO-METHOD
    |MACRO-(REMOVE ?ELEMENT FROM YOUR LIST OF ?LIST-NAME)SOMETHING|
    |(REMOVE ? FROM YOUR LIST OF ?)|))
  (QUOTE (NORMAL-METHOD D0081 (LIST ALL YOUR VARIABLE NAMES)))
  (QUOTE (NORMAL-METHOD D0082 |(RECALL EACH OF YOUR ?)|))
  (QUOTE (NORMAL-METHOD D0083 |(MAKE AN INSTANCE NAMED ? COPYING ?)|))
  (QUOTE (MACRO-METHOD |MACRO-(MAKE)SOMETHING| (MAKE)))
  (QUOTE (NORMAL-METHOD D0084 |(MAKE ?)|))
  (QUOTE (NORMAL-METHOD D0089 (MAKE UP A NAME)))
  (QUOTE (NORMAL-METHOD D0091 (MAKE UP AN UNINTERNED NAME)))
  (QUOTE (NORMAL-METHOD D0093 |(IF NEW MAKE ?)|))
  (QUOTE (NORMAL-METHOD D0094 (CLONE)))
  (QUOTE (NORMAL-METHOD D0095 |(CLONE AND NAME IT ?)|))
  (QUOTE (NORMAL-METHOD D0096 |(MAKE SYNONYM ?)|))
  (QUOTE (NORMAL-METHOD D0098 (ABSORB YOUR PARTS)))
  (QUOTE (NORMAL-METHOD D0099 (REMOB)))
  (QUOTE (NORMAL-METHOD D0100 (DISEMBODY)))
  (QUOTE (NORMAL-METHOD D0104 (UNMAKE)))
  (QUOTE (NORMAL-METHOD D0110 |(MEMORIZE ?)|))
  (QUOTE (NORMAL-METHOD D0112 |(FORGET ITEM ?)|))
  (QUOTE (NORMAL-METHOD D0114 |(RECALL ALL POSSIBLE ITEMS MATCHING ?)|))
  (QUOTE
   (MACRO-METHOD
    |MACRO-(RECALL AN ITEM MATCHING ?PATTERN THEN %ACTION)SOMETHING|
    |(RECALL AN ITEM MATCHING ? THEN %)|))
  (QUOTE
   (MACRO-METHOD
    |MACRO-(RECALL EACH ITEM MATCHING ?PATTERN THEN %ACTION)SOMETHING|
    |(RECALL EACH ITEM MATCHING ? THEN %)|))
  (QUOTE (NORMAL-METHOD D0115 |(COLLECT ITEMS MEMORIZED MATCHING ?)|))
  (QUOTE (NORMAL-METHOD D0117 |(FORGET ITEMS MATCHING ?)|))
  (QUOTE (NORMAL-METHOD D0119 (TICK)))
  (QUOTE (NORMAL-METHOD D0120 |(PLAN AFTER RECEIVING ? TO ?)|))
  (QUOTE (MACRO-METHOD |MACRO-(DO {or AT IN} ? ? %)SOMETHING| |(DO {or AT IN} ? ? %)|))
  (QUOTE
   (MACRO-METHOD
    |MACRO-({MEMQ ?ACTION '(PLAN GRADUALLY REPEAT ASK BROADCAST)} %REST)SOMETHING|
    |({MEMQ ? '(PLAN GRADUALLY REPEAT ASK BROADCAST)} %)|))
  (QUOTE
   (MACRO-METHOD
    |MACRO-(SEQUENTIALLY (PLAN NEXT %MESSAGE) %FOLLOWUP)SOMETHING|
    |(SEQUENTIALLY (PLAN NEXT %) %)|))
  (QUOTE (NORMAL-METHOD D0121 |(SEQUENTIALLY (PLAN AFTER ? ? %) %)|))
  (QUOTE (NORMAL-METHOD D0123 (STOP EVERYTHING)))
  (QUOTE (NORMAL-METHOD D0124 |(WAIT FOR %)|))
  (QUOTE
   (MACRO-METHOD
    |MACRO-(SEQUENTIALLY (CONCURRENTLY %ACTIONS) %FOLLOWUP)SOMETHING|
    |(SEQUENTIALLY (CONCURRENTLY %) %)|))
  (QUOTE (NORMAL-METHOD D0125 |(CONCURRENTLY %)|))
  (QUOTE (NORMAL-METHOD D0126 |(DO THE FOLLOWING %)|))
  (QUOTE
   (MACRO-METHOD
    |MACRO-(SEQUENTIALLY (REPEAT ?MESSAGE FOREVER) %FOLLOWUP)SOMETHING|
    |(SEQUENTIALLY (REPEAT ? FOREVER) %)|))
  (QUOTE (NORMAL-METHOD D0127 |(SEQUENTIALLY (REPEAT ? ? TIMES) %)|))
  (QUOTE
   (NORMAL-METHOD
    D0128
    |(SEQUENTIALLY (DO AT SPEED ? ASK ? {or SET CHANGE} YOUR ? TO ?) %)|))
  (QUOTE
   (NORMAL-METHOD D0129 |(SEQUENTIALLY (DO AT SPEED ? {or SET CHANGE} YOUR ? TO ?) %)|))
  (QUOTE (NORMAL-METHOD D0130 |(SEQUENTIALLY (DO IN ? ? % ?) %)|))
  (QUOTE (NORMAL-METHOD D0131 |(SEQUENTIALLY (DO AT SPEED ? % ?) %)|))
  (QUOTE
   (NORMAL-METHOD D0132 |(SEQUENTIALLY (GRADUALLY ASK ? {or SET CHANGE} YOUR ? TO ?) %)|))
  (QUOTE
   (NORMAL-METHOD D0133 |(SEQUENTIALLY (GRADUALLY {or SET CHANGE} YOUR ? TO ?) %)|))
  (QUOTE (NORMAL-METHOD D0134 |(SEQUENTIALLY (GRADUALLY ASK ? % ?) %)|))
  (QUOTE (NORMAL-METHOD D0135 |(SEQUENTIALLY (GRADUALLY % ?) %)|))
  (QUOTE (NORMAL-METHOD D0136 |(SEQUENTIALLY (BROADCAST OR ASK YOUR ? %) %)|))
  (QUOTE (NORMAL-METHOD D0137 |(SEQUENTIALLY (BROADCAST TO YOUR ? %) %)|))
  (QUOTE (NORMAL-METHOD D0138 |(SEQUENTIALLY (ASK YOUR ? %) %)|))
  (QUOTE (NORMAL-METHOD D0139 |(SEQUENTIALLY (ASK EACH OF YOUR ? %) %)|))
  (QUOTE (NORMAL-METHOD D0140 |(SEQUENTIALLY (ASK EACH OF ? %) %)|))
  (QUOTE (NORMAL-METHOD D0141 |(SEQUENTIALLY (ASK ? %) %)|))
  (QUOTE (NORMAL-METHOD D0142 |(SEQUENTIALLY %)|))
  (QUOTE (NORMAL-METHOD D0143 |(KEEP DOING UNTIL ? %)|))
  (QUOTE (NORMAL-METHOD D0144 |(ARE YOU {or A AN} ?)|))
  (QUOTE (NORMAL-METHOD D0145 |(FIND ANCESTOR MATCHING ?)|))
  (QUOTE (NORMAL-METHOD D0146 |(RECALL INTERNAL METHOD FOR %)| ((PRIMITIVE? . T))))
  (QUOTE (NORMAL-METHOD D0147 |(RECALL METHOD FOR %)| ((PRIMITIVE? . T))))
  (QUOTE (NORMAL-METHOD D0148 |(REMOVE METHOD FOR %)| ((PRIMITIVE? . T))))
  (QUOTE (NORMAL-METHOD D0149 |(TRACE %)|))
  (QUOTE (NORMAL-METHOD D0150 |(UNTRACE ?)|))
  (QUOTE (NORMAL-METHOD D0151 (UNTRACE)))
  (QUOTE (NORMAL-METHOD D0152 |(CONSTRAIN YOUR ? TO EQUAL ? OF ? OF ?)|))
  (QUOTE (NORMAL-METHOD D0153 |(TELL EACH OF YOUR ? WHENEVER YOUR ? IS CHANGED)|))
  (QUOTE (NORMAL-METHOD D0155 |(TELL YOUR ? WHENEVER YOUR ? IS CHANGED)|))
  (QUOTE (NORMAL-METHOD D0158 |(NOTICE THAT ? OF ? IS NOW ?)| ((PRIMITIVE? . T))))
  (QUOTE
   (NORMAL-METHOD
    D0159
    |(PRINT {MEMQ ? '(MEMORY VARIABLES SCRIPT DATABASE ALL)} ON FILE ?)|))
  (QUOTE
   (NORMAL-METHOD D0160 |(PRINT {MEMQ ? '(MEMORY VARIABLES SCRIPT DATABASE ALL)})|))
  (QUOTE (NORMAL-METHOD D0161 (PRINT)))
  (QUOTE (NORMAL-METHOD D0162 |(PRINT YOUR ?)|))
  (QUOTE (NORMAL-METHOD D0163 |(COMPARE YOURSELF WITH ?)|))
  (QUOTE (NORMAL-METHOD D0164 |(COMPILE MESSAGE %)|))
  (QUOTE (NORMAL-METHOD D0165 |(SAVE %)|))
  (QUOTE (NORMAL-METHOD D0166 |(HELP %)|))
  (QUOTE (NORMAL-METHOD D0167 |(WARNING %)|))
  (QUOTE (NORMAL-METHOD D0168 |(SHOULD NOT HAPPEN %)|))
  (QUOTE NIL))) 
(REPLACE-THIRD
 (SECOND (METHODS-OF (ACTOR-OF (QUOTE SOMETHING))))
 (SECOND-TO-LAST-CONS (METHODS-OF (ACTOR-OF (QUOTE SOMETHING))))) 
(REMPROP (QUOTE SOMETHING) (QUOTE ACTOR-LOAD)) 
(OR
 (GET-ACTOR (QUOTE CLOCK))
 (PLACE-ACTOR-ON-NAME (LIST (QUOTE DIRECTOR-SYMBOL-FOR-ACTOR) NIL) (QUOTE CLOCK))) 
(REPLACE-REST
 (ACTOR-OF (QUOTE CLOCK))
 (LIST
  NIL
  (CONS
   (QUOTE VALUE-METHOD)
   (CONS
    (QUOTE (((NAME CLOCK PRIVATE) (TICKS-PER-FRAME 1) (FRAMES-PER-SECOND 1))))
    (QUOTE ((INTERNAL-RECALL-YOUR-VARIABLE)))))
  (QUOTE (METHOD-SELECTOR D0169 TO-BE-FILLED-IN-WITH-SECOND-TO-LAST-CONS))
  (QUOTE (NORMAL-METHOD D0170 (TICK)))
  (QUOTE (NORMAL-METHOD D0171 |(RUN FOR ? ?)|))
  (QUOTE SOMETHING))) 
(REPLACE-THIRD
 (SECOND (METHODS-OF (ACTOR-OF (QUOTE CLOCK))))
 (SECOND-TO-LAST-CONS (METHODS-OF (ACTOR-OF (QUOTE CLOCK))))) 
(REMPROP (QUOTE CLOCK) (QUOTE ACTOR-LOAD)) 
(OR
 (GET-ACTOR (QUOTE DEFAULT-CLOCK))
 (PLACE-ACTOR-ON-NAME (LIST (QUOTE DIRECTOR-SYMBOL-FOR-ACTOR) NIL) (QUOTE DEFAULT-CLOCK))) 
(REPLACE-REST
 (ACTOR-OF (QUOTE DEFAULT-CLOCK))
 (LIST
  NIL
  (CONS
   (QUOTE VALUE-METHOD)
   (CONS
    (QUOTE (((NAME DEFAULT-CLOCK PRIVATE))))
    (QUOTE ((INTERNAL-RECALL-YOUR-VARIABLE)))))
  (QUOTE CLOCK))) 
(REMPROP (QUOTE DEFAULT-CLOCK) (QUOTE ACTOR-LOAD)) 
(COMMENT THE FOLLOWING ARE THE ACTORS NEEDED FOR THE FOLLOWING METHODS) 
(COMMENT NOW FOR METHOD HELPERS (IE FUNCTIONS WHICH DO TRANSMISSIONS)) 
(DEFINE-FORM
 (*ADD-HELP-TO-ACTOR ACTOR PATTERN COMMENT)
 (LET
  ((HELPER '(HELP-FOR ,ACTOR)))
  (COND ((NOT (EXISTS? HELPER))
         (LET
          ((MYSELF (ACTOR-OF (QUOTE SOMETHING))) (*MESSAGE '(MAKE ,HELPER)))
          (QUICK-COMPILED-ASK
           '#,(METHOD-AT-POSITION (|(MAKE ?)| 0) SOMETHING)
           '#,(ACTOR-OF (QUOTE SOMETHING))))))
  (LET
   ((MYSELF (ACTOR-OF HELPER))
    (*MESSAGE '(MEMORIZE (|When receiving| ,PATTERN I !,COMMENT))))
   (QUICK-COMPILED-ASK
    '#,(METHOD-AT-POSITION (|(MEMORIZE ?)| 0) SOMETHING)
    '#,(ACTOR-OF (QUOTE SOMETHING)))))) 
(DEFINE-FORM
 (FANCY-PRINT-VARIABLES FILE-OBJECT)
 (TERPRI FILE-OBJECT)
 (DO
  ((NAMES (COLLECT-ALL-VARIABLE-NAMES MYSELF) (REST NAMES)) (SYNONYMS NIL))
  ((NULL NAMES) NO-VALUE)
  (LET
   ((NAME (FIRST NAMES)))
   (COND ((AND (NOT (EQ-FIRST NAME 'SYNONYMS-OF)) (NOT (MEMBER NAME SYNONYMS)))
          (LET
           ((NAMES-SYNONYMS
             (SECOND (LOOK-UP-VARIABLE-IN-ACTOR '(SYNONYMS-OF ,NAME) MYSELF))))
           (SETQ SYNONYMS (APPEND NAMES-SYNONYMS SYNONYMS))
           (PRINT-NAME-VALUE
            NAME
            (LET
             ((*MESSAGE '(RECALL YOUR ,NAME)))
             (COMPILED-ASK
              '#,(LIST
                  (METHOD-AT-POSITION ((RECALL YOUR SIBLINGS) 0) SOMETHING)
                  (METHOD-AT-POSITION ((RECALL YOUR DESCENDANTS) 0) SOMETHING)
                  (METHOD-AT-POSITION ((RECALL YOUR CHILDLESS-DESCENDANTS) 0) SOMETHING)
                  (METHOD-AT-POSITION ((RECALL YOUR PARENT) 0) SOMETHING)
                  (METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING))
              '#,(ACTOR-OF (QUOTE SOMETHING))))
            NAMES-SYNONYMS
            FILE-OBJECT))))))) 
(DEFINE-FORM
 (FANCY-PRINT-MEMORY FILE-OBJECT)
 (LET
  ((ITEMS
    (LET
     ((*MESSAGE '(RECALL YOUR INTERNAL-NAME-OF-ITEMS-MEMORIZED)))
     (QUICK-COMPILED-ASK
      '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
      '#,(ACTOR-OF (QUOTE SOMETHING))))))
  (COND (ITEMS
         (TERPRI FILE-OBJECT)
         (PRINC '|And I was told that | FILE-OBJECT)
         (MAPC
          (FUNCTION
           (LAMBDA (ITEM) (TERPRI FILE-OBJECT) (PRINC-OR-PRINT ITEM FILE-OBJECT 'BLOCK)))
          ITEMS))))) 
(DEFINE-FORM
 (FANCY-PRINT-SCRIPT FILE-OBJECT)
 (TERPRI FILE-OBJECT)
 (PRINC '|My methods are | FILE-OBJECT)
 (DO
  ((I (REST (METHODS-OF MYSELF)) (REST I)) (NO-METHODS T))
  ((NULL (REST I)) (COND (NO-METHODS (PRINC '|none.| FILE-OBJECT))) NO-VALUE)
  (LET
   ((METHOD (FIRST I)))
   (COND ((OR (NORMAL-METHOD? METHOD) (VALUE-METHOD? METHOD) (MACRO-METHOD? METHOD))
          (SETQ NO-METHODS NIL)
          (TERPRI FILE-OBJECT)
          (LET
           ((HUMANIFIED-METHOD (HUMANIFY-METHOD METHOD)))
           (DICKS-PRINT (FIRST HUMANIFIED-METHOD) FILE-OBJECT 'GRIND)
           (MAPC
            (FUNCTION (LAMBDA (CODE-LINE) (DICKS-PRINT CODE-LINE FILE-OBJECT 'GRIND)))
            (REST HUMANIFIED-METHOD)))))))) 
(DEFINE-FORM
 (FANCY-PRINT OPTION (FILE-NAME))
 (LET
  (
   (FILE-OBJECT
    (COND (*DEFAULT-FILE-OBJECT)
          (FILE-NAME
           (COND ((PROBEF FILE-NAME) (OPEN FILE-NAME 'APPEND))
                 (T (OPEN FILE-NAME 'OUT)))))))
  (COND ((EQ OPTION 'ALL)
         (FANCY-PRINT-VARIABLES FILE-OBJECT)
         (FANCY-PRINT-MEMORY FILE-OBJECT)
         (TERPRI FILE-OBJECT)
         (FANCY-PRINT-SCRIPT FILE-OBJECT))
        ((EQ OPTION 'SCRIPT) (FANCY-PRINT-SCRIPT FILE-OBJECT))
        ((EQ OPTION 'MEMORY)
         (TERPRI FILE-OBJECT)
         (FANCY-PRINT-VARIABLES FILE-OBJECT)
         (FANCY-PRINT-MEMORY FILE-OBJECT))
        ((EQ OPTION 'DATABASE) (FANCY-PRINT-MEMORY FILE-OBJECT))
        ((EQ OPTION 'VARIABLES) (FANCY-PRINT-VARIABLES FILE-OBJECT))
        (T (SHOULDNT-HAPPEN 'FANCY-PRINT '(INVALID PRINT OPTION ,OPTION))))
  (OR *DEFAULT-FILE-OBJECT (AND FILE-OBJECT (CLOSE FILE-OBJECT)))
  NO-VALUE)) 
(DEFINE-FORM
 (TELL-OTHER-NEW-VALUE VARIABLE NEW-VALUE GROUPS-NAME)
 (LET
  ((*MESSAGE
    '(SEQUENTIALLY
      (ASK YOUR ,GROUPS-NAME NOTICE THAT ,VARIABLE OF ,MYSELF IS NOW ,NEW-VALUE))))
  (QUICK-COMPILED-ASK
   '#,(METHOD-AT-POSITION (|(SEQUENTIALLY (ASK YOUR ? %) %)| 0) SOMETHING)
   '#,(ACTOR-OF (QUOTE SOMETHING))))) 
(DEFINE-FORM
 (TELL-OTHERS-NEW-VALUE VARIABLE NEW-VALUE GROUPS-NAME)
 (LET
  ((*MESSAGE
    '(SEQUENTIALLY
      (ASK EACH OF YOUR ,GROUPS-NAME NOTICE THAT ,VARIABLE OF ,MYSELF IS NOW ,NEW-VALUE))))
  (QUICK-COMPILED-ASK
   '#,(METHOD-AT-POSITION (|(SEQUENTIALLY (ASK EACH OF YOUR ? %) %)| 0) SOMETHING)
   '#,(ACTOR-OF (QUOTE SOMETHING))))) 
(DEFINE-FORM
 (LENGTH-IN-SECONDS LENGTH UNITS)
 (COND ((MEMQ UNITS '(TICKS TICK))
        (LET
         ((CLOCK
           (LET
            ((*MESSAGE '(RECALL YOUR CLOCK)))
            (QUICK-COMPILED-ASK
             '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
             '#,(ACTOR-OF (QUOTE SOMETHING))))))
         (QUOTIENT
          (FLOAT LENGTH)
          (LET
           ((MYSELF (ACTOR-OF CLOCK)) (*MESSAGE '(RECALL YOUR TICKS-PER-FRAME)))
           (QUICK-COMPILED-ASK
            '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
            '#,(ACTOR-OF (QUOTE SOMETHING))))
          (LET
           ((MYSELF (ACTOR-OF CLOCK)) (*MESSAGE '(RECALL YOUR FRAMES-PER-SECOND)))
           (QUICK-COMPILED-ASK
            '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
            '#,(ACTOR-OF (QUOTE SOMETHING)))))))
       ((MEMQ UNITS '(SECONDS SECOND)) LENGTH)
       ((MEMQ UNITS '(FRAMES FRAME))
        (QUOTIENT
         (FLOAT LENGTH)
         (LET
          ((*MESSAGE '(SEQUENTIALLY (ASK YOUR CLOCK RECALL YOUR FRAMES-PER-SECOND))))
          (QUICK-COMPILED-ASK
           '#,(METHOD-AT-POSITION (|(SEQUENTIALLY (ASK YOUR ? %) %)| 0) SOMETHING)
           '#,(ACTOR-OF (QUOTE SOMETHING))))))
       (T
        (SHOULDNT-HAPPEN
         'LENGTH-IN-FRAMES
         '(,UNITS |is an invalid unit (ticks, seconds, or frames are ok)|)
         '|type "p " and the message will be ignored|)
        0))) 
(DEFINE-FORM
 (LENGTH-IN-FRAMES LENGTH UNITS)
 (COND ((MEMQ UNITS '(TICKS TICK))
        (ROUND
         (QUOTIENT
          (FLOAT LENGTH)
          (LET
           ((*MESSAGE '(SEQUENTIALLY (ASK YOUR CLOCK RECALL YOUR TICKS-PER-FRAME))))
           (QUICK-COMPILED-ASK
            '#,(METHOD-AT-POSITION (|(SEQUENTIALLY (ASK YOUR ? %) %)| 0) SOMETHING)
            '#,(ACTOR-OF (QUOTE SOMETHING)))))))
       ((MEMQ UNITS '(SECONDS SECOND))
        (LET
         ((CLOCK
           (LET
            ((*MESSAGE '(RECALL YOUR CLOCK)))
            (QUICK-COMPILED-ASK
             '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
             '#,(ACTOR-OF (QUOTE SOMETHING))))))
         (ROUND
          (TIMES
           (LET
            ((MYSELF (ACTOR-OF CLOCK)) (*MESSAGE '(RECALL YOUR FRAMES-PER-SECOND)))
            (QUICK-COMPILED-ASK
             '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
             '#,(ACTOR-OF (QUOTE SOMETHING))))
           (QUOTIENT
            (FLOAT LENGTH)
            (LET
             ((MYSELF (ACTOR-OF CLOCK)) (*MESSAGE '(RECALL YOUR TICKS-PER-FRAME)))
             (QUICK-COMPILED-ASK
              '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
              '#,(ACTOR-OF (QUOTE SOMETHING)))))))))
       ((MEMQ UNITS '(FRAMES FRAME)) LENGTH)
       (T
        (SHOULDNT-HAPPEN
         'LENGTH-IN-FRAMES
         '(,UNITS |is an invalid unit (ticks, seconds, or frames are ok)|)
         '|type "p " and the message will be ignored|)
        0))) 
(DEFINE-FORM
 (RATE-IN-TICKS RATE-PER-SECOND)
 (LET*
  ((CLOCK
    (LET
     ((*MESSAGE '(RECALL YOUR CLOCK)))
     (QUICK-COMPILED-ASK
      '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
      '#,(ACTOR-OF (QUOTE SOMETHING)))))
   (TICKS-PER-SECOND
    (FLOAT
     (TIMES
      (FLOAT
       (LET
        ((MYSELF (ACTOR-OF CLOCK)) (*MESSAGE '(RECALL YOUR FRAMES-PER-SECOND)))
        (QUICK-COMPILED-ASK
         '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
         '#,(ACTOR-OF (QUOTE SOMETHING)))))
      (FLOAT
       (LET
        ((MYSELF (ACTOR-OF CLOCK)) (*MESSAGE '(RECALL YOUR TICKS-PER-FRAME)))
        (QUICK-COMPILED-ASK
         '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
         '#,(ACTOR-OF (QUOTE SOMETHING)))))))))
  (EXP (//$ (LOG (FLOAT RATE-PER-SECOND)) TICKS-PER-SECOND)))) 
(DEFINE-FORM
 (SPEED-IN-TICKS SPEED-PER-SECOND)
 (LET
  ((CLOCK
    (LET
     ((*MESSAGE '(RECALL YOUR CLOCK)))
     (QUICK-COMPILED-ASK
      '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
      '#,(ACTOR-OF (QUOTE SOMETHING))))))
  (//$
   (FLOAT SPEED-PER-SECOND)
   (FLOAT
    (LET
     ((MYSELF (ACTOR-OF CLOCK)) (*MESSAGE '(RECALL YOUR FRAMES-PER-SECOND)))
     (QUICK-COMPILED-ASK
      '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
      '#,(ACTOR-OF (QUOTE SOMETHING)))))
   (FLOAT
    (LET
     ((MYSELF (ACTOR-OF CLOCK)) (*MESSAGE '(RECALL YOUR TICKS-PER-FRAME)))
     (QUICK-COMPILED-ASK
      '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
      '#,(ACTOR-OF (QUOTE SOMETHING)))))))) 
(DEFINE-FORM
 (NUMBER-OF-TICKS NUMBER UNITS)
 (COND ((MEMQ UNITS '(TICKS TICK)) NUMBER)
       ((MEMQ UNITS '(FRAMES FRAME))
        (ROUND
         (TIMES
          (FLOAT NUMBER)
          (LET
           ((*MESSAGE '(SEQUENTIALLY (ASK YOUR CLOCK RECALL YOUR TICKS-PER-FRAME))))
           (QUICK-COMPILED-ASK
            '#,(METHOD-AT-POSITION (|(SEQUENTIALLY (ASK YOUR ? %) %)| 0) SOMETHING)
            '#,(ACTOR-OF (QUOTE SOMETHING)))))))
       ((MEMQ UNITS '(SECONDS SECOND))
        (LET
         ((CLOCK
           (LET
            ((*MESSAGE '(RECALL YOUR CLOCK)))
            (QUICK-COMPILED-ASK
             '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
             '#,(ACTOR-OF (QUOTE SOMETHING))))))
         (ROUND
          (TIMES
           (FLOAT NUMBER)
           (LET
            ((MYSELF (ACTOR-OF CLOCK)) (*MESSAGE '(RECALL YOUR FRAMES-PER-SECOND)))
            (QUICK-COMPILED-ASK
             '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
             '#,(ACTOR-OF (QUOTE SOMETHING))))
           (LET
            ((MYSELF (ACTOR-OF CLOCK)) (*MESSAGE '(RECALL YOUR TICKS-PER-FRAME)))
            (QUICK-COMPILED-ASK
             '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
             '#,(ACTOR-OF (QUOTE SOMETHING))))))))
       (T
        (SHOULDNT-HAPPEN
         'NUMBER-OF-TICKS
         '(,UNITS |is an invalid unit of time|)
         '(|type "p " and the message will be ignored|))
        0))) 
(DEFINE-FORM
 (DO-GRADUALLY-AT-RATE RATE PLANNER DOER ACTION AMOUNT FOLLOWUP)
 (LET
  ((RATE (RATE-IN-TICKS RATE)))
  (COND ((NOT
          (LESSP
           RATE
           (COND ((< AMOUNT 1.0) (//$ AMOUNT))
                 (T AMOUNT))))
         (LET ((*MESSAGE '(!,ACTION ,AMOUNT))) (CASES (ACTOR-OF DOER)))
         (LET
          ((MYSELF (ACTOR-OF PLANNER)) (*MESSAGE '(SEQUENTIALLY !,FOLLOWUP)))
          (COMPILED-ASK
           '#,(LIST
               (METHOD-AT-POSITION (|(SEQUENTIALLY (PLAN NEXT %) %)| 0) SOMETHING)
               (METHOD-AT-POSITION (|(SEQUENTIALLY (PLAN AFTER ? ? %) %)| 0) SOMETHING)
               (METHOD-AT-POSITION (|(SEQUENTIALLY (CONCURRENTLY %) %)| 0) SOMETHING)
               (METHOD-AT-POSITION (|(SEQUENTIALLY (REPEAT ? FOREVER) %)| 0) SOMETHING)
               (METHOD-AT-POSITION (|(SEQUENTIALLY (REPEAT ? ? TIMES) %)| 0) SOMETHING)
               (METHOD-AT-POSITION
                (|(SEQUENTIALLY (DO AT SPEED ? ASK ? {or SET CHANGE} YOUR ? TO ?) %)| 0)
                SOMETHING)
               (METHOD-AT-POSITION
                (|(SEQUENTIALLY (DO AT SPEED ? {or SET CHANGE} YOUR ? TO ?) %)| 0)
                SOMETHING)
               (METHOD-AT-POSITION (|(SEQUENTIALLY (DO IN ? ? % ?) %)| 0) SOMETHING)
               (METHOD-AT-POSITION (|(SEQUENTIALLY (DO AT SPEED ? % ?) %)| 0) SOMETHING)
               (METHOD-AT-POSITION
                (|(SEQUENTIALLY (GRADUALLY ASK ? {or SET CHANGE} YOUR ? TO ?) %)| 0)
                SOMETHING)
               (METHOD-AT-POSITION
                (|(SEQUENTIALLY (GRADUALLY {or SET CHANGE} YOUR ? TO ?) %)| 0)
                SOMETHING)
               (METHOD-AT-POSITION
                (|(SEQUENTIALLY (GRADUALLY ASK ? % ?) %)| 0)
                SOMETHING)
               (METHOD-AT-POSITION (|(SEQUENTIALLY (GRADUALLY % ?) %)| 0) SOMETHING)
               (METHOD-AT-POSITION
                (|(SEQUENTIALLY (BROADCAST OR ASK YOUR ? %) %)| 0)
                SOMETHING)
               (METHOD-AT-POSITION
                (|(SEQUENTIALLY (BROADCAST TO YOUR ? %) %)| 0)
                SOMETHING)
               (METHOD-AT-POSITION (|(SEQUENTIALLY (ASK YOUR ? %) %)| 0) SOMETHING)
               (METHOD-AT-POSITION
                (|(SEQUENTIALLY (ASK EACH OF YOUR ? %) %)| 0)
                SOMETHING)
               (METHOD-AT-POSITION (|(SEQUENTIALLY (ASK EACH OF ? %) %)| 0) SOMETHING)
               (METHOD-AT-POSITION (|(SEQUENTIALLY (ASK ? %) %)| 0) SOMETHING)
               (METHOD-AT-POSITION (|(SEQUENTIALLY %)| 0) SOMETHING))
           '#,(ACTOR-OF (QUOTE SOMETHING)))))
        ((< AMOUNT 1.0)
         (LET ((*MESSAGE '(!,ACTION ,(//$ RATE)))) (CASES (ACTOR-OF DOER)))
         (LET
          ((MYSELF (ACTOR-OF PLANNER))
           (*MESSAGE
            '(SEQUENTIALLY
              (PLAN
               AFTER
               1
               TICKS
               SEQUENTIALLY
               (SEQUENTIALLY (GRADUALLY ASK ,DOER !,ACTION ,(*$ RATE AMOUNT)) !,FOLLOWUP))))
           )
          (QUICK-COMPILED-ASK
           '#,(METHOD-AT-POSITION (|(SEQUENTIALLY (PLAN AFTER ? ? %) %)| 0) SOMETHING)
           '#,(ACTOR-OF (QUOTE SOMETHING)))))
        (T
         (LET ((*MESSAGE '(!,ACTION ,RATE))) (CASES (ACTOR-OF DOER)))
         (LET
          ((MYSELF (ACTOR-OF PLANNER))
           (*MESSAGE
            '(SEQUENTIALLY
              (PLAN
               AFTER
               1
               TICKS
               SEQUENTIALLY
               (SEQUENTIALLY
                (GRADUALLY ASK ,DOER !,ACTION ,(//$ AMOUNT RATE))
                !,FOLLOWUP)))))
          (QUICK-COMPILED-ASK
           '#,(METHOD-AT-POSITION (|(SEQUENTIALLY (PLAN AFTER ? ? %) %)| 0) SOMETHING)
           '#,(ACTOR-OF (QUOTE SOMETHING)))))))
 '|begun|) 
(DEFINE-FORM
 (DO-GRADUALLY-AT-SPEED SPEED PLANNER DOER ACTION AMOUNT FOLLOWUP)
 (LET
  ((SPEED (SPEED-IN-TICKS SPEED)))
  (COND ((NOT (LESSP SPEED (ABS AMOUNT)))
         (LET ((*MESSAGE '(!,ACTION ,AMOUNT))) (CASES (ACTOR-OF DOER)))
         (LET
          ((MYSELF (ACTOR-OF PLANNER)) (*MESSAGE '(SEQUENTIALLY !,FOLLOWUP)))
          (COMPILED-ASK
           '#,(LIST
               (METHOD-AT-POSITION (|(SEQUENTIALLY (PLAN NEXT %) %)| 0) SOMETHING)
               (METHOD-AT-POSITION (|(SEQUENTIALLY (PLAN AFTER ? ? %) %)| 0) SOMETHING)
               (METHOD-AT-POSITION (|(SEQUENTIALLY (CONCURRENTLY %) %)| 0) SOMETHING)
               (METHOD-AT-POSITION (|(SEQUENTIALLY (REPEAT ? FOREVER) %)| 0) SOMETHING)
               (METHOD-AT-POSITION (|(SEQUENTIALLY (REPEAT ? ? TIMES) %)| 0) SOMETHING)
               (METHOD-AT-POSITION
                (|(SEQUENTIALLY (DO AT SPEED ? ASK ? {or SET CHANGE} YOUR ? TO ?) %)| 0)
                SOMETHING)
               (METHOD-AT-POSITION
                (|(SEQUENTIALLY (DO AT SPEED ? {or SET CHANGE} YOUR ? TO ?) %)| 0)
                SOMETHING)
               (METHOD-AT-POSITION (|(SEQUENTIALLY (DO IN ? ? % ?) %)| 0) SOMETHING)
               (METHOD-AT-POSITION (|(SEQUENTIALLY (DO AT SPEED ? % ?) %)| 0) SOMETHING)
               (METHOD-AT-POSITION
                (|(SEQUENTIALLY (GRADUALLY ASK ? {or SET CHANGE} YOUR ? TO ?) %)| 0)
                SOMETHING)
               (METHOD-AT-POSITION
                (|(SEQUENTIALLY (GRADUALLY {or SET CHANGE} YOUR ? TO ?) %)| 0)
                SOMETHING)
               (METHOD-AT-POSITION
                (|(SEQUENTIALLY (GRADUALLY ASK ? % ?) %)| 0)
                SOMETHING)
               (METHOD-AT-POSITION (|(SEQUENTIALLY (GRADUALLY % ?) %)| 0) SOMETHING)
               (METHOD-AT-POSITION
                (|(SEQUENTIALLY (BROADCAST OR ASK YOUR ? %) %)| 0)
                SOMETHING)
               (METHOD-AT-POSITION
                (|(SEQUENTIALLY (BROADCAST TO YOUR ? %) %)| 0)
                SOMETHING)
               (METHOD-AT-POSITION (|(SEQUENTIALLY (ASK YOUR ? %) %)| 0) SOMETHING)
               (METHOD-AT-POSITION
                (|(SEQUENTIALLY (ASK EACH OF YOUR ? %) %)| 0)
                SOMETHING)
               (METHOD-AT-POSITION (|(SEQUENTIALLY (ASK EACH OF ? %) %)| 0) SOMETHING)
               (METHOD-AT-POSITION (|(SEQUENTIALLY (ASK ? %) %)| 0) SOMETHING)
               (METHOD-AT-POSITION (|(SEQUENTIALLY %)| 0) SOMETHING))
           '#,(ACTOR-OF (QUOTE SOMETHING)))))
        ((MINUSP AMOUNT)
         (LET ((*MESSAGE '(!,ACTION ,(MINUS SPEED)))) (CASES (ACTOR-OF DOER)))
         (LET
          ((MYSELF (ACTOR-OF PLANNER))
           (*MESSAGE
            '(SEQUENTIALLY
              (PLAN
               AFTER
               1
               TICKS
               SEQUENTIALLY
               (SEQUENTIALLY
                (GRADUALLY ASK ,DOER !,ACTION ,(PLUS AMOUNT SPEED))
                !,FOLLOWUP)))))
          (QUICK-COMPILED-ASK
           '#,(METHOD-AT-POSITION (|(SEQUENTIALLY (PLAN AFTER ? ? %) %)| 0) SOMETHING)
           '#,(ACTOR-OF (QUOTE SOMETHING)))))
        (T
         (LET ((*MESSAGE '(!,ACTION ,SPEED))) (CASES (ACTOR-OF DOER)))
         (LET
          ((MYSELF (ACTOR-OF PLANNER))
           (*MESSAGE
            '(SEQUENTIALLY
              (PLAN
               AFTER
               1
               TICKS
               SEQUENTIALLY
               (SEQUENTIALLY
                (GRADUALLY ASK ,DOER !,ACTION ,(DIFFERENCE AMOUNT SPEED))
                !,FOLLOWUP)))))
          (QUICK-COMPILED-ASK
           '#,(METHOD-AT-POSITION (|(SEQUENTIALLY (PLAN AFTER ? ? %) %)| 0) SOMETHING)
           '#,(ACTOR-OF (QUOTE SOMETHING)))))))
 '|begun|) 
(DEFINE-FORM
 (DO-GRADUALLY-NUMBER PLANNER DOER ACTION AMOUNT FOLLOWUP)
 (LET
  ((SPEED
    (LET
     ((MYSELF (ACTOR-OF DOER)) (*MESSAGE '(RECALL YOUR (!,ACTION SPEED))))
     (QUICK-COMPILED-ASK
      '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
      '#,(ACTOR-OF (QUOTE SOMETHING))))))
  (COND ((NULL SPEED)
         (LET
          ((MYSELF (ACTOR-OF DOER))
           (*MESSAGE '(CONSIDER (DEFAULT-SPEED (!,ACTION SPEED)) SYNONYMS)))
          (QUICK-COMPILED-ASK
           '#,(METHOD-AT-POSITION (|(CONSIDER ? SYNONYMS)| 0) SOMETHING)
           '#,(ACTOR-OF (QUOTE SOMETHING))))
         (WARNING
          'DO-GRADUALLY
          '(,DOER                                 |has no|
            (!,ACTION SPEED)                      |so, default-speed|
            ,(SETQ SPEED (ASK ,DOER RECALL YOUR (!,ACTION SPEED)))
            |units//second assumed.|))))
  (COND ((EQ-FIRST SPEED 'ADD) (SETQ SPEED (SECOND SPEED))))
  (COND ((NUMBERP SPEED)
         (DO-GRADUALLY-AT-SPEED SPEED PLANNER DOER ACTION AMOUNT FOLLOWUP))
        ((EQ-FIRST SPEED 'MULTIPLY-BY)
         (DO-GRADUALLY-AT-RATE (SECOND SPEED) PLANNER DOER ACTION AMOUNT FOLLOWUP))
        (T
         (SHOULDNT-HAPPEN
          'DO-GRADUALLY
          '(,DOER |has a| (!,ACTION SPEED) OF ,SPEED |which is not recognized|)))))) 
(DEFINE-FORM
 (DO-GRADUALLY-LIST PLANNER DOER ACTION AMOUNT FOLLOWUP)
 (LET
  ((COMPONENTS
    (LET
     ((MYSELF (ACTOR-OF DOER)) (*MESSAGE '(RECALL YOUR (COMPONENTS OF !,ACTION))))
     (QUICK-COMPILED-ASK
      '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
      '#,(ACTOR-OF (QUOTE SOMETHING))))))
  (COND ((NULL COMPONENTS)
         (SHOULDNT-HAPPEN
          'DO-GRADUALLY-LIST
          '(|;Attempting to gradually|            (!,ACTION ,AMOUNT)
            |/
but|                               ,AMOUNT
            |is a list and|                       ,DOER
            |doesn't know the|                    (COMPONENTS OF !,ACTION))))
        (T
         (DO
          ((C COMPONENTS (REST C))                (VALUES AMOUNT (REST VALUES))
           (COMPONENT-ACTIONS NIL))
          ((OR (NULL C) (NULL VALUES))
           (COND ((AND (NULL C) (NULL VALUES))
                  (LET
                   ((MYSELF (ACTOR-OF PLANNER))
                    (*MESSAGE
                     '(CONCURRENTLY
                       (SET YOUR ACTIVITY-1 TO (!,COMPONENT-ACTIONS))
                       (DO
                        ONCE
                        WHEN
                        RECEIVING
                        (SET YOUR ACTIVITY-1 TO NIL)
                        (ASK MYSELF FORGET YOUR ACTIVITY-1)
                        (ASK MYSELF SEQUENTIALLY !,FOLLOWUP))
                       (SEQUENTIALLY
                        !,COMPONENT-ACTIONS
                        (ASK
                         ,PLANNER
                         REMOVE
                         !,COMPONENT-ACTIONS
                         FROM
                         YOUR
                         LIST
                         OF
                         ACTIVITY-1)))))
                   (QUICK-COMPILED-ASK
                    '#,(METHOD-AT-POSITION (|(CONCURRENTLY %)| 0) SOMETHING)
                    '#,(ACTOR-OF (QUOTE SOMETHING)))))
                 (T
                  (SHOULDNT-HAPPEN
                   'DO-GRADUALLY
                   '(|;Attempting to gradually|
                     (!,ACTION ,AMOUNT)
                     |but|
                     ,AMOUNT
                     |does not have the same number of elements as|
                     (COMPONENTS OF !,ACTION)
                     |which is|
                     COMPONENTS)))))
          (PUSH '(GRADUALLY ,(FIRST C) ,(FIRST VALUES)) COMPONENT-ACTIONS)))))) 
(DEFINE-FORM
 (DO-GRADUALLY PLANNER DOER ACTION AMOUNT FOLLOWUP)
 (COND ((NUMBERP AMOUNT) (DO-GRADUALLY-NUMBER PLANNER DOER ACTION AMOUNT FOLLOWUP))
       ((LISTP AMOUNT) (DO-GRADUALLY-LIST PLANNER DOER ACTION AMOUNT FOLLOWUP))
       (T
        (SHOULDNT-HAPPEN
         'DO-GRADUALLY
         '(|;Attempting to gradually|             (!,ACTION ,AMOUNT)
           |/
but|                                ,AMOUNT
           |is neither a number nor a list|))))) 
(DEFINE-FORM
 (SET-GRADUALLY-NUMBER PLANNER DOER VARIABLE VALUE SPEED FOLLOWUP THE-MESSAGE)
 (LET
  ((SPEED
    (OR
     SPEED
     (LET
      ((MYSELF (ACTOR-OF DOER)) (*MESSAGE '(RECALL YOUR (,VARIABLE SPEED))))
      (QUICK-COMPILED-ASK
       '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
       '#,(ACTOR-OF (QUOTE SOMETHING))))))
   (DISTANCE
    (DIFFERENCE
     VALUE
     (OR
      (LET
       ((MYSELF (ACTOR-OF DOER)) (*MESSAGE '(RECALL YOUR ,VARIABLE)))
       (COMPILED-ASK
        '#,(LIST
            (METHOD-AT-POSITION ((RECALL YOUR SIBLINGS) 0) SOMETHING)
            (METHOD-AT-POSITION ((RECALL YOUR DESCENDANTS) 0) SOMETHING)
            (METHOD-AT-POSITION ((RECALL YOUR CHILDLESS-DESCENDANTS) 0) SOMETHING)
            (METHOD-AT-POSITION ((RECALL YOUR PARENT) 0) SOMETHING)
            (METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING))
        '#,(ACTOR-OF (QUOTE SOMETHING))))
      0.0))))
  (COND ((NULL SPEED)
         (LET
          ((MYSELF (ACTOR-OF DOER))
           (*MESSAGE '(CONSIDER (DEFAULT-SPEED (,VARIABLE SPEED)) SYNONYMS)))
          (QUICK-COMPILED-ASK
           '#,(METHOD-AT-POSITION (|(CONSIDER ? SYNONYMS)| 0) SOMETHING)
           '#,(ACTOR-OF (QUOTE SOMETHING))))
         (WARNING
          'SET-GRADUALLY
          '(,DOER                                 |has no|
            (,VARIABLE SPEED)                     |so, default-speed|
            ,(SETQ SPEED (ASK ,DOER RECALL YOUR (,VARIABLE SPEED)))
            |units//second assumed.|))))
  (COND ((MINUSP DISTANCE) (SETQ SPEED (MINUS SPEED))))
  (COND ((GREATERP (ABS DISTANCE) (ABS SPEED))
         (LET
          ((MYSELF (ACTOR-OF DOER))
           (*MESSAGE
            '(SET
              YOUR
              ,VARIABLE
              TO
              ,(PLUS (OR (ASK ,DOER RECALL YOUR ,VARIABLE) 0) (QUOTE-IF-NEED-BE ,SPEED)))))
          (COMPILED-ASK
           '#,(LIST
               (METHOD-AT-POSITION (|(SET YOUR PARENT TO ?)| 0) SOMETHING)
               (METHOD-AT-POSITION (|(SET YOUR WHOLE TO ?)| 0) SOMETHING)
               (METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING))
           '#,(ACTOR-OF (QUOTE SOMETHING))))
         (LET
          ((MYSELF (ACTOR-OF PLANNER))
           (*MESSAGE '(SEQUENTIALLY (PLAN AFTER 1 TICKS SEQUENTIALLY (!,THE-MESSAGE)))))
          (QUICK-COMPILED-ASK
           '#,(METHOD-AT-POSITION (|(SEQUENTIALLY (PLAN AFTER ? ? %) %)| 0) SOMETHING)
           '#,(ACTOR-OF (QUOTE SOMETHING)))))
        (T
         (LET
          ((MYSELF (ACTOR-OF DOER)) (*MESSAGE '(SET YOUR ,VARIABLE TO ,VALUE)))
          (COMPILED-ASK
           '#,(LIST
               (METHOD-AT-POSITION (|(SET YOUR PARENT TO ?)| 0) SOMETHING)
               (METHOD-AT-POSITION (|(SET YOUR WHOLE TO ?)| 0) SOMETHING)
               (METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING))
           '#,(ACTOR-OF (QUOTE SOMETHING))))
         (LET
          ((MYSELF (ACTOR-OF PLANNER)) (*MESSAGE '(SEQUENTIALLY !,FOLLOWUP)))
          (COMPILED-ASK
           '#,(LIST
               (METHOD-AT-POSITION (|(SEQUENTIALLY (PLAN NEXT %) %)| 0) SOMETHING)
               (METHOD-AT-POSITION (|(SEQUENTIALLY (PLAN AFTER ? ? %) %)| 0) SOMETHING)
               (METHOD-AT-POSITION (|(SEQUENTIALLY (CONCURRENTLY %) %)| 0) SOMETHING)
               (METHOD-AT-POSITION (|(SEQUENTIALLY (REPEAT ? FOREVER) %)| 0) SOMETHING)
               (METHOD-AT-POSITION (|(SEQUENTIALLY (REPEAT ? ? TIMES) %)| 0) SOMETHING)
               (METHOD-AT-POSITION
                (|(SEQUENTIALLY (DO AT SPEED ? ASK ? {or SET CHANGE} YOUR ? TO ?) %)| 0)
                SOMETHING)
               (METHOD-AT-POSITION
                (|(SEQUENTIALLY (DO AT SPEED ? {or SET CHANGE} YOUR ? TO ?) %)| 0)
                SOMETHING)
               (METHOD-AT-POSITION (|(SEQUENTIALLY (DO IN ? ? % ?) %)| 0) SOMETHING)
               (METHOD-AT-POSITION (|(SEQUENTIALLY (DO AT SPEED ? % ?) %)| 0) SOMETHING)
               (METHOD-AT-POSITION
                (|(SEQUENTIALLY (GRADUALLY ASK ? {or SET CHANGE} YOUR ? TO ?) %)| 0)
                SOMETHING)
               (METHOD-AT-POSITION
                (|(SEQUENTIALLY (GRADUALLY {or SET CHANGE} YOUR ? TO ?) %)| 0)
                SOMETHING)
               (METHOD-AT-POSITION
                (|(SEQUENTIALLY (GRADUALLY ASK ? % ?) %)| 0)
                SOMETHING)
               (METHOD-AT-POSITION (|(SEQUENTIALLY (GRADUALLY % ?) %)| 0) SOMETHING)
               (METHOD-AT-POSITION
                (|(SEQUENTIALLY (BROADCAST OR ASK YOUR ? %) %)| 0)
                SOMETHING)
               (METHOD-AT-POSITION
                (|(SEQUENTIALLY (BROADCAST TO YOUR ? %) %)| 0)
                SOMETHING)
               (METHOD-AT-POSITION (|(SEQUENTIALLY (ASK YOUR ? %) %)| 0) SOMETHING)
               (METHOD-AT-POSITION
                (|(SEQUENTIALLY (ASK EACH OF YOUR ? %) %)| 0)
                SOMETHING)
               (METHOD-AT-POSITION (|(SEQUENTIALLY (ASK EACH OF ? %) %)| 0) SOMETHING)
               (METHOD-AT-POSITION (|(SEQUENTIALLY (ASK ? %) %)| 0) SOMETHING)
               (METHOD-AT-POSITION (|(SEQUENTIALLY %)| 0) SOMETHING))
           '#,(ACTOR-OF (QUOTE SOMETHING)))))))) 
(DEFINE-FORM
 (SET-GRADUALLY-LIST PLANNER DOER VARIABLE VALUE FOLLOWUP)
 (LET
  ((ELEMENT-NAMES
    (LET
     ((MYSELF (ACTOR-OF DOER)) (*MESSAGE '(RECALL YOUR (COMPONENTS OF ,VARIABLE))))
     (QUICK-COMPILED-ASK
      '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
      '#,(ACTOR-OF (QUOTE SOMETHING))))))
  (COND (ELEMENT-NAMES
         (LET
          ((MYSELF (ACTOR-OF PLANNER))
           (*MESSAGE
            '(CONCURRENTLY
              (SET
               YOUR
               ACTIVITY-2
               TO
               (!,(DO
                   ((NAMES ELEMENT-NAMES (REST NAMES))
                    (VALUES VALUE (REST VALUES))
                    (MESSAGES NIL))
                   ((OR (NULL NAMES) (NULL VALUES))
                    (COND ((AND (NULL VALUES) (NULL NAMES)) MESSAGES)
                          (T
                           (SHOULDNT-HAPPEN
                            'SET-GRADUALLY
                            '(|attempting to gradually set|
                              ,VARIABLE
                              |to|
                              ,VALUE
                              |while its elements are|
                              ,ELEMENT-NAMES)))))
                   (PUSH
                    '(GRADUALLY ASK ,DOER SET YOUR ,(FIRST NAMES) TO ,(FIRST VALUES))
                    MESSAGES))))
              (DO
               ONCE
               WHEN
               RECEIVING
               (SET YOUR ACTIVITY-2 TO NIL)
               (ASK MYSELF FORGET YOUR ACTIVITY-2)
               (ASK MYSELF SEQUENTIALLY !,FOLLOWUP))
              (SEQUENTIALLY
               !,(DO
                  ((NAMES ELEMENT-NAMES (REST NAMES))
                   (VALUES VALUE (REST VALUES))
                   (MESSAGES NIL))
                  ((OR (NULL NAMES) (NULL VALUES))
                   (COND ((AND (NULL VALUES) (NULL NAMES)) MESSAGES)
                         (T
                          (SHOULDNT-HAPPEN
                           'SET-GRADUALLY
                           '(|attempting to gradually set|
                             ,VARIABLE
                             |to|
                             ,VALUE
                             |while its elements are|
                             ,ELEMENT-NAMES)))))
                  (PUSH
                   '(GRADUALLY ASK ,DOER SET YOUR ,(FIRST NAMES) TO ,(FIRST VALUES))
                   MESSAGES))
               (ASK
                ,PLANNER
                REMOVE
                !,(DO
                   ((NAMES ELEMENT-NAMES (REST NAMES))
                    (VALUES VALUE (REST VALUES))
                    (MESSAGES NIL))
                   ((OR (NULL NAMES) (NULL VALUES))
                    (COND ((AND (NULL VALUES) (NULL NAMES)) MESSAGES)
                          (T
                           (SHOULDNT-HAPPEN
                            'SET-GRADUALLY
                            '(|attempting to gradually set|
                              ,VARIABLE
                              |to|
                              ,VALUE
                              |while its elements are|
                              ,ELEMENT-NAMES)))))
                   (PUSH
                    '(GRADUALLY ASK ,DOER SET YOUR ,(FIRST NAMES) TO ,(FIRST VALUES))
                    MESSAGES))
                FROM
                YOUR
                LIST
                OF
                ACTIVITY-2)))))
          (QUICK-COMPILED-ASK
           '#,(METHOD-AT-POSITION (|(CONCURRENTLY %)| 0) SOMETHING)
           '#,(ACTOR-OF (QUOTE SOMETHING)))))
        (T
         (SHOULDNT-HAPPEN
          'SET-GRADUALLY
          '(|attempting to gradually set|         ,VARIABLE
            TO                                    ,VALUE
            |but there is no value of|            (ELEMENT-NAMES-OF ,VARIABLE))))))) 
(DEFINE-FORM
 (SET-GRADUALLY PLANNER DOER VARIABLE VALUE SPEED FOLLOWUP THE-MESSAGE)
 (COND ((LISTP VALUE) (SET-GRADUALLY-LIST PLANNER DOER VARIABLE VALUE FOLLOWUP))
       ((NUMBERP VALUE)
        (SET-GRADUALLY-NUMBER PLANNER DOER VARIABLE VALUE SPEED FOLLOWUP THE-MESSAGE))
       (T
        (SHOULDNT-HAPPEN
         'SET-GRADUALLY
         '(|attempting to gradually set|
           ,VARIABLE
           TO
           ,VALUE
           |which is neither a number or a list|))))) 
(DEFINE-FORM
 (DO-AT-SPEED SPEED-IN-TICKS ACTION AMOUNT FOLLOWUP)
 (LET
  ((*MESSAGE
    '(SEQUENTIALLY
      (REPEAT
       (!,ACTION ,SPEED-IN-TICKS)
       ,(QUOTIENT (FLOAT AMOUNT) SPEED-IN-TICKS)
       TIMES)
      !,FOLLOWUP)))
  (QUICK-COMPILED-ASK
   '#,(METHOD-AT-POSITION (|(SEQUENTIALLY (REPEAT ? ? TIMES) %)| 0) SOMETHING)
   '#,(ACTOR-OF (QUOTE SOMETHING))))) 
(DEFINE-FORM
 (BODY-OF-DO-THE-FOLLOWING MESSAGES)
 (DO
  ((M MESSAGES (REST M)) (LAST-VALUE))
  ((NULL M) LAST-VALUE)
  (LET ((*MESSAGE (FIRST M))) (SETQ LAST-VALUE (CASES MYSELF))))) 
(DEFINE-FORM
 (KEEP-SENDING-ITEMS-COLLECTING-ALL PATTERN DATABASE-METHOD ACTOR)
 (DO
  ((ACTOR ACTOR (PARENT-OF ACTOR))
   (METHOD-PREDICATE (METHOD-PATTERN-PREDICATE DATABASE-METHOD))
   (RESULTS NIL))
  ((NULL ACTOR) (OR (NREVERSE RESULTS) NO-VALUE))
  (LET
   ((ITEMS
     (LET
      ((MYSELF (ACTOR-OF ACTOR))
       (*MESSAGE '(RECALL ALL POSSIBLE ITEMS MATCHING ,PATTERN)))
      (QUICK-COMPILED-ASK
       '#,(METHOD-AT-POSITION (|(RECALL ALL POSSIBLE ITEMS MATCHING ?)| 0) SOMETHING)
       '#,(ACTOR-OF (QUOTE SOMETHING))))))
   (COND ((SYMBOLP METHOD-PREDICATE)
          (DO
           ((I ITEMS (REST I)))
           ((NULL I))
           (COND ((FUNCALL METHOD-PREDICATE (FIRST I))
                  (LET
                   ((*MESSAGE (FIRST I)))
                   (PUSH (RUN-METHOD DATABASE-METHOD) RESULTS))))))
         (T
          (DO
           ((I ITEMS (REST I)))
           ((NULL I))
           (COND ((EQUAL PATTERN (FIRST I))
                  (LET
                   ((*MESSAGE (FIRST I)))
                   (LET
                    ((RESULT (RUN-METHOD DATABASE-METHOD)))
                    (COND ((NOT (EQ RESULT NO-VALUE)) (PUSH RESULT RESULTS))))))))))))) 
(DEFINE-FORM
 (KEEP-SENDING-ITEMS-TIL-MATCH PATTERN DATABASE-METHOD ACTOR)
 (DO
  ((ACTOR ACTOR (PARENT-OF ACTOR))
   (METHOD-PREDICATE (METHOD-PATTERN-PREDICATE DATABASE-METHOD)))
  ((NULL ACTOR) NOTHING-FOUND)
  (LET*
   ((ITEMS
     (LET
      ((MYSELF (ACTOR-OF ACTOR))
       (*MESSAGE '(RECALL ALL POSSIBLE ITEMS MATCHING ,PATTERN)))
      (QUICK-COMPILED-ASK
       '#,(METHOD-AT-POSITION (|(RECALL ALL POSSIBLE ITEMS MATCHING ?)| 0) SOMETHING)
       '#,(ACTOR-OF (QUOTE SOMETHING)))))
    (RESULT
     (COND ((NULL ITEMS) NIL)
           ((SYMBOLP METHOD-PREDICATE)
            (RUN-FIRST-TO-MATCH ITEMS DATABASE-METHOD METHOD-PREDICATE))
           (T (RUN-FIRST-THATS-EQUAL ITEMS DATABASE-METHOD PATTERN)))))
   (COND ((EQ RESULT 'DIRECTOR-SYMBOL-FOR-NOTHING-FOUND))
         (T (RETURN RESULT)))))) 
(DEFINE-FORM
 (COPY-INTERNAL-VARIABLE-ALIST ALISTS NEW-ACTOR)
 (LET
  ((SUBSTITUTION-ALIST
    (APPEND
     (MAPCAR
      (FUNCTION
       (LAMBDA (CHILD)
         (LET
          ((COPY
            (LET
             ((MYSELF (ACTOR-OF CHILD)) (*MESSAGE '(CLONE)))
             (QUICK-COMPILED-ASK
              '#,(METHOD-AT-POSITION ((CLONE) 0) SOMETHING)
              '#,(ACTOR-OF (QUOTE SOMETHING))))))
          (LET
           ((MYSELF (ACTOR-OF COPY)) (*MESSAGE '(SET YOUR PARENT TO ,NEW-ACTOR)))
           (QUICK-COMPILED-ASK
            '#,(METHOD-AT-POSITION (|(SET YOUR PARENT TO ?)| 0) SOMETHING)
            '#,(ACTOR-OF (QUOTE SOMETHING))))
          (CONS (ACTOR-OF CHILD) COPY))))
      (SECOND (ASSQ 'OFFSPRING (FIRST ALISTS))))
     (MAPCAR
      (FUNCTION
       (LAMBDA (PART)
         (LET
          ((COPY
            (LET
             ((MYSELF (ACTOR-OF PART)) (*MESSAGE '(CLONE)))
             (QUICK-COMPILED-ASK
              '#,(METHOD-AT-POSITION ((CLONE) 0) SOMETHING)
              '#,(ACTOR-OF (QUOTE SOMETHING))))))
          (LET
           ((MYSELF (ACTOR-OF COPY)) (*MESSAGE '(SET YOUR WHOLE TO ,NEW-ACTOR)))
           (QUICK-COMPILED-ASK
            '#,(METHOD-AT-POSITION (|(SET YOUR WHOLE TO ?)| 0) SOMETHING)
            '#,(ACTOR-OF (QUOTE SOMETHING))))
          (CONS (ACTOR-OF PART) COPY))))
      (SECOND (ASSQ 'PARTS (FIRST ALISTS)))))))
  (CONS
   (SUBSTITUTE-IN-ALIST (FIRST ALISTS) SUBSTITUTION-ALIST)
   (SUBSTITUTE-IN-ALIST (REST ALISTS) SUBSTITUTION-ALIST)))) 
(DEFINE-FORM
 (CLONE-ACTOR LIST-OF-NAME)
 (LET*
  ((NAME-OR-NEW-ACTOR
    (LET
     ((*MESSAGE '(SEQUENTIALLY (ASK YOUR PARENT TO MAKE !,LIST-OF-NAME))))
     (QUICK-COMPILED-ASK
      '#,(METHOD-AT-POSITION (|(SEQUENTIALLY (ASK YOUR ? %) %)| 0) SOMETHING)
      '#,(ACTOR-OF (QUOTE SOMETHING)))))
   (NEW-ACTOR (ACTOR-OF NAME-OR-NEW-ACTOR))
   (OLD-METHODS-COPY (TOP-LEVEL-COPY (METHODS-OF MYSELF))))
  (REPLACE-REST (METHODS-OF NEW-ACTOR) (REST OLD-METHODS-COPY))
  (SET-BODY-OF-METHOD
   (FIRST (METHODS-OF NEW-ACTOR))
   (COPY-INTERNAL-VARIABLE-ALIST (BODY-OF-METHOD (FIRST (METHODS-OF MYSELF))) NEW-ACTOR))
  (COND (LIST-OF-NAME
         (LET
          ((MYSELF (ACTOR-OF NEW-ACTOR))
           (*MESSAGE '(SET YOUR NAME TO ,NAME-OR-NEW-ACTOR)))
          (QUICK-COMPILED-ASK
           '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
           '#,(ACTOR-OF (QUOTE SOMETHING)))))
        (T
         (LET
          ((MYSELF (ACTOR-OF NEW-ACTOR)) (*MESSAGE '(FORGET YOUR NAME)))
          (QUICK-COMPILED-ASK
           '#,(METHOD-AT-POSITION (|(FORGET YOUR ?)| 0) SOMETHING)
           '#,(ACTOR-OF (QUOTE SOMETHING))))
         NEW-ACTOR)))) 
(DEFINE-FORM
 (SET-EACH-COMPONENT COMPONENTS VALUES COMPONENTS-METHOD)
 (RUN-WITH-METHOD-INVISIBLE
  (MAPC
   (FUNCTION
    (LAMBDA (COMPONENT VALUE)
      (LET
       ((*MESSAGE '(SET YOUR ,COMPONENT TO ,VALUE)))
       (COMPILED-ASK
        '#,(LIST
            (METHOD-AT-POSITION (|(SET YOUR PARENT TO ?)| 0) SOMETHING)
            (METHOD-AT-POSITION (|(SET YOUR WHOLE TO ?)| 0) SOMETHING)
            (METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING))
        '#,(ACTOR-OF (QUOTE SOMETHING))))))
   COMPONENTS
   VALUES)
  MYSELF
  COMPONENTS-METHOD)) 
(DEFINE-FORM
 (SET-VALUE-OF-ELEMENT ELEMENT VALUE-OF-ELEMENT VARIABLE THE-NAMES)
 (LET
  ((ORIGINAL-VALUE
    (TOP-LEVEL-COPY
     (OR
      (LET
       ((*MESSAGE '(RECALL YOUR ,VARIABLE)))
       (COMPILED-ASK
        '#,(LIST
            (METHOD-AT-POSITION ((RECALL YOUR SIBLINGS) 0) SOMETHING)
            (METHOD-AT-POSITION ((RECALL YOUR DESCENDANTS) 0) SOMETHING)
            (METHOD-AT-POSITION ((RECALL YOUR CHILDLESS-DESCENDANTS) 0) SOMETHING)
            (METHOD-AT-POSITION ((RECALL YOUR PARENT) 0) SOMETHING)
            (METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING))
        '#,(ACTOR-OF (QUOTE SOMETHING))))
      THE-NAMES))))
  (DO
   ((NAMES THE-NAMES (REST NAMES)) (OLD-VALUE ORIGINAL-VALUE (REST OLD-VALUE)))
   ((NULL NAMES)
    (SHOULDNT-HAPPEN MYSELF '(|bug in consider| ,THE-NAMES |components of| ,VARIABLE)))
   (COND ((EQUAL (FIRST NAMES) ELEMENT)
          (COND ((LISTP OLD-VALUE)
                 (REPLACE-FIRST OLD-VALUE VALUE-OF-ELEMENT)
                 (RUN-WITH-METHOD-INVISIBLE
                  (LET
                   ((*MESSAGE '(SET YOUR ,VARIABLE TO ,ORIGINAL-VALUE)))
                   (COMPILED-ASK
                    '#,(LIST
                        (METHOD-AT-POSITION (|(SET YOUR PARENT TO ?)| 0) SOMETHING)
                        (METHOD-AT-POSITION (|(SET YOUR WHOLE TO ?)| 0) SOMETHING)
                        (METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING))
                    '#,(ACTOR-OF (QUOTE SOMETHING))))
                  MYSELF
                  *METHOD-BEING-RUN)
                 (RETURN VALUE-OF-ELEMENT))
                (T
                 (SHOULDNT-HAPPEN
                  'SET-VALUE-OF-ELEMENT
                  '(|the value of|
                    ,VARIABLE
                    |is|
                    ,ORIGINAL-VALUE
                    |which does not correspond to|
                    ,THE-NAMES))))))))) 
(DEFINE-FORM
 (RECALL-VALUE-OF-ELEMENT ELEMENT VARIABLE NAMES)
 (DO
  ((NAMES NAMES (REST NAMES))
   (VALUE
    (RUN-WITH-METHOD-INVISIBLE
     (LET
      ((*MESSAGE '(RECALL YOUR ,VARIABLE)))
      (COMPILED-ASK
       '#,(LIST
           (METHOD-AT-POSITION ((RECALL YOUR SIBLINGS) 0) SOMETHING)
           (METHOD-AT-POSITION ((RECALL YOUR DESCENDANTS) 0) SOMETHING)
           (METHOD-AT-POSITION ((RECALL YOUR CHILDLESS-DESCENDANTS) 0) SOMETHING)
           (METHOD-AT-POSITION ((RECALL YOUR PARENT) 0) SOMETHING)
           (METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING))
       '#,(ACTOR-OF (QUOTE SOMETHING))))
     MYSELF
     *METHOD-BEING-RUN)
    (REST VALUE)))
  ((NULL NAMES)
   (SHOULDNT-HAPPEN
    'RECALL-VALUE-OF-ELEMENT
    '(|in "the name of elements of ..." of| ,MYSELF)))
  (COND ((EQUAL (FIRST NAMES) ELEMENT) (RETURN (FIRST VALUE)))))) 
(DEFINE-FORM
 (FORGET-YOUR-VARIABLE VARIABLE ALISTS SYNONYMS?)
 (AND
  SYNONYMS?
  (DO
   ((SYNONYMS (SECOND (ASSOC '(SYNONYMS-OF ,VARIABLE) (REST ALISTS))) (REST SYNONYMS)))
   ((NULL SYNONYMS))
   (FORGET-YOUR-VARIABLE (FIRST SYNONYMS) ALISTS NIL)))
 (COND ((ATOM VARIABLE)
        (LET
         ((OLD-PAIR (ASSQ VARIABLE (FIRST ALISTS))))
         (COND (OLD-PAIR (REPLACE-FIRST ALISTS (DELQ OLD-PAIR (FIRST ALISTS))) NO-VALUE))))
       (T
        (LET
         ((OLD-PAIR (ASSOC VARIABLE (REST ALISTS))))
         (COND (OLD-PAIR (REPLACE-REST ALISTS (DELQ OLD-PAIR (REST ALISTS))) NO-VALUE)))))) 
(DEFINE-FORM
 (NAME-OF ACTOR)
 (LET
  ((MYSELF (ACTOR-OF ACTOR)) (*MESSAGE '(RECALL YOUR NAME)))
  (QUICK-COMPILED-ASK
   '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
   '#,(ACTOR-OF (QUOTE SOMETHING))))) 
(DEFINE-FORM
 (SET-VARIABLE-TO-VALUE VARIABLE VALUE)
 (LET*
  ((ALISTS (INTERNAL-RECALL-YOUR-VARIABLE-OF MYSELF))
   (OLD-PAIR (ASSQ-ASSOC VARIABLE ALISTS)))
  (COND (OLD-PAIR (REPLACE-FIRST (REST OLD-PAIR) VALUE))
        (T
         (LET
          ((NEW-PAIR
            (COND ((MEMBER
                    VARIABLE
                    (LET
                     ((*MESSAGE '(RECALL YOUR PRIVATE-VARIABLE-NAMES)))
                     (QUICK-COMPILED-ASK
                      '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
                      '#,(ACTOR-OF (QUOTE SOMETHING)))))
                   (LIST VARIABLE VALUE 'PRIVATE))
                  (T (LIST VARIABLE VALUE)))))
          (ADD-VARIABLE-PAIR-TO-ACTOR VARIABLE ALISTS NEW-PAIR)
          (MAPC
           (FUNCTION
            (LAMBDA (SYNONYM)
              (OR
               (LOOK-UP-VARIABLE-IN-ACTOR SYNONYM MYSELF)
               (ADD-VARIABLE-PAIR-TO-ACTOR SYNONYM ALISTS (CONS SYNONYM (REST NEW-PAIR))))))
           (SECOND (ASSOC '(SYNONYMS-OF ,VARIABLE) (REST ALISTS))))))))
 VALUE) 
(DEFINE-FORM
 (DESCENDANTS-OF-INCLUDING-SELF ACTOR)
 (LET
  ((OFFSPRING
    (LET
     ((MYSELF (ACTOR-OF ACTOR)) (*MESSAGE '(RECALL YOUR OFFSPRING)))
     (QUICK-COMPILED-ASK
      '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
      '#,(ACTOR-OF (QUOTE SOMETHING))))))
  (COND (OFFSPRING
         (APPEND (MAPCAN 'DESCENDANTS-OF-INCLUDING-SELF OFFSPRING) (LIST ACTOR)))
        (T (LIST ACTOR))))) 
(DEFINE-FORM
 (CHILDLESS-DESCENDANTS-OF ACTOR)
 (LET
  ((OFFSPRING
    (LET
     ((MYSELF (ACTOR-OF ACTOR)) (*MESSAGE '(RECALL YOUR OFFSPRING)))
     (QUICK-COMPILED-ASK
      '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
      '#,(ACTOR-OF (QUOTE SOMETHING))))))
  (COND (OFFSPRING (MAPCAN 'CHILDLESS-DESCENDANTS-OF OFFSPRING))
        (T (LIST ACTOR))))) 
(COMMENT NOW THE DEFINITIONS OF THE METHODS OF THE ABOVE ACTORS) 
(DEFUN D0168 NIL
  ((LAMBDA (WARNING)
     (LET
      ((*MESSAGE '(MEMORIZE ,WARNING)))
      (QUICK-COMPILED-ASK
       '#,(METHOD-AT-POSITION (|(MEMORIZE ?)| 0) SOMETHING)
       '#,(ACTOR-OF (QUOTE SOMETHING))))
     (SHOULDNT-HAPPEN (NAME-OF MYSELF) WARNING))
   (CDDDR *MESSAGE))) 
(DEFUN |(SHOULD NOT HAPPEN %)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE SHOULD))
   (AND (EQ (CADR OBJECT) (QUOTE NOT)) (EQ (CADDR OBJECT) (QUOTE HAPPEN))))) 
(DEFPROP |(SHOULD NOT HAPPEN %)| (SHOULD NOT HAPPEN %) PATTERN) 
(DEFUN D0167 NIL
  ((LAMBDA (SOME-WARNING)
     (LET
      ((*MESSAGE '(MEMORIZE ,SOME-WARNING)))
      (QUICK-COMPILED-ASK
       '#,(METHOD-AT-POSITION (|(MEMORIZE ?)| 0) SOMETHING)
       '#,(ACTOR-OF (QUOTE SOMETHING))))
     (WARNING (NAME-OF MYSELF) SOME-WARNING))
   (CDR *MESSAGE))) 
(DEFUN |(WARNING %)| (OBJECT) (EQ (CAR OBJECT) (QUOTE WARNING))) 
(DEFPROP |(WARNING %)| (WARNING %) PATTERN) 
(DEFUN D0166 NIL
  ((LAMBDA (PATTERN)
     (LET*
      ((NAME (NAME-OF MYSELF))
       (HELP-FILE '(,*HELP-STORAGE-PLACE ,NAME HELP))
       (HELP-HOLDER '(HELP-FOR ,NAME))
       (PARENT
        (NAME-OF
         (LET
          ((*MESSAGE '(RECALL YOUR PARENT)))
          (QUICK-COMPILED-ASK
           '#,(METHOD-AT-POSITION ((RECALL YOUR PARENT) 0) SOMETHING)
           '#,(ACTOR-OF (QUOTE SOMETHING)))))))
      (COND ((COND ((EXISTS? HELP-HOLDER))
                   ((PROBEF HELP-FILE)
                    (LET
                     ((MYSELF (ACTOR-OF (QUOTE SOMETHING)))
                      (*MESSAGE '(MAKE ,HELP-HOLDER)))
                     (QUICK-COMPILED-ASK
                      '#,(METHOD-AT-POSITION (|(MAKE ?)| 0) SOMETHING)
                      '#,(ACTOR-OF (QUOTE SOMETHING))))
                    (DIRECTOR-LOAD HELP-FILE '(TO GET HELP FOR ,(NAME-OF MYSELF)))))
             (MAPC
              (FUNCTION
               (LAMBDA (HELP)
                 (TERPRI)
                 (TERPRI)
                 (PRINC (FIRST HELP))
                 (PRINC '| |)
                 (PRINC-OR-PRINT (SECOND HELP) NIL 'GRIND)
                 (PRINC '| |)
                 (PRINC (THIRD HELP))
                 (MAPC (FUNCTION (LAMBDA (LINE) (TYPE LINE))) (NTH-REST 3 HELP))))
              (LET
               ((MYSELF (ACTOR-OF HELP-HOLDER))
                (*MESSAGE
                 '(COLLECT
                   ITEMS
                   MEMORIZED
                   MATCHING
                   (|When receiving| ,(OR PATTERN '?) I %))))
               (QUICK-COMPILED-ASK
                '#,(METHOD-AT-POSITION
                    (|(COLLECT ITEMS MEMORIZED MATCHING ?)| 0)
                    SOMETHING)
                '#,(ACTOR-OF (QUOTE SOMETHING))))))
            (T (TYPE '|Sorry no help available|)))
      (COND (PARENT
             (TERPRI)
             (TYPE '(|More help can be gotten by asking my parent| ,PARENT |for help|))
             (TERPRI))))
     NO-VALUE)
   (CDR *MESSAGE))) 
(DEFUN |(HELP %)| (OBJECT) (EQ (CAR OBJECT) (QUOTE HELP))) 
(DEFPROP |(HELP %)| (HELP %) PATTERN) 
(DEFUN D0165 NIL
  ((LAMBDA (FILE-NAMES) (COMPILE-AND-PRINT-ACTOR (NAME-OF MYSELF) FILE-NAMES) NO-VALUE)
   (CDR *MESSAGE))) 
(DEFUN |(SAVE %)| (OBJECT) (EQ (CAR OBJECT) (QUOTE SAVE))) 
(DEFPROP |(SAVE %)| (SAVE %) PATTERN) 
(DEFUN D0164 NIL
  ((LAMBDA (MESSAGE) (LISPIFY-TRANSMISSION MYSELF MESSAGE (NAME-OF MYSELF) NIL))
   (CDDR *MESSAGE))) 
(DEFUN |(COMPILE MESSAGE %)| (OBJECT)
  (AND (EQ (CAR OBJECT) (QUOTE COMPILE)) (EQ (CADR OBJECT) (QUOTE MESSAGE)))) 
(DEFPROP |(COMPILE MESSAGE %)| (COMPILE MESSAGE %) PATTERN) 
(DEFUN D0163 NIL
  ((LAMBDA (OTHER)
     (LET
      ((NAME (ACTOR-OF MYSELF)))
      (LET
       ((COMPARISON
         (LET
          ((MYSELF (ACTOR-OF (QUOTE SOMETHING)))
           (*MESSAGE '(MAKE (COMPARISON-BETWEEN ,NAME ,OTHER))))
          (QUICK-COMPILED-ASK
           '#,(METHOD-AT-POSITION (|(MAKE ?)| 0) SOMETHING)
           '#,(ACTOR-OF (QUOTE SOMETHING))))))
       (COND ((EXISTS? OTHER)
              (LET
               ((MY-VARIABLES
                 (LET
                  ((*MESSAGE '(LIST ALL YOUR VARIABLE NAMES)))
                  (QUICK-COMPILED-ASK
                   '#,(METHOD-AT-POSITION ((LIST ALL YOUR VARIABLE NAMES) 0) SOMETHING)
                   '#,(ACTOR-OF (QUOTE SOMETHING)))))
                (OTHERS-VARIABLES
                 (LET
                  ((MYSELF (ACTOR-OF OTHER)) (*MESSAGE '(LIST ALL YOUR VARIABLE NAMES)))
                  (QUICK-COMPILED-ASK
                   '#,(METHOD-AT-POSITION ((LIST ALL YOUR VARIABLE NAMES) 0) SOMETHING)
                   '#,(ACTOR-OF (QUOTE SOMETHING))))))
               (DO
                ((I (UNION MY-VARIABLES OTHERS-VARIABLES) (REST I)))
                ((NULL I))
                (OR
                 (EQ (FIRST I) 'NAME)
                 (LET
                  ((MY-VALUE
                    (LET
                     ((*MESSAGE '(RECALL YOUR ,(FIRST I))))
                     (COMPILED-ASK
                      '#,(LIST
                          (METHOD-AT-POSITION ((RECALL YOUR SIBLINGS) 0) SOMETHING)
                          (METHOD-AT-POSITION ((RECALL YOUR DESCENDANTS) 0) SOMETHING)
                          (METHOD-AT-POSITION
                           ((RECALL YOUR CHILDLESS-DESCENDANTS) 0)
                           SOMETHING)
                          (METHOD-AT-POSITION ((RECALL YOUR PARENT) 0) SOMETHING)
                          (METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING))
                      '#,(ACTOR-OF (QUOTE SOMETHING)))))
                   (OTHERS-VALUE
                    (LET
                     ((MYSELF (ACTOR-OF OTHER)) (*MESSAGE '(RECALL YOUR ,(FIRST I))))
                     (COMPILED-ASK
                      '#,(LIST
                          (METHOD-AT-POSITION ((RECALL YOUR SIBLINGS) 0) SOMETHING)
                          (METHOD-AT-POSITION ((RECALL YOUR DESCENDANTS) 0) SOMETHING)
                          (METHOD-AT-POSITION
                           ((RECALL YOUR CHILDLESS-DESCENDANTS) 0)
                           SOMETHING)
                          (METHOD-AT-POSITION ((RECALL YOUR PARENT) 0) SOMETHING)
                          (METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING))
                      '#,(ACTOR-OF (QUOTE SOMETHING))))))
                  (COND ((NOT (EQUAL MY-VALUE OTHERS-VALUE))
                         (LET
                          ((MYSELF (ACTOR-OF COMPARISON))
                           (*MESSAGE
                            '(MEMORIZE
                              (DIFFERENCE
                               TYPE
                               VARIABLE
                               VARIABLE
                               ,(FIRST I)
                               (,OTHER VALUE)
                               ,OTHERS-VALUE
                               (,NAME VALUE)
                               ,MY-VALUE))))
                          (QUICK-COMPILED-ASK
                           '#,(METHOD-AT-POSITION (|(MEMORIZE ?)| 0) SOMETHING)
                           '#,(ACTOR-OF (QUOTE SOMETHING)))))))))))
             (T
              (LET
               ((MYSELF (ACTOR-OF COMPARISON))
                (*MESSAGE
                 '(MEMORIZE
                   (DIFFERENCE TYPE EXISTENCE WHO-EXISTS ,NAME WHO-DOESNT ,OTHER))))
               (QUICK-COMPILED-ASK
                '#,(METHOD-AT-POSITION (|(MEMORIZE ?)| 0) SOMETHING)
                '#,(ACTOR-OF (QUOTE SOMETHING))))))
       COMPARISON)))
   (CADDDR *MESSAGE))) 
(DEFUN |(COMPARE YOURSELF WITH ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE COMPARE))
   (AND
    (EQ (CADR OBJECT) (QUOTE YOURSELF))
    (AND (EQ (CADDR OBJECT) (QUOTE WITH)) (ONE-LONG (CDDDR OBJECT)))))) 
(DEFPROP |(COMPARE YOURSELF WITH ?)| (COMPARE YOURSELF WITH ?) PATTERN) 
(DEFUN D0162 NIL
  ((LAMBDA (VARIABLE)
     (TYPE
      '(/;                                      ,(NAME-OR-ACTOR-OF MYSELF)
        |'s value of|                           ,VARIABLE
        |is|                                    ,(ASK MYSELF RECALL YOUR ,VARIABLE))))
   (CADDR *MESSAGE))) 
(DEFUN |(PRINT YOUR ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE PRINT))
   (AND (EQ (CADR OBJECT) (QUOTE YOUR)) (ONE-LONG (CDDR OBJECT))))) 
(DEFPROP |(PRINT YOUR ?)| (PRINT YOUR ?) PATTERN) 
(DEFUN D0161 NIL (FANCY-PRINT 'ALL)) 
(DEFUN D0160 NIL ((LAMBDA (OPTION) (FANCY-PRINT OPTION)) (CADR *MESSAGE))) 
(DEFUN |(PRINT {MEMQ ? '(MEMORY VARIABLES SCRIPT DATABASE ALL)})| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE PRINT))
   (AND
    (LET ((? (CADR OBJECT))) (MEMQ ? '(MEMORY VARIABLES SCRIPT DATABASE ALL)))
    (NULL (CDDR OBJECT))))) 
(DEFPROP
 |(PRINT {MEMQ ? '(MEMORY VARIABLES SCRIPT DATABASE ALL)})|
 (PRINT {MEMQ ? '(MEMORY VARIABLES SCRIPT DATABASE ALL)})
 PATTERN) 
(DEFUN D0159 NIL
  ((LAMBDA (FILE-NAME OPTION) (FANCY-PRINT OPTION FILE-NAME)) (CAR (CDDDDR *MESSAGE))
   (CADR *MESSAGE))) 
(DEFUN |(PRINT {MEMQ ? '(MEMORY VARIABLES SCRIPT DATABASE ALL)} ON FILE ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE PRINT))
   (AND
    (LET ((? (CADR OBJECT))) (MEMQ ? '(MEMORY VARIABLES SCRIPT DATABASE ALL)))
    (AND
     (EQ (CADDR OBJECT) (QUOTE ON))
     (AND (EQ (CADDDR OBJECT) (QUOTE FILE)) (ONE-LONG (CDDDDR OBJECT))))))) 
(DEFPROP
 |(PRINT {MEMQ ? '(MEMORY VARIABLES SCRIPT DATABASE ALL)} ON FILE ?)|
 (PRINT {MEMQ ? '(MEMORY VARIABLES SCRIPT DATABASE ALL)} ON FILE ?)
 PATTERN) 
(DEFUN D0158 NIL NIL) 
(DEFUN |(NOTICE THAT ? OF ? IS NOW ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE NOTICE))
   (AND
    (EQ (CADR OBJECT) (QUOTE THAT))
    (AND
     (EQ (CADDDR OBJECT) (QUOTE OF))
     (AND
      (EQ (CADR (CDDDDR OBJECT)) (QUOTE IS))
      (AND (EQ (CADDR (CDDDDR OBJECT)) (QUOTE NOW)) (ONE-LONG (CDDDR (CDDDDR OBJECT))))))))) 
(DEFPROP |(NOTICE THAT ? OF ? IS NOW ?)| (NOTICE THAT ? OF ? IS NOW ?) PATTERN) 
(DEFUN D0155 NIL
  ((LAMBDA (VARIABLE OTHER)
     (LET
      ((*MESSAGE
        '(SEQUENTIALLY
          (ASK
           YOUR
           ,OTHER
           TO
           NOTICE
           THAT
           ,VARIABLE
           OF
           ,MYSELF
           IS
           NOW
           ,(ASK MYSELF RECALL YOUR ,VARIABLE)))))
      (QUICK-COMPILED-ASK
       '#,(METHOD-AT-POSITION (|(SEQUENTIALLY (ASK YOUR ? %) %)| 0) SOMETHING)
       '#,(ACTOR-OF (QUOTE SOMETHING))))
     (LET
      ((*MESSAGE
        '(SET
          YOUR
          (VARIABLES-DEPENDED-UPON-BY ,OTHER)
          TO
          ,(CONS-IF-NOT-MEMBER
            (QUOTE-IF-NEED-BE ,VARIABLE)
            (ASK MYSELF RECALL YOUR (VARIABLES-DEPENDED-UPON-BY ,OTHER))))))
      (QUICK-COMPILED-ASK
       '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
       '#,(ACTOR-OF (QUOTE SOMETHING))))
     (LET
      ((*MESSAGE
        '(DO
          WHEN
          RECEIVING
          (SET YOUR ,VARIABLE TO ?NEW-VALUE)
          (DO-OLD-BEHAVIOR)
          (TELL-OTHER-NEW-VALUE (QUOTE ,VARIABLE) NEW-VALUE (QUOTE ,OTHER))
          NEW-VALUE)))
      (QUICK-COMPILED-ASK
       '#,(METHOD-AT-POSITION (|(DO WHEN RECEIVING ? %)| 0) SOMETHING)
       '#,(ACTOR-OF (QUOTE SOMETHING)))))
   (CADR (CDDDDR *MESSAGE)) (CADDR *MESSAGE))) 
(DEFUN |(TELL YOUR ? WHENEVER YOUR ? IS CHANGED)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE TELL))
   (AND
    (EQ (CADR OBJECT) (QUOTE YOUR))
    (AND
     (EQ (CADDDR OBJECT) (QUOTE WHENEVER))
     (AND
      (EQ (CAR (CDDDDR OBJECT)) (QUOTE YOUR))
      (EQUAL (CDDR (CDDDDR OBJECT)) (QUOTE (IS CHANGED)))))))) 
(DEFPROP
 |(TELL YOUR ? WHENEVER YOUR ? IS CHANGED)|
 (TELL YOUR ? WHENEVER YOUR ? IS CHANGED)
 PATTERN) 
(DEFUN D0153 NIL
  ((LAMBDA (VARIABLE OTHERS)
     (COND ((MEMBER
             VARIABLE
             (LET
              ((*MESSAGE '(RECALL YOUR (VARIABLES-DEPENDED-UPON-BY ,OTHERS))))
              (QUICK-COMPILED-ASK
               '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
               '#,(ACTOR-OF (QUOTE SOMETHING))))))
           (T
            (LET
             ((*MESSAGE
               '(SET
                 YOUR
                 (VARIABLES-DEPENDED-UPON-BY ,OTHERS)
                 TO
                 ,(CONS-IF-NOT-MEMBER
                   (QUOTE-IF-NEED-BE ,VARIABLE)
                   (ASK MYSELF RECALL YOUR (VARIABLES-DEPENDED-UPON-BY ,OTHERS))))))
             (QUICK-COMPILED-ASK
              '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
              '#,(ACTOR-OF (QUOTE SOMETHING))))
            (LET
             ((*MESSAGE
               '(DO
                 WHEN
                 RECEIVING
                 (SET YOUR ,VARIABLE TO ?NEW-VALUE)
                 (DO-OLD-BEHAVIOR)
                 (TELL-OTHERS-NEW-VALUE (QUOTE ,VARIABLE) NEW-VALUE (QUOTE ,OTHERS))
                 NEW-VALUE)))
             (QUICK-COMPILED-ASK
              '#,(METHOD-AT-POSITION (|(DO WHEN RECEIVING ? %)| 0) SOMETHING)
              '#,(ACTOR-OF (QUOTE SOMETHING)))))))
   (CADDDR (CDDDDR *MESSAGE)) (CAR (CDDDDR *MESSAGE)))) 
(DEFUN |(TELL EACH OF YOUR ? WHENEVER YOUR ? IS CHANGED)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE TELL))
   (AND
    (EQ (CADR OBJECT) (QUOTE EACH))
    (AND
     (EQ (CADDR OBJECT) (QUOTE OF))
     (AND
      (EQ (CADDDR OBJECT) (QUOTE YOUR))
      (AND
       (EQ (CADR (CDDDDR OBJECT)) (QUOTE WHENEVER))
       (AND
        (EQ (CADDR (CDDDDR OBJECT)) (QUOTE YOUR))
        (EQUAL (CDDDDR (CDDDDR OBJECT)) (QUOTE (IS CHANGED)))))))))) 
(DEFPROP
 |(TELL EACH OF YOUR ? WHENEVER YOUR ? IS CHANGED)|
 (TELL EACH OF YOUR ? WHENEVER YOUR ? IS CHANGED)
 PATTERN) 
(DEFUN D0152 NIL
  ((LAMBDA (OTHER OTHERS-VARIABLE FUNCTION VARIABLE)
     (LET
      ((MYSELF (ACTOR-OF OTHER))
       (*MESSAGE
        '(DO
          WHEN
          RECEIVING
          (SET YOUR ,OTHERS-VARIABLE TO ?NEW-VALUE)
          (ASK-OLD ,MYSELF SET YOUR ,VARIABLE TO `(,FUNCTION NEW-VALUE))
          (DO-OLD-BEHAVIOR))))
      (QUICK-COMPILED-ASK
       '#,(METHOD-AT-POSITION (|(DO WHEN RECEIVING ? %)| 0) SOMETHING)
       '#,(ACTOR-OF (QUOTE SOMETHING)))))
   (CADR (CDDDDR (CDDDDR *MESSAGE))) (CADDDR (CDDDDR *MESSAGE)) (CADR (CDDDDR *MESSAGE))
   (CADDR *MESSAGE))) 
(DEFUN |(CONSTRAIN YOUR ? TO EQUAL ? OF ? OF ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE CONSTRAIN))
   (AND
    (EQ (CADR OBJECT) (QUOTE YOUR))
    (AND
     (EQ (CADDDR OBJECT) (QUOTE TO))
     (AND
      (EQ (CAR (CDDDDR OBJECT)) (QUOTE EQUAL))
      (AND
       (EQ (CADDR (CDDDDR OBJECT)) (QUOTE OF))
       (AND
        (EQ (CAR (CDDDDR (CDDDDR OBJECT))) (QUOTE OF))
        (ONE-LONG (CDR (CDDDDR (CDDDDR OBJECT))))))))))) 
(DEFPROP
 |(CONSTRAIN YOUR ? TO EQUAL ? OF ? OF ?)|
 (CONSTRAIN YOUR ? TO EQUAL ? OF ? OF ?)
 PATTERN) 
(DEFUN D0151 NIL
  (LET
   ((MYSELF+TRACER (ASSQ MYSELF *ACTORS-CURRENTLY-TRACED)))
   (AND MYSELF+TRACER (DIRECTOR-UNTRACE-ALL MYSELF+TRACER)))) 
(DEFUN D0150 NIL ((LAMBDA (PATTERN) (DIRECTOR-UNTRACE MYSELF PATTERN)) (CADR *MESSAGE))) 
(DEFUN |(UNTRACE ?)| (OBJECT)
  (AND (EQ (CAR OBJECT) (QUOTE UNTRACE)) (ONE-LONG (CDR OBJECT)))) 
(DEFPROP |(UNTRACE ?)| (UNTRACE ?) PATTERN) 
(DEFUN D0149 NIL
  ((LAMBDA (PATTERN+ACTION)
     (DIRECTOR-TRACE MYSELF (FIRST PATTERN+ACTION) (REST PATTERN+ACTION)))
   (CDR *MESSAGE))) 
(DEFUN |(TRACE %)| (OBJECT) (EQ (CAR OBJECT) (QUOTE TRACE))) 
(DEFPROP |(TRACE %)| (TRACE %) PATTERN) 
(DEFUN D0148 NIL
  ((LAMBDA (MESSAGE)
     (REMOVE-METHOD (METHOD-THAT-MATCHES-JUST-ACTOR MYSELF MESSAGE) MYSELF))
   (CDDDR *MESSAGE))) 
(DEFUN |(REMOVE METHOD FOR %)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE REMOVE))
   (AND (EQ (CADR OBJECT) (QUOTE METHOD)) (EQ (CADDR OBJECT) (QUOTE FOR))))) 
(DEFPROP |(REMOVE METHOD FOR %)| (REMOVE METHOD FOR %) PATTERN) 
(DEFUN D0147 NIL
  ((LAMBDA (MESSAGE)
     (HUMANIFY-METHOD (METHOD-THAT-MATCHES (METHODS-OF MYSELF) MESSAGE)))
   (CDDDR *MESSAGE))) 
(DEFUN |(RECALL METHOD FOR %)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE RECALL))
   (AND (EQ (CADR OBJECT) (QUOTE METHOD)) (EQ (CADDR OBJECT) (QUOTE FOR))))) 
(DEFPROP |(RECALL METHOD FOR %)| (RECALL METHOD FOR %) PATTERN) 
(DEFUN D0146 NIL
  ((LAMBDA (MESSAGE) (METHOD-THAT-MATCHES (METHODS-OF MYSELF) MESSAGE)) (CDDDDR *MESSAGE))) 
(DEFUN |(RECALL INTERNAL METHOD FOR %)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE RECALL))
   (AND
    (EQ (CADR OBJECT) (QUOTE INTERNAL))
    (AND (EQ (CADDR OBJECT) (QUOTE METHOD)) (EQ (CADDDR OBJECT) (QUOTE FOR)))))) 
(DEFPROP |(RECALL INTERNAL METHOD FOR %)| (RECALL INTERNAL METHOD FOR %) PATTERN) 
(DEFUN D0145 NIL
  ((LAMBDA (NAME-PATTERN)
     (LET
      ((NAME (NAME-OF MYSELF)))
      (COND ((MATCH NAME NAME-PATTERN) MYSELF)
            (T
             (LET
              ((PARENT (PARENT-OF MYSELF)))
              (COND (PARENT
                     (LET
                      ((MYSELF (ACTOR-OF PARENT)) (*MESSAGE '(!,*MESSAGE)))
                      (QUICK-COMPILED-ASK
                       '#,(METHOD-AT-POSITION (|(FIND ANCESTOR MATCHING ?)| 0) SOMETHING)
                       '#,(ACTOR-OF (QUOTE SOMETHING)))))))))))
   (CADDDR *MESSAGE))) 
(DEFUN |(FIND ANCESTOR MATCHING ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE FIND))
   (AND
    (EQ (CADR OBJECT) (QUOTE ANCESTOR))
    (AND (EQ (CADDR OBJECT) (QUOTE MATCHING)) (ONE-LONG (CDDDR OBJECT)))))) 
(DEFPROP |(FIND ANCESTOR MATCHING ?)| (FIND ANCESTOR MATCHING ?) PATTERN) 
(DEFUN D0144 NIL
  ((LAMBDA (TYPE) (IS-ANY-ANCESTOR-OF MYSELF (ACTOR-OF TYPE))) (CADDDR *MESSAGE))) 
(DEFUN |(ARE YOU {or A AN} ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE ARE))
   (AND
    (EQ (CADR OBJECT) (QUOTE YOU))
    (AND (MEMQ (CADDR OBJECT) (QUOTE (A AN))) (ONE-LONG (CDDDR OBJECT)))))) 
(DEFPROP |(ARE YOU {or A AN} ?)| (ARE YOU {or A AN} ?) PATTERN) 
(DEFUN D0143 NIL
  ((LAMBDA (MESSAGE PREDICATE)
     (DO
      ((RESULT
        (LET ((*MESSAGE '(!,MESSAGE))) (CASES MYSELF))
        (LET ((*MESSAGE '(!,MESSAGE))) (CASES MYSELF))))
      ((FUNCALL PREDICATE RESULT) RESULT)))
   (CDDDDR *MESSAGE) (CADDDR *MESSAGE))) 
(DEFUN |(KEEP DOING UNTIL ? %)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE KEEP))
   (AND
    (EQ (CADR OBJECT) (QUOTE DOING))
    (AND (EQ (CADDR OBJECT) (QUOTE UNTIL)) (LISTP (CDDDR OBJECT)))))) 
(DEFPROP |(KEEP DOING UNTIL ? %)| (KEEP DOING UNTIL ? %) PATTERN) 
(DEFUN D0142 NIL
  ((LAMBDA (ACTIONS)
     (COND ((NULL ACTIONS) NO-VALUE)
           ((ONE-LONG ACTIONS) (LET ((*MESSAGE '(!,(FIRST ACTIONS)))) (CASES MYSELF)))
           (T
            (LET ((*MESSAGE '(!,(FIRST ACTIONS)))) (CASES MYSELF))
            (LET
             ((*MESSAGE '(SEQUENTIALLY !,(REST ACTIONS))))
             (COMPILED-ASK
              '#,(LIST
                  (METHOD-AT-POSITION (|(SEQUENTIALLY (PLAN NEXT %) %)| 0) SOMETHING)
                  (METHOD-AT-POSITION
                   (|(SEQUENTIALLY (PLAN AFTER ? ? %) %)| 0)
                   SOMETHING)
                  (METHOD-AT-POSITION (|(SEQUENTIALLY (CONCURRENTLY %) %)| 0) SOMETHING)
                  (METHOD-AT-POSITION
                   (|(SEQUENTIALLY (REPEAT ? FOREVER) %)| 0)
                   SOMETHING)
                  (METHOD-AT-POSITION
                   (|(SEQUENTIALLY (REPEAT ? ? TIMES) %)| 0)
                   SOMETHING)
                  (METHOD-AT-POSITION
                   (|(SEQUENTIALLY (DO AT SPEED ? ASK ? {or SET CHANGE} YOUR ? TO ?) %)|
                    0)
                   SOMETHING)
                  (METHOD-AT-POSITION
                   (|(SEQUENTIALLY (DO AT SPEED ? {or SET CHANGE} YOUR ? TO ?) %)| 0)
                   SOMETHING)
                  (METHOD-AT-POSITION (|(SEQUENTIALLY (DO IN ? ? % ?) %)| 0) SOMETHING)
                  (METHOD-AT-POSITION
                   (|(SEQUENTIALLY (DO AT SPEED ? % ?) %)| 0)
                   SOMETHING)
                  (METHOD-AT-POSITION
                   (|(SEQUENTIALLY (GRADUALLY ASK ? {or SET CHANGE} YOUR ? TO ?) %)| 0)
                   SOMETHING)
                  (METHOD-AT-POSITION
                   (|(SEQUENTIALLY (GRADUALLY {or SET CHANGE} YOUR ? TO ?) %)| 0)
                   SOMETHING)
                  (METHOD-AT-POSITION
                   (|(SEQUENTIALLY (GRADUALLY ASK ? % ?) %)| 0)
                   SOMETHING)
                  (METHOD-AT-POSITION (|(SEQUENTIALLY (GRADUALLY % ?) %)| 0) SOMETHING)
                  (METHOD-AT-POSITION
                   (|(SEQUENTIALLY (BROADCAST OR ASK YOUR ? %) %)| 0)
                   SOMETHING)
                  (METHOD-AT-POSITION
                   (|(SEQUENTIALLY (BROADCAST TO YOUR ? %) %)| 0)
                   SOMETHING)
                  (METHOD-AT-POSITION (|(SEQUENTIALLY (ASK YOUR ? %) %)| 0) SOMETHING)
                  (METHOD-AT-POSITION
                   (|(SEQUENTIALLY (ASK EACH OF YOUR ? %) %)| 0)
                   SOMETHING)
                  (METHOD-AT-POSITION
                   (|(SEQUENTIALLY (ASK EACH OF ? %) %)| 0)
                   SOMETHING)
                  (METHOD-AT-POSITION (|(SEQUENTIALLY (ASK ? %) %)| 0) SOMETHING)
                  (METHOD-AT-POSITION (|(SEQUENTIALLY %)| 0) SOMETHING))
              '#,(ACTOR-OF (QUOTE SOMETHING)))))))
   (CDR *MESSAGE))) 
(DEFUN |(SEQUENTIALLY %)| (OBJECT) (EQ (CAR OBJECT) (QUOTE SEQUENTIALLY))) 
(DEFPROP |(SEQUENTIALLY %)| (SEQUENTIALLY %) PATTERN) 
(DEFUN D0141 NIL
  ((LAMBDA (FOLLOWUP MESSAGE ANOTHER)
     (COND (FOLLOWUP
            (LET
             ((MYSELF (ACTOR-OF ANOTHER))
              (*MESSAGE '(SEQUENTIALLY ,MESSAGE !,FOLLOWUP)))
             (COMPILED-ASK
              '#,(LIST
                  (METHOD-AT-POSITION (|(SEQUENTIALLY (PLAN NEXT %) %)| 0) SOMETHING)
                  (METHOD-AT-POSITION
                   (|(SEQUENTIALLY (PLAN AFTER ? ? %) %)| 0)
                   SOMETHING)
                  (METHOD-AT-POSITION (|(SEQUENTIALLY (CONCURRENTLY %) %)| 0) SOMETHING)
                  (METHOD-AT-POSITION
                   (|(SEQUENTIALLY (REPEAT ? FOREVER) %)| 0)
                   SOMETHING)
                  (METHOD-AT-POSITION
                   (|(SEQUENTIALLY (REPEAT ? ? TIMES) %)| 0)
                   SOMETHING)
                  (METHOD-AT-POSITION
                   (|(SEQUENTIALLY (DO AT SPEED ? ASK ? {or SET CHANGE} YOUR ? TO ?) %)|
                    0)
                   SOMETHING)
                  (METHOD-AT-POSITION
                   (|(SEQUENTIALLY (DO AT SPEED ? {or SET CHANGE} YOUR ? TO ?) %)| 0)
                   SOMETHING)
                  (METHOD-AT-POSITION (|(SEQUENTIALLY (DO IN ? ? % ?) %)| 0) SOMETHING)
                  (METHOD-AT-POSITION
                   (|(SEQUENTIALLY (DO AT SPEED ? % ?) %)| 0)
                   SOMETHING)
                  (METHOD-AT-POSITION
                   (|(SEQUENTIALLY (GRADUALLY ASK ? {or SET CHANGE} YOUR ? TO ?) %)| 0)
                   SOMETHING)
                  (METHOD-AT-POSITION
                   (|(SEQUENTIALLY (GRADUALLY {or SET CHANGE} YOUR ? TO ?) %)| 0)
                   SOMETHING)
                  (METHOD-AT-POSITION
                   (|(SEQUENTIALLY (GRADUALLY ASK ? % ?) %)| 0)
                   SOMETHING)
                  (METHOD-AT-POSITION (|(SEQUENTIALLY (GRADUALLY % ?) %)| 0) SOMETHING)
                  (METHOD-AT-POSITION
                   (|(SEQUENTIALLY (BROADCAST OR ASK YOUR ? %) %)| 0)
                   SOMETHING)
                  (METHOD-AT-POSITION
                   (|(SEQUENTIALLY (BROADCAST TO YOUR ? %) %)| 0)
                   SOMETHING)
                  (METHOD-AT-POSITION (|(SEQUENTIALLY (ASK YOUR ? %) %)| 0) SOMETHING)
                  (METHOD-AT-POSITION
                   (|(SEQUENTIALLY (ASK EACH OF YOUR ? %) %)| 0)
                   SOMETHING)
                  (METHOD-AT-POSITION
                   (|(SEQUENTIALLY (ASK EACH OF ? %) %)| 0)
                   SOMETHING)
                  (METHOD-AT-POSITION (|(SEQUENTIALLY (ASK ? %) %)| 0) SOMETHING)
                  (METHOD-AT-POSITION (|(SEQUENTIALLY %)| 0) SOMETHING))
              '#,(ACTOR-OF (QUOTE SOMETHING)))))
           (T (LET ((*MESSAGE '(!,MESSAGE))) (CASES (ACTOR-OF ANOTHER))))))
   (CDDR *MESSAGE) (CDDADR *MESSAGE) (CADADR *MESSAGE))) 
(DEFUN |(SEQUENTIALLY (ASK ? %) %)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE SEQUENTIALLY))
   (AND (LISTP (CADR OBJECT)) (EQ (CAADR OBJECT) (QUOTE ASK)) (LISTP (CDADR OBJECT))))) 
(DEFPROP |(SEQUENTIALLY (ASK ? %) %)| (SEQUENTIALLY (ASK ? %) %) PATTERN) 
(DEFUN D0140 NIL
  ((LAMBDA (FOLLOWUP MESSAGE OTHERS)
     (COND (FOLLOWUP
            (DIRECTOR-MAPCAR
             (FUNCTION
              (LAMBDA (ACTOR)
                (LET
                 ((MYSELF (ACTOR-OF ACTOR))
                  (*MESSAGE '(SEQUENTIALLY ,MESSAGE !,FOLLOWUP)))
                 (COMPILED-ASK
                  '#,(LIST
                      (METHOD-AT-POSITION
                       (|(SEQUENTIALLY (PLAN NEXT %) %)| 0)
                       SOMETHING)
                      (METHOD-AT-POSITION
                       (|(SEQUENTIALLY (PLAN AFTER ? ? %) %)| 0)
                       SOMETHING)
                      (METHOD-AT-POSITION
                       (|(SEQUENTIALLY (CONCURRENTLY %) %)| 0)
                       SOMETHING)
                      (METHOD-AT-POSITION
                       (|(SEQUENTIALLY (REPEAT ? FOREVER) %)| 0)
                       SOMETHING)
                      (METHOD-AT-POSITION
                       (|(SEQUENTIALLY (REPEAT ? ? TIMES) %)| 0)
                       SOMETHING)
                      (METHOD-AT-POSITION
                       (|(SEQUENTIALLY (DO AT SPEED ? ASK ? {or SET CHANGE} YOUR ? TO ?) %)|
                        0)
                       SOMETHING)
                      (METHOD-AT-POSITION
                       (|(SEQUENTIALLY (DO AT SPEED ? {or SET CHANGE} YOUR ? TO ?) %)|
                        0)
                       SOMETHING)
                      (METHOD-AT-POSITION
                       (|(SEQUENTIALLY (DO IN ? ? % ?) %)| 0)
                       SOMETHING)
                      (METHOD-AT-POSITION
                       (|(SEQUENTIALLY (DO AT SPEED ? % ?) %)| 0)
                       SOMETHING)
                      (METHOD-AT-POSITION
                       (|(SEQUENTIALLY (GRADUALLY ASK ? {or SET CHANGE} YOUR ? TO ?) %)|
                        0)
                       SOMETHING)
                      (METHOD-AT-POSITION
                       (|(SEQUENTIALLY (GRADUALLY {or SET CHANGE} YOUR ? TO ?) %)| 0)
                       SOMETHING)
                      (METHOD-AT-POSITION
                       (|(SEQUENTIALLY (GRADUALLY ASK ? % ?) %)| 0)
                       SOMETHING)
                      (METHOD-AT-POSITION
                       (|(SEQUENTIALLY (GRADUALLY % ?) %)| 0)
                       SOMETHING)
                      (METHOD-AT-POSITION
                       (|(SEQUENTIALLY (BROADCAST OR ASK YOUR ? %) %)| 0)
                       SOMETHING)
                      (METHOD-AT-POSITION
                       (|(SEQUENTIALLY (BROADCAST TO YOUR ? %) %)| 0)
                       SOMETHING)
                      (METHOD-AT-POSITION
                       (|(SEQUENTIALLY (ASK YOUR ? %) %)| 0)
                       SOMETHING)
                      (METHOD-AT-POSITION
                       (|(SEQUENTIALLY (ASK EACH OF YOUR ? %) %)| 0)
                       SOMETHING)
                      (METHOD-AT-POSITION
                       (|(SEQUENTIALLY (ASK EACH OF ? %) %)| 0)
                       SOMETHING)
                      (METHOD-AT-POSITION (|(SEQUENTIALLY (ASK ? %) %)| 0) SOMETHING)
                      (METHOD-AT-POSITION (|(SEQUENTIALLY %)| 0) SOMETHING))
                  '#,(ACTOR-OF (QUOTE SOMETHING))))))
             OTHERS))
           (T
            (DIRECTOR-MAPCAR
             (FUNCTION
              (LAMBDA (ACTOR) (LET ((*MESSAGE '(!,MESSAGE))) (CASES (ACTOR-OF ACTOR)))))
             OTHERS))))
   (CDDR *MESSAGE) (CDDR (CDDADR *MESSAGE)) (CADR (CDDADR *MESSAGE)))) 
(DEFUN |(SEQUENTIALLY (ASK EACH OF ? %) %)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE SEQUENTIALLY))
   (AND
    (LISTP (CADR OBJECT))
    (EQ (CAADR OBJECT) (QUOTE ASK))
    (AND
     (LISTP (CDADR OBJECT))
     (EQ (CADADR OBJECT) (QUOTE EACH))
     (AND
      (LISTP (CDDADR OBJECT))
      (EQ (CAR (CDDADR OBJECT)) (QUOTE OF))
      (LISTP (CDR (CDDADR OBJECT)))))))) 
(DEFPROP |(SEQUENTIALLY (ASK EACH OF ? %) %)| (SEQUENTIALLY (ASK EACH OF ? %) %) PATTERN) 
(DEFUN D0139 NIL
  ((LAMBDA (FOLLOWUP MESSAGE VARIABLE)
     (COND (FOLLOWUP
            (DIRECTOR-MAPCAR
             (FUNCTION
              (LAMBDA (ACTOR)
                (LET
                 ((MYSELF (ACTOR-OF ACTOR))
                  (*MESSAGE '(SEQUENTIALLY ,MESSAGE !,FOLLOWUP)))
                 (COMPILED-ASK
                  '#,(LIST
                      (METHOD-AT-POSITION
                       (|(SEQUENTIALLY (PLAN NEXT %) %)| 0)
                       SOMETHING)
                      (METHOD-AT-POSITION
                       (|(SEQUENTIALLY (PLAN AFTER ? ? %) %)| 0)
                       SOMETHING)
                      (METHOD-AT-POSITION
                       (|(SEQUENTIALLY (CONCURRENTLY %) %)| 0)
                       SOMETHING)
                      (METHOD-AT-POSITION
                       (|(SEQUENTIALLY (REPEAT ? FOREVER) %)| 0)
                       SOMETHING)
                      (METHOD-AT-POSITION
                       (|(SEQUENTIALLY (REPEAT ? ? TIMES) %)| 0)
                       SOMETHING)
                      (METHOD-AT-POSITION
                       (|(SEQUENTIALLY (DO AT SPEED ? ASK ? {or SET CHANGE} YOUR ? TO ?) %)|
                        0)
                       SOMETHING)
                      (METHOD-AT-POSITION
                       (|(SEQUENTIALLY (DO AT SPEED ? {or SET CHANGE} YOUR ? TO ?) %)|
                        0)
                       SOMETHING)
                      (METHOD-AT-POSITION
                       (|(SEQUENTIALLY (DO IN ? ? % ?) %)| 0)
                       SOMETHING)
                      (METHOD-AT-POSITION
                       (|(SEQUENTIALLY (DO AT SPEED ? % ?) %)| 0)
                       SOMETHING)
                      (METHOD-AT-POSITION
                       (|(SEQUENTIALLY (GRADUALLY ASK ? {or SET CHANGE} YOUR ? TO ?) %)|
                        0)
                       SOMETHING)
                      (METHOD-AT-POSITION
                       (|(SEQUENTIALLY (GRADUALLY {or SET CHANGE} YOUR ? TO ?) %)| 0)
                       SOMETHING)
                      (METHOD-AT-POSITION
                       (|(SEQUENTIALLY (GRADUALLY ASK ? % ?) %)| 0)
                       SOMETHING)
                      (METHOD-AT-POSITION
                       (|(SEQUENTIALLY (GRADUALLY % ?) %)| 0)
                       SOMETHING)
                      (METHOD-AT-POSITION
                       (|(SEQUENTIALLY (BROADCAST OR ASK YOUR ? %) %)| 0)
                       SOMETHING)
                      (METHOD-AT-POSITION
                       (|(SEQUENTIALLY (BROADCAST TO YOUR ? %) %)| 0)
                       SOMETHING)
                      (METHOD-AT-POSITION
                       (|(SEQUENTIALLY (ASK YOUR ? %) %)| 0)
                       SOMETHING)
                      (METHOD-AT-POSITION
                       (|(SEQUENTIALLY (ASK EACH OF YOUR ? %) %)| 0)
                       SOMETHING)
                      (METHOD-AT-POSITION
                       (|(SEQUENTIALLY (ASK EACH OF ? %) %)| 0)
                       SOMETHING)
                      (METHOD-AT-POSITION (|(SEQUENTIALLY (ASK ? %) %)| 0) SOMETHING)
                      (METHOD-AT-POSITION (|(SEQUENTIALLY %)| 0) SOMETHING))
                  '#,(ACTOR-OF (QUOTE SOMETHING))))))
             (LET
              ((*MESSAGE '(RECALL YOUR ,VARIABLE)))
              (COMPILED-ASK
               '#,(LIST
                   (METHOD-AT-POSITION ((RECALL YOUR SIBLINGS) 0) SOMETHING)
                   (METHOD-AT-POSITION ((RECALL YOUR DESCENDANTS) 0) SOMETHING)
                   (METHOD-AT-POSITION
                    ((RECALL YOUR CHILDLESS-DESCENDANTS) 0)
                    SOMETHING)
                   (METHOD-AT-POSITION ((RECALL YOUR PARENT) 0) SOMETHING)
                   (METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING))
               '#,(ACTOR-OF (QUOTE SOMETHING))))))
           (T
            (DIRECTOR-MAPCAR
             (FUNCTION
              (LAMBDA (ACTOR) (LET ((*MESSAGE '(!,MESSAGE))) (CASES (ACTOR-OF ACTOR)))))
             (LET
              ((*MESSAGE '(RECALL YOUR ,VARIABLE)))
              (COMPILED-ASK
               '#,(LIST
                   (METHOD-AT-POSITION ((RECALL YOUR SIBLINGS) 0) SOMETHING)
                   (METHOD-AT-POSITION ((RECALL YOUR DESCENDANTS) 0) SOMETHING)
                   (METHOD-AT-POSITION
                    ((RECALL YOUR CHILDLESS-DESCENDANTS) 0)
                    SOMETHING)
                   (METHOD-AT-POSITION ((RECALL YOUR PARENT) 0) SOMETHING)
                   (METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING))
               '#,(ACTOR-OF (QUOTE SOMETHING))))))))
   (CDDR *MESSAGE) (CDDDR (CDDADR *MESSAGE)) (CADDR (CDDADR *MESSAGE)))) 
(DEFUN |(SEQUENTIALLY (ASK EACH OF YOUR ? %) %)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE SEQUENTIALLY))
   (AND
    (LISTP (CADR OBJECT))
    (EQ (CAADR OBJECT) (QUOTE ASK))
    (AND
     (LISTP (CDADR OBJECT))
     (EQ (CADADR OBJECT) (QUOTE EACH))
     (AND
      (LISTP (CDDADR OBJECT))
      (EQ (CAR (CDDADR OBJECT)) (QUOTE OF))
      (AND
       (LISTP (CDR (CDDADR OBJECT)))
       (EQ (CADR (CDDADR OBJECT)) (QUOTE YOUR))
       (LISTP (CDDR (CDDADR OBJECT))))))))) 
(DEFPROP
 |(SEQUENTIALLY (ASK EACH OF YOUR ? %) %)|
 (SEQUENTIALLY (ASK EACH OF YOUR ? %) %)
 PATTERN) 
(DEFUN D0138 NIL
  ((LAMBDA (FOLLOWUP MESSAGE VARIABLE)
     (LET
      ((OTHER
        (LET
         ((*MESSAGE '(RECALL YOUR ,VARIABLE)))
         (COMPILED-ASK
          '#,(LIST
              (METHOD-AT-POSITION ((RECALL YOUR SIBLINGS) 0) SOMETHING)
              (METHOD-AT-POSITION ((RECALL YOUR DESCENDANTS) 0) SOMETHING)
              (METHOD-AT-POSITION ((RECALL YOUR CHILDLESS-DESCENDANTS) 0) SOMETHING)
              (METHOD-AT-POSITION ((RECALL YOUR PARENT) 0) SOMETHING)
              (METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING))
          '#,(ACTOR-OF (QUOTE SOMETHING))))))
      (COND (OTHER
             (COND (FOLLOWUP
                    (LET
                     ((MYSELF (ACTOR-OF OTHER))
                      (*MESSAGE '(SEQUENTIALLY ,MESSAGE !,FOLLOWUP)))
                     (COMPILED-ASK
                      '#,(LIST
                          (METHOD-AT-POSITION
                           (|(SEQUENTIALLY (PLAN NEXT %) %)| 0)
                           SOMETHING)
                          (METHOD-AT-POSITION
                           (|(SEQUENTIALLY (PLAN AFTER ? ? %) %)| 0)
                           SOMETHING)
                          (METHOD-AT-POSITION
                           (|(SEQUENTIALLY (CONCURRENTLY %) %)| 0)
                           SOMETHING)
                          (METHOD-AT-POSITION
                           (|(SEQUENTIALLY (REPEAT ? FOREVER) %)| 0)
                           SOMETHING)
                          (METHOD-AT-POSITION
                           (|(SEQUENTIALLY (REPEAT ? ? TIMES) %)| 0)
                           SOMETHING)
                          (METHOD-AT-POSITION
                           (
                            
|(SEQUENTIALLY (DO AT SPEED ? ASK ? {or SET CHANGE} YOUR ? TO ?) %)|
                            0)
                           SOMETHING)
                          (METHOD-AT-POSITION
                           (|(SEQUENTIALLY (DO AT SPEED ? {or SET CHANGE} YOUR ? TO ?) %)|
                            0)
                           SOMETHING)
                          (METHOD-AT-POSITION
                           (|(SEQUENTIALLY (DO IN ? ? % ?) %)| 0)
                           SOMETHING)
                          (METHOD-AT-POSITION
                           (|(SEQUENTIALLY (DO AT SPEED ? % ?) %)| 0)
                           SOMETHING)
                          (METHOD-AT-POSITION
                           (|(SEQUENTIALLY (GRADUALLY ASK ? {or SET CHANGE} YOUR ? TO ?) %)|
                            0)
                           SOMETHING)
                          (METHOD-AT-POSITION
                           (|(SEQUENTIALLY (GRADUALLY {or SET CHANGE} YOUR ? TO ?) %)|
                            0)
                           SOMETHING)
                          (METHOD-AT-POSITION
                           (|(SEQUENTIALLY (GRADUALLY ASK ? % ?) %)| 0)
                           SOMETHING)
                          (METHOD-AT-POSITION
                           (|(SEQUENTIALLY (GRADUALLY % ?) %)| 0)
                           SOMETHING)
                          (METHOD-AT-POSITION
                           (|(SEQUENTIALLY (BROADCAST OR ASK YOUR ? %) %)| 0)
                           SOMETHING)
                          (METHOD-AT-POSITION
                           (|(SEQUENTIALLY (BROADCAST TO YOUR ? %) %)| 0)
                           SOMETHING)
                          (METHOD-AT-POSITION
                           (|(SEQUENTIALLY (ASK YOUR ? %) %)| 0)
                           SOMETHING)
                          (METHOD-AT-POSITION
                           (|(SEQUENTIALLY (ASK EACH OF YOUR ? %) %)| 0)
                           SOMETHING)
                          (METHOD-AT-POSITION
                           (|(SEQUENTIALLY (ASK EACH OF ? %) %)| 0)
                           SOMETHING)
                          (METHOD-AT-POSITION
                           (|(SEQUENTIALLY (ASK ? %) %)| 0)
                           SOMETHING)
                          (METHOD-AT-POSITION (|(SEQUENTIALLY %)| 0) SOMETHING))
                      '#,(ACTOR-OF (QUOTE SOMETHING)))))
                   (T (LET ((*MESSAGE '(!,MESSAGE))) (CASES (ACTOR-OF OTHER))))))
            (T
             (SHOULDNT-HAPPEN MYSELF '(|I don't have any| ,VARIABLE |to ask| !,MESSAGE))))))
   (CDDR *MESSAGE) (CDR (CDDADR *MESSAGE)) (CAR (CDDADR *MESSAGE)))) 
(DEFUN |(SEQUENTIALLY (ASK YOUR ? %) %)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE SEQUENTIALLY))
   (AND
    (LISTP (CADR OBJECT))
    (EQ (CAADR OBJECT) (QUOTE ASK))
    (AND
     (LISTP (CDADR OBJECT))
     (EQ (CADADR OBJECT) (QUOTE YOUR))
     (LISTP (CDDADR OBJECT)))))) 
(DEFPROP |(SEQUENTIALLY (ASK YOUR ? %) %)| (SEQUENTIALLY (ASK YOUR ? %) %) PATTERN) 
(DEFUN D0137 NIL
  ((LAMBDA (FOLLOWUP MESSAGE OTHERS-NAME)
     (LET*
      ((OTHERS
        (LET
         ((*MESSAGE '(RECALL YOUR ,OTHERS-NAME)))
         (COMPILED-ASK
          '#,(LIST
              (METHOD-AT-POSITION ((RECALL YOUR SIBLINGS) 0) SOMETHING)
              (METHOD-AT-POSITION ((RECALL YOUR DESCENDANTS) 0) SOMETHING)
              (METHOD-AT-POSITION ((RECALL YOUR CHILDLESS-DESCENDANTS) 0) SOMETHING)
              (METHOD-AT-POSITION ((RECALL YOUR PARENT) 0) SOMETHING)
              (METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING))
          '#,(ACTOR-OF (QUOTE SOMETHING)))))
       (RESULT
        (COND (FOLLOWUP
               (LET
                ((*MESSAGE '(SEQUENTIALLY ,MESSAGE !,FOLLOWUP)))
                (COMPILED-ASK
                 '#,(LIST
                     (METHOD-AT-POSITION (|(SEQUENTIALLY (PLAN NEXT %) %)| 0) SOMETHING)
                     (METHOD-AT-POSITION
                      (|(SEQUENTIALLY (PLAN AFTER ? ? %) %)| 0)
                      SOMETHING)
                     (METHOD-AT-POSITION
                      (|(SEQUENTIALLY (CONCURRENTLY %) %)| 0)
                      SOMETHING)
                     (METHOD-AT-POSITION
                      (|(SEQUENTIALLY (REPEAT ? FOREVER) %)| 0)
                      SOMETHING)
                     (METHOD-AT-POSITION
                      (|(SEQUENTIALLY (REPEAT ? ? TIMES) %)| 0)
                      SOMETHING)
                     (METHOD-AT-POSITION
                      (|(SEQUENTIALLY (DO AT SPEED ? ASK ? {or SET CHANGE} YOUR ? TO ?) %)|
                       0)
                      SOMETHING)
                     (METHOD-AT-POSITION
                      (|(SEQUENTIALLY (DO AT SPEED ? {or SET CHANGE} YOUR ? TO ?) %)| 0)
                      SOMETHING)
                     (METHOD-AT-POSITION
                      (|(SEQUENTIALLY (DO IN ? ? % ?) %)| 0)
                      SOMETHING)
                     (METHOD-AT-POSITION
                      (|(SEQUENTIALLY (DO AT SPEED ? % ?) %)| 0)
                      SOMETHING)
                     (METHOD-AT-POSITION
                      (|(SEQUENTIALLY (GRADUALLY ASK ? {or SET CHANGE} YOUR ? TO ?) %)|
                       0)
                      SOMETHING)
                     (METHOD-AT-POSITION
                      (|(SEQUENTIALLY (GRADUALLY {or SET CHANGE} YOUR ? TO ?) %)| 0)
                      SOMETHING)
                     (METHOD-AT-POSITION
                      (|(SEQUENTIALLY (GRADUALLY ASK ? % ?) %)| 0)
                      SOMETHING)
                     (METHOD-AT-POSITION
                      (|(SEQUENTIALLY (GRADUALLY % ?) %)| 0)
                      SOMETHING)
                     (METHOD-AT-POSITION
                      (|(SEQUENTIALLY (BROADCAST OR ASK YOUR ? %) %)| 0)
                      SOMETHING)
                     (METHOD-AT-POSITION
                      (|(SEQUENTIALLY (BROADCAST TO YOUR ? %) %)| 0)
                      SOMETHING)
                     (METHOD-AT-POSITION
                      (|(SEQUENTIALLY (ASK YOUR ? %) %)| 0)
                      SOMETHING)
                     (METHOD-AT-POSITION
                      (|(SEQUENTIALLY (ASK EACH OF YOUR ? %) %)| 0)
                      SOMETHING)
                     (METHOD-AT-POSITION
                      (|(SEQUENTIALLY (ASK EACH OF ? %) %)| 0)
                      SOMETHING)
                     (METHOD-AT-POSITION (|(SEQUENTIALLY (ASK ? %) %)| 0) SOMETHING)
                     (METHOD-AT-POSITION (|(SEQUENTIALLY %)| 0) SOMETHING))
                 '#,(ACTOR-OF (QUOTE SOMETHING)))))
              (T (LET ((*MESSAGE '(!,MESSAGE))) (CASES MYSELF)))))
       (RESULTS-OF-OTHERS
        (DIRECTOR-MAPCAN
         (FUNCTION
          (LAMBDA (OTHER)
            (LET
             ((MYSELF (ACTOR-OF OTHER)) (*MESSAGE '(!,*MESSAGE)))
             (QUICK-COMPILED-ASK
              '#,(METHOD-AT-POSITION
                  (|(SEQUENTIALLY (BROADCAST TO YOUR ? %) %)| 0)
                  SOMETHING)
              '#,(ACTOR-OF (QUOTE SOMETHING))))))
         OTHERS)))
      (COND ((EQ RESULTS-OF-OTHERS NO-VALUE) (LIST RESULT))
            ((AND RESULT (NOT (EQ RESULT NO-VALUE))) (CONS RESULT RESULTS-OF-OTHERS))
            (T RESULTS-OF-OTHERS))))
   (CDDR *MESSAGE) (CDDR (CDDADR *MESSAGE)) (CADR (CDDADR *MESSAGE)))) 
(DEFUN |(SEQUENTIALLY (BROADCAST TO YOUR ? %) %)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE SEQUENTIALLY))
   (AND
    (LISTP (CADR OBJECT))
    (EQ (CAADR OBJECT) (QUOTE BROADCAST))
    (AND
     (LISTP (CDADR OBJECT))
     (EQ (CADADR OBJECT) (QUOTE TO))
     (AND
      (LISTP (CDDADR OBJECT))
      (EQ (CAR (CDDADR OBJECT)) (QUOTE YOUR))
      (LISTP (CDR (CDDADR OBJECT)))))))) 
(DEFPROP
 |(SEQUENTIALLY (BROADCAST TO YOUR ? %) %)|
 (SEQUENTIALLY (BROADCAST TO YOUR ? %) %)
 PATTERN) 
(DEFUN D0136 NIL
  ((LAMBDA (FOLLOWUP MESSAGE OTHERS-NAME)
     (LET
      ((OTHERS
        (LET
         ((*MESSAGE '(RECALL YOUR ,OTHERS-NAME)))
         (COMPILED-ASK
          '#,(LIST
              (METHOD-AT-POSITION ((RECALL YOUR SIBLINGS) 0) SOMETHING)
              (METHOD-AT-POSITION ((RECALL YOUR DESCENDANTS) 0) SOMETHING)
              (METHOD-AT-POSITION ((RECALL YOUR CHILDLESS-DESCENDANTS) 0) SOMETHING)
              (METHOD-AT-POSITION ((RECALL YOUR PARENT) 0) SOMETHING)
              (METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING))
          '#,(ACTOR-OF (QUOTE SOMETHING))))))
      (COND (OTHERS
             (DIRECTOR-MAPCAN
              (FUNCTION
               (LAMBDA (OTHER)
                 (LET
                  ((MYSELF (ACTOR-OF OTHER)) (*MESSAGE '(!,*MESSAGE)))
                  (QUICK-COMPILED-ASK
                   '#,(METHOD-AT-POSITION
                       (|(SEQUENTIALLY (BROADCAST OR ASK YOUR ? %) %)| 0)
                       SOMETHING)
                   '#,(ACTOR-OF (QUOTE SOMETHING))))))
              OTHERS))
            (T
             (LET
              ((RESULT
                (COND (FOLLOWUP
                       (LET
                        ((*MESSAGE '(SEQUENTIALLY ,MESSAGE !,FOLLOWUP)))
                        (COMPILED-ASK
                         '#,(LIST
                             (METHOD-AT-POSITION
                              (|(SEQUENTIALLY (PLAN NEXT %) %)| 0)
                              SOMETHING)
                             (METHOD-AT-POSITION
                              (|(SEQUENTIALLY (PLAN AFTER ? ? %) %)| 0)
                              SOMETHING)
                             (METHOD-AT-POSITION
                              (|(SEQUENTIALLY (CONCURRENTLY %) %)| 0)
                              SOMETHING)
                             (METHOD-AT-POSITION
                              (|(SEQUENTIALLY (REPEAT ? FOREVER) %)| 0)
                              SOMETHING)
                             (METHOD-AT-POSITION
                              (|(SEQUENTIALLY (REPEAT ? ? TIMES) %)| 0)
                              SOMETHING)
                             (METHOD-AT-POSITION
                              (
                               
|(SEQUENTIALLY (DO AT SPEED ? ASK ? {or SET CHANGE} YOUR ? TO ?) %)|
                               0)
                              SOMETHING)
                             (METHOD-AT-POSITION
                              (
                               |(SEQUENTIALLY (DO AT SPEED ? {or SET CHANGE} YOUR ? TO ?) %)|
                               0)
                              SOMETHING)
                             (METHOD-AT-POSITION
                              (|(SEQUENTIALLY (DO IN ? ? % ?) %)| 0)
                              SOMETHING)
                             (METHOD-AT-POSITION
                              (|(SEQUENTIALLY (DO AT SPEED ? % ?) %)| 0)
                              SOMETHING)
                             (METHOD-AT-POSITION
                              (
                               
|(SEQUENTIALLY (GRADUALLY ASK ? {or SET CHANGE} YOUR ? TO ?) %)|
                               0)
                              SOMETHING)
                             (METHOD-AT-POSITION
                              (|(SEQUENTIALLY (GRADUALLY {or SET CHANGE} YOUR ? TO ?) %)|
                               0)
                              SOMETHING)
                             (METHOD-AT-POSITION
                              (|(SEQUENTIALLY (GRADUALLY ASK ? % ?) %)| 0)
                              SOMETHING)
                             (METHOD-AT-POSITION
                              (|(SEQUENTIALLY (GRADUALLY % ?) %)| 0)
                              SOMETHING)
                             (METHOD-AT-POSITION
                              (|(SEQUENTIALLY (BROADCAST OR ASK YOUR ? %) %)| 0)
                              SOMETHING)
                             (METHOD-AT-POSITION
                              (|(SEQUENTIALLY (BROADCAST TO YOUR ? %) %)| 0)
                              SOMETHING)
                             (METHOD-AT-POSITION
                              (|(SEQUENTIALLY (ASK YOUR ? %) %)| 0)
                              SOMETHING)
                             (METHOD-AT-POSITION
                              (|(SEQUENTIALLY (ASK EACH OF YOUR ? %) %)| 0)
                              SOMETHING)
                             (METHOD-AT-POSITION
                              (|(SEQUENTIALLY (ASK EACH OF ? %) %)| 0)
                              SOMETHING)
                             (METHOD-AT-POSITION
                              (|(SEQUENTIALLY (ASK ? %) %)| 0)
                              SOMETHING)
                             (METHOD-AT-POSITION (|(SEQUENTIALLY %)| 0) SOMETHING))
                         '#,(ACTOR-OF (QUOTE SOMETHING)))))
                      (T (LET ((*MESSAGE '(!,MESSAGE))) (CASES MYSELF))))))
              (COND (RESULT (LIST RESULT))))))))
   (CDDR *MESSAGE) (CDDDR (CDDADR *MESSAGE)) (CADDR (CDDADR *MESSAGE)))) 
(DEFUN |(SEQUENTIALLY (BROADCAST OR ASK YOUR ? %) %)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE SEQUENTIALLY))
   (AND
    (LISTP (CADR OBJECT))
    (EQ (CAADR OBJECT) (QUOTE BROADCAST))
    (AND
     (LISTP (CDADR OBJECT))
     (EQ (CADADR OBJECT) (QUOTE OR))
     (AND
      (LISTP (CDDADR OBJECT))
      (EQ (CAR (CDDADR OBJECT)) (QUOTE ASK))
      (AND
       (LISTP (CDR (CDDADR OBJECT)))
       (EQ (CADR (CDDADR OBJECT)) (QUOTE YOUR))
       (LISTP (CDDR (CDDADR OBJECT))))))))) 
(DEFPROP
 |(SEQUENTIALLY (BROADCAST OR ASK YOUR ? %) %)|
 (SEQUENTIALLY (BROADCAST OR ASK YOUR ? %) %)
 PATTERN) 
(DEFUN D0135 NIL
  ((LAMBDA (FOLLOWUP ACTION AMOUNT) (DO-GRADUALLY MYSELF MYSELF ACTION AMOUNT FOLLOWUP))
   (CDDR *MESSAGE) (NREVERSE (CDR (REVERSE (CDADR *MESSAGE))))
   (LAST-ELEMENT (CDADR *MESSAGE)))) 
(DEFUN |(SEQUENTIALLY (GRADUALLY % ?) %)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE SEQUENTIALLY))
   (AND
    (LISTP (CADR OBJECT))
    (EQ (CAADR OBJECT) (QUOTE GRADUALLY))
    (AND
     (LISTP (CDADR OBJECT))
     (LET ((REVERSED-OBJECT (REVERSE (CDADR OBJECT)))) (LISTP REVERSED-OBJECT)))))) 
(DEFPROP |(SEQUENTIALLY (GRADUALLY % ?) %)| (SEQUENTIALLY (GRADUALLY % ?) %) PATTERN) 
(DEFUN D0134 NIL
  ((LAMBDA (FOLLOWUP ACTION AMOUNT OTHER)
     (DO-GRADUALLY MYSELF OTHER ACTION AMOUNT FOLLOWUP))
   (CDDR *MESSAGE) (NREVERSE (CDR (REVERSE (CDR (CDDADR *MESSAGE)))))
   (LAST-ELEMENT (CDR (CDDADR *MESSAGE))) (CAR (CDDADR *MESSAGE)))) 
(DEFUN |(SEQUENTIALLY (GRADUALLY ASK ? % ?) %)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE SEQUENTIALLY))
   (AND
    (LISTP (CADR OBJECT))
    (EQ (CAADR OBJECT) (QUOTE GRADUALLY))
    (AND
     (LISTP (CDADR OBJECT))
     (EQ (CADADR OBJECT) (QUOTE ASK))
     (AND
      (LISTP (CDDADR OBJECT))
      (AND
       (LISTP (CDR (CDDADR OBJECT)))
       (LET ((REVERSED-OBJECT (REVERSE (CDR (CDDADR OBJECT))))) (LISTP REVERSED-OBJECT)))))))
  ) 
(DEFPROP
 |(SEQUENTIALLY (GRADUALLY ASK ? % ?) %)|
 (SEQUENTIALLY (GRADUALLY ASK ? % ?) %)
 PATTERN) 
(DEFUN D0133 NIL
  ((LAMBDA (FOLLOWUP VALUE VARIABLE)
     (SET-GRADUALLY MYSELF MYSELF VARIABLE VALUE NIL FOLLOWUP *MESSAGE))
   (CDDR *MESSAGE) (CADDDR (CDDADR *MESSAGE)) (CADR (CDDADR *MESSAGE)))) 
(DEFUN |(SEQUENTIALLY (GRADUALLY {or SET CHANGE} YOUR ? TO ?) %)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE SEQUENTIALLY))
   (AND
    (LISTP (CADR OBJECT))
    (EQ (CAADR OBJECT) (QUOTE GRADUALLY))
    (AND
     (LISTP (CDADR OBJECT))
     (MEMQ (CADADR OBJECT) (QUOTE (SET CHANGE)))
     (AND
      (LISTP (CDDADR OBJECT))
      (EQ (CAR (CDDADR OBJECT)) (QUOTE YOUR))
      (AND
       (LISTP (CDR (CDDADR OBJECT)))
       (AND
        (LISTP (CDDR (CDDADR OBJECT)))
        (EQ (CADDR (CDDADR OBJECT)) (QUOTE TO))
        (ONE-LONG (CDDDR (CDDADR OBJECT)))))))))) 
(DEFPROP
 |(SEQUENTIALLY (GRADUALLY {or SET CHANGE} YOUR ? TO ?) %)|
 (SEQUENTIALLY (GRADUALLY {or SET CHANGE} YOUR ? TO ?) %)
 PATTERN) 
(DEFUN D0132 NIL
  ((LAMBDA (FOLLOWUP VALUE VARIABLE OTHER)
     (SET-GRADUALLY MYSELF OTHER VARIABLE VALUE NIL FOLLOWUP *MESSAGE))
   (CDDR *MESSAGE) (CADR (CDDDDR (CDDADR *MESSAGE))) (CADDDR (CDDADR *MESSAGE))
   (CAR (CDDADR *MESSAGE)))) 
(DEFUN |(SEQUENTIALLY (GRADUALLY ASK ? {or SET CHANGE} YOUR ? TO ?) %)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE SEQUENTIALLY))
   (AND
    (LISTP (CADR OBJECT))
    (EQ (CAADR OBJECT) (QUOTE GRADUALLY))
    (AND
     (LISTP (CDADR OBJECT))
     (EQ (CADADR OBJECT) (QUOTE ASK))
     (AND
      (LISTP (CDDADR OBJECT))
      (AND
       (LISTP (CDR (CDDADR OBJECT)))
       (MEMQ (CADR (CDDADR OBJECT)) (QUOTE (SET CHANGE)))
       (AND
        (LISTP (CDDR (CDDADR OBJECT)))
        (EQ (CADDR (CDDADR OBJECT)) (QUOTE YOUR))
        (AND
         (LISTP (CDDDR (CDDADR OBJECT)))
         (AND
          (LISTP (CDDDDR (CDDADR OBJECT)))
          (EQ (CAR (CDDDDR (CDDADR OBJECT))) (QUOTE TO))
          (ONE-LONG (CDR (CDDDDR (CDDADR OBJECT))))))))))))) 
(DEFPROP
 |(SEQUENTIALLY (GRADUALLY ASK ? {or SET CHANGE} YOUR ? TO ?) %)|
 (SEQUENTIALLY (GRADUALLY ASK ? {or SET CHANGE} YOUR ? TO ?) %)
 PATTERN) 
(DEFUN D0131 NIL
  ((LAMBDA (FOLLOWUP ACTION AMOUNT SPEED)
     (DO-AT-SPEED (TIMES SPEED (NUMBER-OF-TICKS 1.0 'SECOND)) ACTION AMOUNT FOLLOWUP))
   (CDDR *MESSAGE) (NREVERSE (CDR (REVERSE (CDDR (CDDADR *MESSAGE)))))
   (LAST-ELEMENT (CDDR (CDDADR *MESSAGE))) (CADR (CDDADR *MESSAGE)))) 
(DEFUN |(SEQUENTIALLY (DO AT SPEED ? % ?) %)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE SEQUENTIALLY))
   (AND
    (LISTP (CADR OBJECT))
    (EQ (CAADR OBJECT) (QUOTE DO))
    (AND
     (LISTP (CDADR OBJECT))
     (EQ (CADADR OBJECT) (QUOTE AT))
     (AND
      (LISTP (CDDADR OBJECT))
      (EQ (CAR (CDDADR OBJECT)) (QUOTE SPEED))
      (AND
       (LISTP (CDR (CDDADR OBJECT)))
       (AND
        (LISTP (CDDR (CDDADR OBJECT)))
        (LET
         ((REVERSED-OBJECT (REVERSE (CDDR (CDDADR OBJECT)))))
         (LISTP REVERSED-OBJECT))))))))) 
(DEFPROP
 |(SEQUENTIALLY (DO AT SPEED ? % ?) %)|
 (SEQUENTIALLY (DO AT SPEED ? % ?) %)
 PATTERN) 
(DEFUN D0130 NIL
  ((LAMBDA (FOLLOWUP ACTION AMOUNT UNITS NUMBER)
     (DO-AT-SPEED
      (QUOTIENT (FLOAT AMOUNT) (NUMBER-OF-TICKS NUMBER UNITS))
      ACTION
      AMOUNT
      FOLLOWUP))
   (CDDR *MESSAGE) (NREVERSE (CDR (REVERSE (CDDR (CDDADR *MESSAGE)))))
   (LAST-ELEMENT (CDDR (CDDADR *MESSAGE))) (CADR (CDDADR *MESSAGE))
   (CAR (CDDADR *MESSAGE)))) 
(DEFUN |(SEQUENTIALLY (DO IN ? ? % ?) %)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE SEQUENTIALLY))
   (AND
    (LISTP (CADR OBJECT))
    (EQ (CAADR OBJECT) (QUOTE DO))
    (AND
     (LISTP (CDADR OBJECT))
     (EQ (CADADR OBJECT) (QUOTE IN))
     (AND
      (LISTP (CDDADR OBJECT))
      (AND
       (LISTP (CDR (CDDADR OBJECT)))
       (AND
        (LISTP (CDDR (CDDADR OBJECT)))
        (LET
         ((REVERSED-OBJECT (REVERSE (CDDR (CDDADR OBJECT)))))
         (LISTP REVERSED-OBJECT))))))))) 
(DEFPROP |(SEQUENTIALLY (DO IN ? ? % ?) %)| (SEQUENTIALLY (DO IN ? ? % ?) %) PATTERN) 
(DEFUN D0129 NIL
  ((LAMBDA (FOLLOWUP VALUE VARIABLE SPEED)
     (SET-GRADUALLY MYSELF MYSELF VARIABLE VALUE SPEED FOLLOWUP *MESSAGE))
   (CDDR *MESSAGE) (CADDR (CDDDDR (CDDADR *MESSAGE))) (CAR (CDDDDR (CDDADR *MESSAGE)))
   (CADR (CDDADR *MESSAGE)))) 
(DEFUN |(SEQUENTIALLY (DO AT SPEED ? {or SET CHANGE} YOUR ? TO ?) %)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE SEQUENTIALLY))
   (AND
    (LISTP (CADR OBJECT))
    (EQ (CAADR OBJECT) (QUOTE DO))
    (AND
     (LISTP (CDADR OBJECT))
     (EQ (CADADR OBJECT) (QUOTE AT))
     (AND
      (LISTP (CDDADR OBJECT))
      (EQ (CAR (CDDADR OBJECT)) (QUOTE SPEED))
      (AND
       (LISTP (CDR (CDDADR OBJECT)))
       (AND
        (LISTP (CDDR (CDDADR OBJECT)))
        (MEMQ (CADDR (CDDADR OBJECT)) (QUOTE (SET CHANGE)))
        (AND
         (LISTP (CDDDR (CDDADR OBJECT)))
         (EQ (CADDDR (CDDADR OBJECT)) (QUOTE YOUR))
         (AND
          (LISTP (CDDDDR (CDDADR OBJECT)))
          (AND
           (LISTP (CDR (CDDDDR (CDDADR OBJECT))))
           (EQ (CADR (CDDDDR (CDDADR OBJECT))) (QUOTE TO))
           (ONE-LONG (CDDR (CDDDDR (CDDADR OBJECT)))))))))))))) 
(DEFPROP
 |(SEQUENTIALLY (DO AT SPEED ? {or SET CHANGE} YOUR ? TO ?) %)|
 (SEQUENTIALLY (DO AT SPEED ? {or SET CHANGE} YOUR ? TO ?) %)
 PATTERN) 
(DEFUN D0128 NIL
  ((LAMBDA (FOLLOWUP VALUE VARIABLE OTHER SPEED)
     (SET-GRADUALLY MYSELF OTHER VARIABLE VALUE SPEED FOLLOWUP *MESSAGE))
   (CDDR *MESSAGE) (CAR (CDDDDR (CDDDDR (CDDADR *MESSAGE))))
   (CADDR (CDDDDR (CDDADR *MESSAGE))) (CADDDR (CDDADR *MESSAGE)) (CADR (CDDADR *MESSAGE)))) 
(DEFUN |(SEQUENTIALLY (DO AT SPEED ? ASK ? {or SET CHANGE} YOUR ? TO ?) %)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE SEQUENTIALLY))
   (AND
    (LISTP (CADR OBJECT))
    (EQ (CAADR OBJECT) (QUOTE DO))
    (AND
     (LISTP (CDADR OBJECT))
     (EQ (CADADR OBJECT) (QUOTE AT))
     (AND
      (LISTP (CDDADR OBJECT))
      (EQ (CAR (CDDADR OBJECT)) (QUOTE SPEED))
      (AND
       (LISTP (CDR (CDDADR OBJECT)))
       (AND
        (LISTP (CDDR (CDDADR OBJECT)))
        (EQ (CADDR (CDDADR OBJECT)) (QUOTE ASK))
        (AND
         (LISTP (CDDDR (CDDADR OBJECT)))
         (AND
          (LISTP (CDDDDR (CDDADR OBJECT)))
          (MEMQ (CAR (CDDDDR (CDDADR OBJECT))) (QUOTE (SET CHANGE)))
          (AND
           (LISTP (CDR (CDDDDR (CDDADR OBJECT))))
           (EQ (CADR (CDDDDR (CDDADR OBJECT))) (QUOTE YOUR))
           (AND
            (LISTP (CDDR (CDDDDR (CDDADR OBJECT))))
            (AND
             (LISTP (CDDDR (CDDDDR (CDDADR OBJECT))))
             (EQ (CADDDR (CDDDDR (CDDADR OBJECT))) (QUOTE TO))
             (ONE-LONG (CDDDDR (CDDDDR (CDDADR OBJECT)))))))))))))))) 
(DEFPROP
 |(SEQUENTIALLY (DO AT SPEED ? ASK ? {or SET CHANGE} YOUR ? TO ?) %)|
 (SEQUENTIALLY (DO AT SPEED ? ASK ? {or SET CHANGE} YOUR ? TO ?) %)
 PATTERN) 
(DEFUN D0127 NIL
  ((LAMBDA (FOLLOWUP NUMBER MESSAGE)
     (LET
      ((NUMBER (FIX NUMBER)))
      (COND ((> NUMBER 0)
             (LET
              ((*MESSAGE
                '(SEQUENTIALLY
                  ,MESSAGE
                  (PLAN NEXT REPEAT ,MESSAGE ,(1- NUMBER) TIMES)
                  !,FOLLOWUP)))
              (COMPILED-ASK
               '#,(LIST
                   (METHOD-AT-POSITION (|(SEQUENTIALLY (PLAN NEXT %) %)| 0) SOMETHING)
                   (METHOD-AT-POSITION
                    (|(SEQUENTIALLY (PLAN AFTER ? ? %) %)| 0)
                    SOMETHING)
                   (METHOD-AT-POSITION
                    (|(SEQUENTIALLY (CONCURRENTLY %) %)| 0)
                    SOMETHING)
                   (METHOD-AT-POSITION
                    (|(SEQUENTIALLY (REPEAT ? FOREVER) %)| 0)
                    SOMETHING)
                   (METHOD-AT-POSITION
                    (|(SEQUENTIALLY (REPEAT ? ? TIMES) %)| 0)
                    SOMETHING)
                   (METHOD-AT-POSITION
                    (|(SEQUENTIALLY (DO AT SPEED ? ASK ? {or SET CHANGE} YOUR ? TO ?) %)|
                     0)
                    SOMETHING)
                   (METHOD-AT-POSITION
                    (|(SEQUENTIALLY (DO AT SPEED ? {or SET CHANGE} YOUR ? TO ?) %)| 0)
                    SOMETHING)
                   (METHOD-AT-POSITION (|(SEQUENTIALLY (DO IN ? ? % ?) %)| 0) SOMETHING)
                   (METHOD-AT-POSITION
                    (|(SEQUENTIALLY (DO AT SPEED ? % ?) %)| 0)
                    SOMETHING)
                   (METHOD-AT-POSITION
                    (|(SEQUENTIALLY (GRADUALLY ASK ? {or SET CHANGE} YOUR ? TO ?) %)| 0)
                    SOMETHING)
                   (METHOD-AT-POSITION
                    (|(SEQUENTIALLY (GRADUALLY {or SET CHANGE} YOUR ? TO ?) %)| 0)
                    SOMETHING)
                   (METHOD-AT-POSITION
                    (|(SEQUENTIALLY (GRADUALLY ASK ? % ?) %)| 0)
                    SOMETHING)
                   (METHOD-AT-POSITION (|(SEQUENTIALLY (GRADUALLY % ?) %)| 0) SOMETHING)
                   (METHOD-AT-POSITION
                    (|(SEQUENTIALLY (BROADCAST OR ASK YOUR ? %) %)| 0)
                    SOMETHING)
                   (METHOD-AT-POSITION
                    (|(SEQUENTIALLY (BROADCAST TO YOUR ? %) %)| 0)
                    SOMETHING)
                   (METHOD-AT-POSITION (|(SEQUENTIALLY (ASK YOUR ? %) %)| 0) SOMETHING)
                   (METHOD-AT-POSITION
                    (|(SEQUENTIALLY (ASK EACH OF YOUR ? %) %)| 0)
                    SOMETHING)
                   (METHOD-AT-POSITION
                    (|(SEQUENTIALLY (ASK EACH OF ? %) %)| 0)
                    SOMETHING)
                   (METHOD-AT-POSITION (|(SEQUENTIALLY (ASK ? %) %)| 0) SOMETHING)
                   (METHOD-AT-POSITION (|(SEQUENTIALLY %)| 0) SOMETHING))
               '#,(ACTOR-OF (QUOTE SOMETHING))))))))
   (CDDR *MESSAGE) (CAR (CDDADR *MESSAGE)) (CADADR *MESSAGE))) 
(DEFUN |(SEQUENTIALLY (REPEAT ? ? TIMES) %)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE SEQUENTIALLY))
   (AND
    (LISTP (CADR OBJECT))
    (EQ (CAADR OBJECT) (QUOTE REPEAT))
    (AND
     (LISTP (CDADR OBJECT))
     (AND (LISTP (CDDADR OBJECT)) (EQUAL (CDR (CDDADR OBJECT)) (QUOTE (TIMES)))))))) 
(DEFPROP
 |(SEQUENTIALLY (REPEAT ? ? TIMES) %)|
 (SEQUENTIALLY (REPEAT ? ? TIMES) %)
 PATTERN) 
(DEFPROP
 |MACRO-(SEQUENTIALLY (REPEAT ?MESSAGE FOREVER) %FOLLOWUP)SOMETHING|
 T
 MACRO-DEFINITION-FORM) 
(DEFINE-MACRO
 (|MACRO-(SEQUENTIALLY (REPEAT ?MESSAGE FOREVER) %FOLLOWUP)SOMETHING|
  MYSELF
  MESSAGE-FORM)
 ((LAMBDA (FOLLOWUP MESSAGE)
    '(ASK ,MYSELF SEQUENTIALLY ,MESSAGE (PLAN NEXT REPEAT ,MESSAGE FOREVER) !,FOLLOWUP))
  (CDDR MESSAGE-FORM) (CADADR MESSAGE-FORM))) 
(DEFUN |(SEQUENTIALLY (REPEAT ? FOREVER) %)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE SEQUENTIALLY))
   (AND
    (LISTP (CADR OBJECT))
    (EQ (CAADR OBJECT) (QUOTE REPEAT))
    (AND (LISTP (CDADR OBJECT)) (EQUAL (CDDADR OBJECT) (QUOTE (FOREVER))))))) 
(DEFPROP
 |(SEQUENTIALLY (REPEAT ? FOREVER) %)|
 (SEQUENTIALLY (REPEAT ? FOREVER) %)
 PATTERN) 
(DEFUN D0126 NIL
  ((LAMBDA (MESSAGES) (BODY-OF-DO-THE-FOLLOWING MESSAGES)) (CDDDR *MESSAGE))) 
(DEFUN |(DO THE FOLLOWING %)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE DO))
   (AND (EQ (CADR OBJECT) (QUOTE THE)) (EQ (CADDR OBJECT) (QUOTE FOLLOWING))))) 
(DEFPROP |(DO THE FOLLOWING %)| (DO THE FOLLOWING %) PATTERN) 
(DEFUN D0125 NIL
  ((LAMBDA (MESSAGES) (BODY-OF-DO-THE-FOLLOWING MESSAGES)) (CDR *MESSAGE))) 
(DEFUN |(CONCURRENTLY %)| (OBJECT) (EQ (CAR OBJECT) (QUOTE CONCURRENTLY))) 
(DEFPROP |(CONCURRENTLY %)| (CONCURRENTLY %) PATTERN) 
(DEFPROP
 |MACRO-(SEQUENTIALLY (CONCURRENTLY %ACTIONS) %FOLLOWUP)SOMETHING|
 T
 MACRO-DEFINITION-FORM) 
(DEFINE-MACRO
 (|MACRO-(SEQUENTIALLY (CONCURRENTLY %ACTIONS) %FOLLOWUP)SOMETHING| MYSELF MESSAGE-FORM)
 ((LAMBDA (FOLLOWUP ACTIONS)
    (LET
     ((ACTIVITY-NAME (GENERATE-SYMBOL 'ACTIVITY)))
     '(ASK
       ,MYSELF
       CONCURRENTLY
       (SET YOUR ,ACTIVITY-NAME TO ,ACTIONS)
       (DO
        ONCE
        WHEN
        RECEIVING
        (SET YOUR ,ACTIVITY-NAME TO NIL)
        (ASK MYSELF FORGET YOUR ,ACTIVITY-NAME)
        (ASK MYSELF SEQUENTIALLY !,FOLLOWUP))
       !,(MAPCAR
          (FUNCTION
           (LAMBDA (ACTION)
             '(SEQUENTIALLY
               ,ACTION
               (ASK ,MYSELF REMOVE ,ACTION FROM YOUR LIST OF ,ACTIVITY-NAME))))
          ACTIONS))))
  (CDDR MESSAGE-FORM) (CDADR MESSAGE-FORM))) 
(DEFUN |(SEQUENTIALLY (CONCURRENTLY %) %)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE SEQUENTIALLY))
   (AND (LISTP (CADR OBJECT)) (EQ (CAADR OBJECT) (QUOTE CONCURRENTLY))))) 
(DEFPROP |(SEQUENTIALLY (CONCURRENTLY %) %)| (SEQUENTIALLY (CONCURRENTLY %) %) PATTERN) 
(DEFUN D0124 NIL
  ((LAMBDA (SIGNAL)
     (LET
      ((*MESSAGE
        '(DO
          ONCE
          WHEN
          RECEIVING
          (TICK)
          (ASK
           MYSELF
           DO
           ONCE
           WHEN
           RECEIVING
           ,SIGNAL
           (ASK-OLD-IF-UNDERSTOOD MYSELF !,SIGNAL)
           (ASK MYSELF CONCURRENTLY !,(ASK MYSELF RECALL YOUR THINGS-TO-DO-NEXT)))
          (ASK MYSELF FORGET YOUR THINGS-TO-DO-NEXT))))
      (QUICK-COMPILED-ASK
       '#,(METHOD-AT-POSITION (|(DO ONCE WHEN RECEIVING ? %)| 0) SOMETHING)
       '#,(ACTOR-OF (QUOTE SOMETHING)))))
   (CDDR *MESSAGE))) 
(DEFUN |(WAIT FOR %)| (OBJECT)
  (AND (EQ (CAR OBJECT) (QUOTE WAIT)) (EQ (CADR OBJECT) (QUOTE FOR)))) 
(DEFPROP |(WAIT FOR %)| (WAIT FOR %) PATTERN) 
(DEFUN D0123 NIL
  (LET
   ((*MESSAGE
     '(DO ONCE WHEN RECEIVING (TICK) (ASK MYSELF FORGET YOUR THINGS-TO-DO-NEXT))))
   (QUICK-COMPILED-ASK
    '#,(METHOD-AT-POSITION (|(DO ONCE WHEN RECEIVING ? %)| 0) SOMETHING)
    '#,(ACTOR-OF (QUOTE SOMETHING))))) 
(DEFUN D0121 NIL
  ((LAMBDA (FOLLOWUP MESSAGE UNITS NUMBER)
     (LET*
      ((MESSAGE (MESSAGE-WITH-FOLLOWUP MESSAGE FOLLOWUP))
       (NUMBER (NUMBER-OF-TICKS NUMBER UNITS))
       (WHATS-PLANNED-ALREADY
        (LET
         ((*MESSAGE '(RECALL YOUR THINGS-TO-DO-NEXT)))
         (QUICK-COMPILED-ASK
          '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
          '#,(ACTOR-OF (QUOTE SOMETHING)))))
       (LIST-OF-NEW-COMMAND
        (COND ((< NUMBER 1) NIL)
              ((= NUMBER 1) (LIST MESSAGE))
              (T '((PLAN AFTER ,(1- NUMBER) TICKS !,MESSAGE))))))
      (COND (WHATS-PLANNED-ALREADY (NCONC WHATS-PLANNED-ALREADY LIST-OF-NEW-COMMAND))
            (T
             (LET
              ((*MESSAGE '(SET YOUR THINGS-TO-DO-NEXT TO ,LIST-OF-NEW-COMMAND)))
              (QUICK-COMPILED-ASK
               '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
               '#,(ACTOR-OF (QUOTE SOMETHING))))
             (LET
              ((CLOCK
                (ACTOR-OF
                 (LET
                  ((*MESSAGE '(RECALL YOUR CLOCK)))
                  (QUICK-COMPILED-ASK
                   '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
                   '#,(ACTOR-OF (QUOTE SOMETHING)))))))
              (COND ((AND (NOT (ACTOR-EQ MYSELF CLOCK)) LIST-OF-NEW-COMMAND)
                     (LET
                      ((MYSELF (ACTOR-OF CLOCK))
                       (*MESSAGE
                        '(SET
                          YOUR
                          ACTORS-TO-RUN-NEXT
                          TO
                          ,(CONS-IF-NOT-MEMBER
                            (QUOTE-IF-NEED-BE ,MYSELF)
                            (ASK ,CLOCK RECALL YOUR ACTORS-TO-RUN-NEXT)))))
                      (QUICK-COMPILED-ASK
                       '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
                       '#,(ACTOR-OF (QUOTE SOMETHING))))))))))
     NO-VALUE)
   (CDDR *MESSAGE) (CDDR (CDDADR *MESSAGE)) (CADR (CDDADR *MESSAGE))
   (CAR (CDDADR *MESSAGE)))) 
(DEFUN |(SEQUENTIALLY (PLAN AFTER ? ? %) %)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE SEQUENTIALLY))
   (AND
    (LISTP (CADR OBJECT))
    (EQ (CAADR OBJECT) (QUOTE PLAN))
    (AND
     (LISTP (CDADR OBJECT))
     (EQ (CADADR OBJECT) (QUOTE AFTER))
     (AND (LISTP (CDDADR OBJECT)) (LISTP (CDR (CDDADR OBJECT)))))))) 
(DEFPROP
 |(SEQUENTIALLY (PLAN AFTER ? ? %) %)|
 (SEQUENTIALLY (PLAN AFTER ? ? %) %)
 PATTERN) 
(DEFPROP
 |MACRO-(SEQUENTIALLY (PLAN NEXT %MESSAGE) %FOLLOWUP)SOMETHING|
 T
 MACRO-DEFINITION-FORM) 
(DEFINE-MACRO
 (|MACRO-(SEQUENTIALLY (PLAN NEXT %MESSAGE) %FOLLOWUP)SOMETHING| MYSELF MESSAGE-FORM)
 ((LAMBDA (FOLLOWUP MESSAGE)
    '(ASK ,MYSELF PLAN AFTER 1 TICKS SEQUENTIALLY ,MESSAGE !,FOLLOWUP))
  (CDDR MESSAGE-FORM) (CDDADR MESSAGE-FORM))) 
(DEFUN |(SEQUENTIALLY (PLAN NEXT %) %)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE SEQUENTIALLY))
   (AND
    (LISTP (CADR OBJECT))
    (EQ (CAADR OBJECT) (QUOTE PLAN))
    (AND (LISTP (CDADR OBJECT)) (EQ (CADADR OBJECT) (QUOTE NEXT)))))) 
(DEFPROP |(SEQUENTIALLY (PLAN NEXT %) %)| (SEQUENTIALLY (PLAN NEXT %) %) PATTERN) 
(DEFPROP
 |MACRO-({MEMQ ?ACTION '(PLAN GRADUALLY REPEAT ASK BROADCAST)} %REST)SOMETHING|
 T
 MACRO-DEFINITION-FORM) 
(DEFINE-MACRO
 (|MACRO-({MEMQ ?ACTION '(PLAN GRADUALLY REPEAT ASK BROADCAST)} %REST)SOMETHING|
  MYSELF
  MESSAGE-FORM)
 ((LAMBDA (REST ACTION) '(ASK ,MYSELF SEQUENTIALLY (,ACTION !,REST))) (CDR MESSAGE-FORM)
  (CAR MESSAGE-FORM))) 
(DEFUN |({MEMQ ? '(PLAN GRADUALLY REPEAT ASK BROADCAST)} %)| (OBJECT)
  (LET ((? (CAR OBJECT))) (MEMQ ? '(PLAN GRADUALLY REPEAT ASK BROADCAST)))) 
(DEFPROP
 |({MEMQ ? '(PLAN GRADUALLY REPEAT ASK BROADCAST)} %)|
 ({MEMQ ? '(PLAN GRADUALLY REPEAT ASK BROADCAST)} %)
 PATTERN) 
(DEFPROP |MACRO-(DO {or AT IN} ? ? %)SOMETHING| T MACRO-DEFINITION-FORM) 
(DEFINE-MACRO
 (|MACRO-(DO {or AT IN} ? ? %)SOMETHING| MYSELF MESSAGE-FORM)
 ((LAMBDA NIL '(ASK ,MYSELF SEQUENTIALLY `*MESSAGE)))) 
(DEFUN |(DO {or AT IN} ? ? %)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE DO))
   (AND (MEMQ (CADR OBJECT) (QUOTE (AT IN))) (LISTP (CDDDR OBJECT))))) 
(DEFPROP |(DO {or AT IN} ? ? %)| (DO {or AT IN} ? ? %) PATTERN) 
(DEFUN D0120 NIL
  ((LAMBDA (MESSAGE-FORM EVENT-PATTERN)
     (LET
      ((*REPLACE-OLD-METHODS NIL))
      (LET
       ((*MESSAGE
         '(DO
           ONCE
           WHEN
           RECEIVING
           ,EVENT-PATTERN
           (LET
            ((NEW-MESSAGE ,MESSAGE-FORM))
            (SCRIPT
             (LET
              ((RESULT (ASK-OLD-IF-UNDERSTOOD MYSELF !,*MESSAGE)))
              (AND NEW-MESSAGE (ASK MYSELF !,NEW-MESSAGE))
              RESULT))))))
       (QUICK-COMPILED-ASK
        '#,(METHOD-AT-POSITION (|(DO ONCE WHEN RECEIVING ? %)| 0) SOMETHING)
        '#,(ACTOR-OF (QUOTE SOMETHING))))))
   (CADR (CDDDDR *MESSAGE)) (CADDDR *MESSAGE))) 
(DEFUN |(PLAN AFTER RECEIVING ? TO ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE PLAN))
   (AND
    (EQ (CADR OBJECT) (QUOTE AFTER))
    (AND
     (EQ (CADDR OBJECT) (QUOTE RECEIVING))
     (AND (EQ (CAR (CDDDDR OBJECT)) (QUOTE TO)) (ONE-LONG (CDR (CDDDDR OBJECT)))))))) 
(DEFPROP |(PLAN AFTER RECEIVING ? TO ?)| (PLAN AFTER RECEIVING ? TO ?) PATTERN) 
(DEFUN D0119 NIL
  (LET
   ((THINGS
     (LET
      ((*MESSAGE '(RECALL YOUR THINGS-TO-DO-NEXT)))
      (QUICK-COMPILED-ASK
       '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
       '#,(ACTOR-OF (QUOTE SOMETHING))))))
   (LET
    ((*MESSAGE '(SET YOUR THINGS-TO-DO-NEXT TO NIL)))
    (QUICK-COMPILED-ASK
     '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
     '#,(ACTOR-OF (QUOTE SOMETHING))))
   (LET
    ((*MESSAGE '(CONCURRENTLY !,THINGS)))
    (QUICK-COMPILED-ASK
     '#,(METHOD-AT-POSITION (|(CONCURRENTLY %)| 0) SOMETHING)
     '#,(ACTOR-OF (QUOTE SOMETHING))))
   THINGS)) 
(DEFUN D0117 NIL
  ((LAMBDA (PATTERN)
     (KEEP-SENDING-ITEMS-COLLECTING-ALL
      (CONS 'DIRECTOR-SYMBOL-FOR-AND-PATTERN (CONS '?THE-ITEM (CONS PATTERN NIL)))
      (MAKE-NORMAL-METHOD
       (CONS 'DIRECTOR-SYMBOL-FOR-AND-PATTERN (CONS '?THE-ITEM (CONS PATTERN NIL)))
       '((SCRIPT (ASK MYSELF FORGET ITEM ,THE-ITEM))))
      MYSELF))
   (CADDDR *MESSAGE))) 
(DEFUN |(FORGET ITEMS MATCHING ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE FORGET))
   (AND
    (EQ (CADR OBJECT) (QUOTE ITEMS))
    (AND (EQ (CADDR OBJECT) (QUOTE MATCHING)) (ONE-LONG (CDDDR OBJECT)))))) 
(DEFPROP |(FORGET ITEMS MATCHING ?)| (FORGET ITEMS MATCHING ?) PATTERN) 
(DEFUN D0115 NIL
  ((LAMBDA (PATTERN)
     (KEEP-SENDING-ITEMS-COLLECTING-ALL
      (CONS 'DIRECTOR-SYMBOL-FOR-AND-PATTERN (CONS '?THE-ITEM (CONS PATTERN NIL)))
      (MAKE-NORMAL-METHOD
       (CONS 'DIRECTOR-SYMBOL-FOR-AND-PATTERN (CONS '?THE-ITEM (CONS PATTERN NIL)))
       '(THE-ITEM))
      MYSELF))
   (CAR (CDDDDR *MESSAGE)))) 
(DEFUN |(COLLECT ITEMS MEMORIZED MATCHING ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE COLLECT))
   (AND
    (EQ (CADR OBJECT) (QUOTE ITEMS))
    (AND
     (EQ (CADDR OBJECT) (QUOTE MEMORIZED))
     (AND (EQ (CADDDR OBJECT) (QUOTE MATCHING)) (ONE-LONG (CDDDDR OBJECT))))))) 
(DEFPROP
 |(COLLECT ITEMS MEMORIZED MATCHING ?)|
 (COLLECT ITEMS MEMORIZED MATCHING ?)
 PATTERN) 
(DEFPROP
 |MACRO-(RECALL EACH ITEM MATCHING ?PATTERN THEN %ACTION)SOMETHING|
 T
 MACRO-DEFINITION-FORM) 
(DEFINE-MACRO
 (|MACRO-(RECALL EACH ITEM MATCHING ?PATTERN THEN %ACTION)SOMETHING|
  MYSELF
  MESSAGE-FORM)
 ((LAMBDA (ACTION PATTERN)
    (MAKE-KEEP-SENDING-TYPE-BODY 'KEEP-SENDING-ITEMS-COLLECTING-ALL PATTERN ACTION))
  (CDDR (CDDDDR MESSAGE-FORM)) (CAR (CDDDDR MESSAGE-FORM)))) 
(DEFUN |(RECALL EACH ITEM MATCHING ? THEN %)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE RECALL))
   (AND
    (EQ (CADR OBJECT) (QUOTE EACH))
    (AND
     (EQ (CADDR OBJECT) (QUOTE ITEM))
     (AND (EQ (CADDDR OBJECT) (QUOTE MATCHING)) (EQ (CADR (CDDDDR OBJECT)) (QUOTE THEN))))))) 
(DEFPROP
 |(RECALL EACH ITEM MATCHING ? THEN %)|
 (RECALL EACH ITEM MATCHING ? THEN %)
 PATTERN) 
(DEFPROP
 |MACRO-(RECALL AN ITEM MATCHING ?PATTERN THEN %ACTION)SOMETHING|
 T
 MACRO-DEFINITION-FORM) 
(DEFINE-MACRO
 (|MACRO-(RECALL AN ITEM MATCHING ?PATTERN THEN %ACTION)SOMETHING| MYSELF MESSAGE-FORM)
 ((LAMBDA (ACTION PATTERN)
    (MAKE-KEEP-SENDING-TYPE-BODY 'KEEP-SENDING-ITEMS-TIL-MATCH PATTERN ACTION))
  (CDDR (CDDDDR MESSAGE-FORM)) (CAR (CDDDDR MESSAGE-FORM)))) 
(DEFUN |(RECALL AN ITEM MATCHING ? THEN %)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE RECALL))
   (AND
    (EQ (CADR OBJECT) (QUOTE AN))
    (AND
     (EQ (CADDR OBJECT) (QUOTE ITEM))
     (AND (EQ (CADDDR OBJECT) (QUOTE MATCHING)) (EQ (CADR (CDDDDR OBJECT)) (QUOTE THEN))))))) 
(DEFPROP |(RECALL AN ITEM MATCHING ? THEN %)| (RECALL AN ITEM MATCHING ? THEN %) PATTERN) 
(DEFUN D0114 NIL
  (LET
   ((*MESSAGE '(RECALL YOUR INTERNAL-NAME-OF-ITEMS-MEMORIZED)))
   (QUICK-COMPILED-ASK
    '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
    '#,(ACTOR-OF (QUOTE SOMETHING))))) 
(DEFUN |(RECALL ALL POSSIBLE ITEMS MATCHING ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE RECALL))
   (AND
    (EQ (CADR OBJECT) (QUOTE ALL))
    (AND
     (EQ (CADDR OBJECT) (QUOTE POSSIBLE))
     (AND
      (EQ (CADDDR OBJECT) (QUOTE ITEMS))
      (AND (EQ (CAR (CDDDDR OBJECT)) (QUOTE MATCHING)) (ONE-LONG (CDR (CDDDDR OBJECT))))))))) 
(DEFPROP
 |(RECALL ALL POSSIBLE ITEMS MATCHING ?)|
 (RECALL ALL POSSIBLE ITEMS MATCHING ?)
 PATTERN) 
(DEFUN D0112 NIL
  ((LAMBDA (ITEM)
     (LET
      ((*MESSAGE
        '(SET
          YOUR
          INTERNAL-NAME-OF-ITEMS-MEMORIZED
          TO
          ,(SAFE-DELETE
            (QUOTE-IF-NEED-BE ,ITEM)
            (ASK MYSELF RECALL YOUR INTERNAL-NAME-OF-ITEMS-MEMORIZED)))))
      (QUICK-COMPILED-ASK
       '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
       '#,(ACTOR-OF (QUOTE SOMETHING))))
     NO-VALUE)
   (CADDR *MESSAGE))) 
(DEFUN |(FORGET ITEM ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE FORGET))
   (AND (EQ (CADR OBJECT) (QUOTE ITEM)) (ONE-LONG (CDDR OBJECT))))) 
(DEFPROP |(FORGET ITEM ?)| (FORGET ITEM ?) PATTERN) 
(DEFUN D0110 NIL
  ((LAMBDA (ITEM)
     (LET
      ((*MESSAGE
        '(SET
          YOUR
          INTERNAL-NAME-OF-ITEMS-MEMORIZED
          TO
          ,(CONS-IF-NOT-MEMBER
            (QUOTE-IF-NEED-BE ,ITEM)
            (ASK MYSELF RECALL YOUR INTERNAL-NAME-OF-ITEMS-MEMORIZED)))))
      (QUICK-COMPILED-ASK
       '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
       '#,(ACTOR-OF (QUOTE SOMETHING))))
     NO-VALUE)
   (CADR *MESSAGE))) 
(DEFUN |(MEMORIZE ?)| (OBJECT)
  (AND (EQ (CAR OBJECT) (QUOTE MEMORIZE)) (ONE-LONG (CDR OBJECT)))) 
(DEFPROP |(MEMORIZE ?)| (MEMORIZE ?) PATTERN) 
(DEFUN D0104 NIL
  (LET
   ((NAME (NAME-OF MYSELF)))
   (COND ((MEMBER NAME *PROTECTED-ACTORS)
          (AND
           (PROTECTED-ACTOR-BUT-OK NAME)
           (LET
            ((*MESSAGE '(UNMAKE)))
            (QUICK-COMPILED-ASK
             '#,(METHOD-AT-POSITION ((UNMAKE) 0) SOMETHING)
             '#,(ACTOR-OF (QUOTE SOMETHING))))))
         ((OR
           (NOT *PROTECT-ALL-ACTORS)
           (COND ((LET
                   ((*MESSAGE '(RECALL YOUR NAME)))
                   (QUICK-COMPILED-ASK
                    '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
                    '#,(ACTOR-OF (QUOTE SOMETHING))))
                  (ASK-IF
                   '(|do you really want to destroy|
                     ,(OR NAME MYSELF)
                     |and all its parts and offspring?|)))
                 (T T)))
          (LET
           ((PARENT (PARENT-OF MYSELF)))
           (COND (PARENT
                  (LET
                   ((MYSELF (ACTOR-OF PARENT))
                    (*MESSAGE
                     '(SET
                       YOUR
                       OFFSPRING
                       TO
                       ,(SAFE-DELETE
                         (QUOTE-IF-NEED-BE ,NAME)
                         (ASK ,PARENT RECALL YOUR OFFSPRING)))))
                   (QUICK-COMPILED-ASK
                    '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
                    '#,(ACTOR-OF (QUOTE SOMETHING)))))))
          (COND ((LET
                  ((*MESSAGE '(RECALL YOUR THINGS-TO-DO-NEXT)))
                  (QUICK-COMPILED-ASK
                   '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
                   '#,(ACTOR-OF (QUOTE SOMETHING))))
                 (LET
                  ((*MESSAGE
                    '(SEQUENTIALLY
                      (ASK
                       YOUR
                       CLOCK
                       REMOVE
                       ,MYSELF
                       FROM
                       YOUR
                       LIST
                       OF
                       ACTORS-TO-RUN-NEXT))))
                  (QUICK-COMPILED-ASK
                   '#,(METHOD-AT-POSITION
                       (|(SEQUENTIALLY (ASK YOUR ? %) %)| 0)
                       SOMETHING)
                   '#,(ACTOR-OF (QUOTE SOMETHING))))))
          (LET
           ((WHOLE
             (LET
              ((*MESSAGE '(RECALL YOUR WHOLE)))
              (QUICK-COMPILED-ASK
               '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
               '#,(ACTOR-OF (QUOTE SOMETHING))))))
           (AND
            (EXISTS? WHOLE)
            (LET
             ((MYSELF (ACTOR-OF WHOLE))
              (*MESSAGE
               '(SET
                 YOUR
                 PARTS
                 TO
                 ,(SAFE-DELETE (QUOTE-IF-NEED-BE ,NAME) (ASK ,WHOLE RECALL YOUR PARTS)))))
             (QUICK-COMPILED-ASK
              '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
              '#,(ACTOR-OF (QUOTE SOMETHING))))))
          (LET
           ((*PROTECT-ALL-ACTORS NIL))
           (LET
            ((*MESSAGE '(SEQUENTIALLY (ASK EACH OF YOUR PARTS TO UNMAKE))))
            (QUICK-COMPILED-ASK
             '#,(METHOD-AT-POSITION
                 (|(SEQUENTIALLY (ASK EACH OF YOUR ? %) %)| 0)
                 SOMETHING)
             '#,(ACTOR-OF (QUOTE SOMETHING))))
           (LET
            ((*MESSAGE '(SEQUENTIALLY (ASK EACH OF YOUR OFFSPRING TO UNMAKE))))
            (QUICK-COMPILED-ASK
             '#,(METHOD-AT-POSITION
                 (|(SEQUENTIALLY (ASK EACH OF YOUR ? %) %)| 0)
                 SOMETHING)
             '#,(ACTOR-OF (QUOTE SOMETHING))))
           (LET
            ((*MESSAGE '(UNTRACE)))
            (QUICK-COMPILED-ASK
             '#,(METHOD-AT-POSITION ((UNTRACE) 0) SOMETHING)
             '#,(ACTOR-OF (QUOTE SOMETHING)))))
          (MAPC
           'REMOVE-ACTOR-FROM-NAME
           (LET
            ((*MESSAGE '(RECALL YOUR SYNONYMS)))
            (QUICK-COMPILED-ASK
             '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
             '#,(ACTOR-OF (QUOTE SOMETHING)))))
          (REMOVE-ACTOR-FROM-NAME NAME)
          NO-VALUE)))) 
(DEFUN D0100 NIL
  (LET
   ((NAME
     (LET
      ((*MESSAGE '(RECALL YOUR NAME)))
      (QUICK-COMPILED-ASK
       '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
       '#,(ACTOR-OF (QUOTE SOMETHING)))))
    (WHOLE
     (LET
      ((*MESSAGE '(RECALL YOUR WHOLE)))
      (QUICK-COMPILED-ASK
       '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
       '#,(ACTOR-OF (QUOTE SOMETHING))))))
   (COND (NAME
          (AND
           (EXISTS? WHOLE)
           (LET
            ((MYSELF (ACTOR-OF WHOLE))
             (*MESSAGE
              '(SET
                YOUR
                PARTS
                TO
                ,(SAFE-DELETE (QUOTE-IF-NEED-BE ,NAME) (ASK ,WHOLE RECALL YOUR PARTS)))))
            (QUICK-COMPILED-ASK
             '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
             '#,(ACTOR-OF (QUOTE SOMETHING)))))))
   (LET
    ((*MESSAGE '(SEQUENTIALLY (ASK YOUR WHOLE ADD ,MYSELF TO YOUR LIST OF PARTS))))
    (QUICK-COMPILED-ASK
     '#,(METHOD-AT-POSITION (|(SEQUENTIALLY (ASK YOUR ? %) %)| 0) SOMETHING)
     '#,(ACTOR-OF (QUOTE SOMETHING))))
   (LET
    ((*MESSAGE '(SEQUENTIALLY (ASK EACH OF YOUR PARTS TO SET YOUR WHOLE TO ,MYSELF))))
    (QUICK-COMPILED-ASK
     '#,(METHOD-AT-POSITION (|(SEQUENTIALLY (ASK EACH OF YOUR ? %) %)| 0) SOMETHING)
     '#,(ACTOR-OF (QUOTE SOMETHING))))
   (GENERAL-REMPROP (NAME-OF MYSELF) 'ACTOR 'NON-ATOMIC-ACTORS)
   (LET
    ((*MESSAGE '(FORGET YOUR NAME)))
    (QUICK-COMPILED-ASK
     '#,(METHOD-AT-POSITION (|(FORGET YOUR ?)| 0) SOMETHING)
     '#,(ACTOR-OF (QUOTE SOMETHING))))
   MYSELF)) 
(DEFUN D0099 NIL
  (GENERAL-REMPROP (NAME-OF MYSELF) 'ACTOR 'NON-ATOMIC-ACTORS)
  (LET
   ((NEW-NAME
     (LET
      ((*MESSAGE
        '(SET YOUR NAME TO ,(GENERATE-SYMBOL (OR (NAME-OF MYSELF) '|unnamed-actor|)))))
      (QUICK-COMPILED-ASK
       '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
       '#,(ACTOR-OF (QUOTE SOMETHING))))))
   (PLACE-ACTOR-ON-NAME MYSELF NEW-NAME)
   NEW-NAME)) 
(DEFUN D0098 NIL
  (MAPC
   (FUNCTION
    (LAMBDA (PART)
      (LET
       ((PART-NAME (NAME-OF PART)) (PART-ACTOR (ACTOR-OF PART)))
       (LET
        ((MYSELF (ACTOR-OF PART-ACTOR)) (*MESSAGE '(DISEMBODY)))
        (QUICK-COMPILED-ASK
         '#,(METHOD-AT-POSITION ((DISEMBODY) 0) SOMETHING)
         '#,(ACTOR-OF (QUOTE SOMETHING))))
       (LET
        ((*MESSAGE '(SET YOUR ,PART-NAME TO ,PART-ACTOR)))
        (COMPILED-ASK
         '#,(LIST
             (METHOD-AT-POSITION (|(SET YOUR PARENT TO ?)| 0) SOMETHING)
             (METHOD-AT-POSITION (|(SET YOUR WHOLE TO ?)| 0) SOMETHING)
             (METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING))
         '#,(ACTOR-OF (QUOTE SOMETHING))))
       (LET
        ((MYSELF (ACTOR-OF PART-ACTOR)) (*MESSAGE '(ABSORB YOUR PARTS)))
        (QUICK-COMPILED-ASK
         '#,(METHOD-AT-POSITION ((ABSORB YOUR PARTS) 0) SOMETHING)
         '#,(ACTOR-OF (QUOTE SOMETHING)))))))
   (LET
    ((*MESSAGE '(RECALL YOUR PARTS)))
    (QUICK-COMPILED-ASK
     '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
     '#,(ACTOR-OF (QUOTE SOMETHING)))))
  NO-VALUE) 
(DEFUN D0096 NIL
  ((LAMBDA (NAME)
     (LET
      ((*MESSAGE
        '(SET
          YOUR
          SYNONYMS
          TO
          ,(CONS-IF-NOT-MEMBER
            (QUOTE-IF-NEED-BE ,NAME)
            (ASK MYSELF RECALL YOUR SYNONYMS)))))
      (QUICK-COMPILED-ASK
       '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
       '#,(ACTOR-OF (QUOTE SOMETHING))))
     (SYNONYM-FOR MYSELF NAME))
   (CADDR *MESSAGE))) 
(DEFUN |(MAKE SYNONYM ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE MAKE))
   (AND (EQ (CADR OBJECT) (QUOTE SYNONYM)) (ONE-LONG (CDDR OBJECT))))) 
(DEFPROP |(MAKE SYNONYM ?)| (MAKE SYNONYM ?) PATTERN) 
(DEFUN D0095 NIL ((LAMBDA (NAME) (CLONE-ACTOR (LIST NAME))) (CAR (CDDDDR *MESSAGE)))) 
(DEFUN |(CLONE AND NAME IT ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE CLONE))
   (AND
    (EQ (CADR OBJECT) (QUOTE AND))
    (AND
     (EQ (CADDR OBJECT) (QUOTE NAME))
     (AND (EQ (CADDDR OBJECT) (QUOTE IT)) (ONE-LONG (CDDDDR OBJECT))))))) 
(DEFPROP |(CLONE AND NAME IT ?)| (CLONE AND NAME IT ?) PATTERN) 
(DEFUN D0094 NIL (CLONE-ACTOR NIL)) 
(DEFUN D0093 NIL
  ((LAMBDA (NAME)
     (COND ((EXISTS? NAME) NAME)
           (T
            (LET
             ((*MESSAGE '(MAKE ,NAME)))
             (QUICK-COMPILED-ASK
              '#,(METHOD-AT-POSITION (|(MAKE ?)| 0) SOMETHING)
              '#,(ACTOR-OF (QUOTE SOMETHING)))))))
   (CADDDR *MESSAGE))) 
(DEFUN |(IF NEW MAKE ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE IF))
   (AND
    (EQ (CADR OBJECT) (QUOTE NEW))
    (AND (EQ (CADDR OBJECT) (QUOTE MAKE)) (ONE-LONG (CDDDR OBJECT)))))) 
(DEFPROP |(IF NEW MAKE ?)| (IF NEW MAKE ?) PATTERN) 
(DEFUN D0091 NIL
  (APPEND-ATOMS
   (NAME-OF MYSELF)
   '-
   (LET
    ((*MESSAGE
      '(SET
        YOUR
        NAME-COUNTER
        TO
        ,(PLUS (OR (ASK MYSELF RECALL YOUR NAME-COUNTER) 0) (QUOTE-IF-NEED-BE 1)))))
    (QUICK-COMPILED-ASK
     '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
     '#,(ACTOR-OF (QUOTE SOMETHING)))))) 
(DEFUN D0089 NIL
  (INTERN-APPEND-ATOMS
   (NAME-OF MYSELF)
   '-
   (LET
    ((*MESSAGE
      '(SET
        YOUR
        NAME-COUNTER
        TO
        ,(PLUS (OR (ASK MYSELF RECALL YOUR NAME-COUNTER) 0) (QUOTE-IF-NEED-BE 1)))))
    (QUICK-COMPILED-ASK
     '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
     '#,(ACTOR-OF (QUOTE SOMETHING)))))) 
(DEFUN D0084 NIL
  ((LAMBDA (NAME)
     (LET
      ((OLD-VERSION (ACTOR-OF NAME DONT-AUTOLOAD)))
      (COND ((AND (NOT *REPLACE-OLD-ACTORS) NAME)
             (COND ((LET
                     ((MYSELF (ACTOR-OF NAME)) (*MESSAGE '(UNMAKE)))
                     (QUICK-COMPILED-ASK
                      '#,(METHOD-AT-POSITION ((UNMAKE) 0) SOMETHING)
                      '#,(ACTOR-OF (QUOTE SOMETHING))))
                    (LET
                     ((*MESSAGE '(!,*MESSAGE)))
                     (QUICK-COMPILED-ASK
                      '#,(METHOD-AT-POSITION (|(MAKE ?)| 0) SOMETHING)
                      '#,(ACTOR-OF (QUOTE SOMETHING)))))))
            (T
             (LET
              ((NEW-VERSION
                (LET
                 ((*MESSAGE
                   '(MAKE
                     AN
                     INSTANCE
                     NAMED
                     ,NAME
                     COPYING
                     ,(ASK MYSELF RECALL YOUR VARIABLES-TO-COPY-UPON-CREATION))))
                 (QUICK-COMPILED-ASK
                  '#,(METHOD-AT-POSITION
                      (|(MAKE AN INSTANCE NAMED ? COPYING ?)| 0)
                      SOMETHING)
                  '#,(ACTOR-OF (QUOTE SOMETHING))))))
              (COND ((NULL NAME) NEW-VERSION)
                    ((NULL OLD-VERSION)
                     (PLACE-ACTOR-ON-NAME NEW-VERSION NAME)
                     (COND ((INTERNEDP NAME)
                            (LET
                             ((*MESSAGE
                               '(SET
                                 YOUR
                                 OFFSPRING
                                 TO
                                 ,(CONS-IF-NOT-MEMBER
                                   (QUOTE-IF-NEED-BE ,NAME)
                                   (ASK MYSELF RECALL YOUR OFFSPRING)))))
                             (QUICK-COMPILED-ASK
                              '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
                              '#,(ACTOR-OF (QUOTE SOMETHING))))))
                     NAME)
                    ((COND ((MEMBER NAME *PROTECTED-ACTORS)
                            (PROTECTED-ACTOR-BUT-OK NAME))
                           (T T))
                     (LET
                      ((WHOLE
                        (LET
                         ((MYSELF (ACTOR-OF OLD-VERSION))
                          (*MESSAGE '(RECALL YOUR WHOLE)))
                         (QUICK-COMPILED-ASK
                          '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
                          '#,(ACTOR-OF (QUOTE SOMETHING))))))
                      (AND
                       WHOLE
                       (LET
                        ((MYSELF (ACTOR-OF WHOLE))
                         (*MESSAGE
                          '(SET
                            YOUR
                            PARTS
                            TO
                            ,(SAFE-DELETE
                              (QUOTE-IF-NEED-BE ,NAME)
                              (ASK ,WHOLE RECALL YOUR PARTS)))))
                        (QUICK-COMPILED-ASK
                         '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
                         '#,(ACTOR-OF (QUOTE SOMETHING))))))
                     (COND ((NOT (ACTOR-EQ (PARENT-OF OLD-VERSION) MYSELF))
                            (LET
                             ((MYSELF (ACTOR-OF (PARENT-OF OLD-VERSION)))
                              (*MESSAGE
                               '(SET
                                 YOUR
                                 OFFSPRING
                                 TO
                                 ,(SAFE-DELETE
                                   (QUOTE-IF-NEED-BE ,NAME)
                                   (ASK ,(PARENT-OF OLD-VERSION) RECALL YOUR OFFSPRING)))))
                             (QUICK-COMPILED-ASK
                              '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
                              '#,(ACTOR-OF (QUOTE SOMETHING))))
                            (COND ((INTERNEDP NAME)
                                   (LET
                                    ((*MESSAGE
                                      '(SET
                                        YOUR
                                        OFFSPRING
                                        TO
                                        ,(CONS-IF-NOT-MEMBER
                                          (QUOTE-IF-NEED-BE ,NAME)
                                          (ASK MYSELF RECALL YOUR OFFSPRING)))))
                                    (QUICK-COMPILED-ASK
                                     '#,(METHOD-AT-POSITION
                                         (|(SET YOUR ? TO ?)| 0)
                                         SOMETHING)
                                     '#,(ACTOR-OF (QUOTE SOMETHING))))))))
                     (RECYCLE-OLD-ACTOR OLD-VERSION NEW-VERSION)
                     NAME)))))))
   (CADR *MESSAGE))) 
(DEFUN |(MAKE ?)| (OBJECT) (AND (EQ (CAR OBJECT) (QUOTE MAKE)) (ONE-LONG (CDR OBJECT)))) 
(DEFPROP |(MAKE ?)| (MAKE ?) PATTERN) 
(DEFPROP |MACRO-(MAKE)SOMETHING| T MACRO-DEFINITION-FORM) 
(DEFINE-MACRO
 (|MACRO-(MAKE)SOMETHING| MYSELF MESSAGE-FORM)
 ((LAMBDA NIL '(ASK ,MYSELF MAKE NIL)))) 
(DEFUN D0083 NIL
  ((LAMBDA (VARIABLES-TO-COPY NAME)
     (COND (VARIABLES-TO-COPY
            (LET
             ((NEW-ACTOR (MAKE-ACTOR (ACTOR-OF 'SOMETHING) NAME)))
             (MAPC
              (FUNCTION
               (LAMBDA (VARIABLE-TO-COPY)
                 (LET
                  ((MYSELF (ACTOR-OF NEW-ACTOR))
                   (*MESSAGE
                    '(SET
                      YOUR
                      ,VARIABLE-TO-COPY
                      TO
                      ,(ASK MYSELF RECALL YOUR ,VARIABLE-TO-COPY))))
                  (COMPILED-ASK
                   '#,(LIST
                       (METHOD-AT-POSITION (|(SET YOUR PARENT TO ?)| 0) SOMETHING)
                       (METHOD-AT-POSITION (|(SET YOUR WHOLE TO ?)| 0) SOMETHING)
                       (METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING))
                   '#,(ACTOR-OF (QUOTE SOMETHING))))))
              VARIABLES-TO-COPY)
             (LET
              ((MYSELF (ACTOR-OF NEW-ACTOR)) (*MESSAGE '(SET YOUR PARENT TO ,MYSELF)))
              (QUICK-COMPILED-ASK
               '#,(METHOD-AT-POSITION (|(SET YOUR PARENT TO ?)| 0) SOMETHING)
               '#,(ACTOR-OF (QUOTE SOMETHING))))
             NEW-ACTOR))
           (T (MAKE-ACTOR MYSELF NAME))))
   (CADDR (CDDDDR *MESSAGE)) (CAR (CDDDDR *MESSAGE)))) 
(DEFUN |(MAKE AN INSTANCE NAMED ? COPYING ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE MAKE))
   (AND
    (EQ (CADR OBJECT) (QUOTE AN))
    (AND
     (EQ (CADDR OBJECT) (QUOTE INSTANCE))
     (AND
      (EQ (CADDDR OBJECT) (QUOTE NAMED))
      (AND (EQ (CADR (CDDDDR OBJECT)) (QUOTE COPYING)) (ONE-LONG (CDDR (CDDDDR OBJECT))))))))
  ) 
(DEFPROP
 |(MAKE AN INSTANCE NAMED ? COPYING ?)|
 (MAKE AN INSTANCE NAMED ? COPYING ?)
 PATTERN) 
(DEFUN D0082 NIL
  ((LAMBDA (VARIABLE-PATTERN)
     (DO
      ((I
        (LET
         ((*MESSAGE '(LIST ALL YOUR VARIABLE NAMES)))
         (QUICK-COMPILED-ASK
          '#,(METHOD-AT-POSITION ((LIST ALL YOUR VARIABLE NAMES) 0) SOMETHING)
          '#,(ACTOR-OF (QUOTE SOMETHING))))
        (REST I))
       (MATCHING-NAMES NIL))
      ((NULL I)
       (MAPCAR
        (FUNCTION
         (LAMBDA (VARIABLE-NAME)
           (LET
            ((*MESSAGE '(RECALL YOUR ,VARIABLE-NAME)))
            (COMPILED-ASK
             '#,(LIST
                 (METHOD-AT-POSITION ((RECALL YOUR SIBLINGS) 0) SOMETHING)
                 (METHOD-AT-POSITION ((RECALL YOUR DESCENDANTS) 0) SOMETHING)
                 (METHOD-AT-POSITION ((RECALL YOUR CHILDLESS-DESCENDANTS) 0) SOMETHING)
                 (METHOD-AT-POSITION ((RECALL YOUR PARENT) 0) SOMETHING)
                 (METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING))
             '#,(ACTOR-OF (QUOTE SOMETHING))))))
        MATCHING-NAMES))
      (COND ((MATCH (FIRST I) VARIABLE-PATTERN) (PUSH (FIRST I) MATCHING-NAMES)))))
   (CAR (CDDDDR *MESSAGE)))) 
(DEFUN |(RECALL EACH OF YOUR ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE RECALL))
   (AND
    (EQ (CADR OBJECT) (QUOTE EACH))
    (AND
     (EQ (CADDR OBJECT) (QUOTE OF))
     (AND (EQ (CADDDR OBJECT) (QUOTE YOUR)) (ONE-LONG (CDDDDR OBJECT))))))) 
(DEFPROP |(RECALL EACH OF YOUR ?)| (RECALL EACH OF YOUR ?) PATTERN) 
(DEFUN D0081 NIL (COLLECT-ALL-VARIABLE-NAMES MYSELF)) 
(DEFPROP
 |MACRO-(REMOVE ?ELEMENT FROM YOUR LIST OF ?LIST-NAME)SOMETHING|
 T
 MACRO-DEFINITION-FORM) 
(DEFINE-MACRO
 (|MACRO-(REMOVE ?ELEMENT FROM YOUR LIST OF ?LIST-NAME)SOMETHING| MYSELF MESSAGE-FORM)
 ((LAMBDA (LIST-NAME ELEMENT)
    '(ASK
      ,MYSELF
      SET
      YOUR
      ,LIST-NAME
      TO
      `(SAFE-DELETE (QUOTE-IF-NEED-BE ,ELEMENT) (ASK ,MYSELF RECALL YOUR ,LIST-NAME))))
  (CADDR (CDDDDR MESSAGE-FORM)) (CADR MESSAGE-FORM))) 
(DEFUN |(REMOVE ? FROM YOUR LIST OF ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE REMOVE))
   (AND
    (EQ (CADDR OBJECT) (QUOTE FROM))
    (AND
     (EQ (CADDDR OBJECT) (QUOTE YOUR))
     (AND
      (EQ (CAR (CDDDDR OBJECT)) (QUOTE LIST))
      (AND (EQ (CADR (CDDDDR OBJECT)) (QUOTE OF)) (ONE-LONG (CDDR (CDDDDR OBJECT))))))))) 
(DEFPROP |(REMOVE ? FROM YOUR LIST OF ?)| (REMOVE ? FROM YOUR LIST OF ?) PATTERN) 
(DEFPROP
 |MACRO-(ADD ?VALUE TO YOUR LIST OF ?VARIABLE REGARDLESS)SOMETHING|
 T
 MACRO-DEFINITION-FORM) 
(DEFINE-MACRO
 (|MACRO-(ADD ?VALUE TO YOUR LIST OF ?VARIABLE REGARDLESS)SOMETHING|
  MYSELF
  MESSAGE-FORM)
 ((LAMBDA (VARIABLE VALUE)
    '(ASK
      ,MYSELF
      SET
      YOUR
      ,VARIABLE
      TO
      `(CONS (QUOTE-IF-NEED-BE ,VALUE) (ASK ,MYSELF RECALL YOUR ,VARIABLE))))
  (CADDR (CDDDDR MESSAGE-FORM)) (CADR MESSAGE-FORM))) 
(DEFUN |(ADD ? TO YOUR LIST OF ? REGARDLESS)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE ADD))
   (AND
    (EQ (CADDR OBJECT) (QUOTE TO))
    (AND
     (EQ (CADDDR OBJECT) (QUOTE YOUR))
     (AND
      (EQ (CAR (CDDDDR OBJECT)) (QUOTE LIST))
      (AND
       (EQ (CADR (CDDDDR OBJECT)) (QUOTE OF))
       (EQUAL (CDDDR (CDDDDR OBJECT)) (QUOTE (REGARDLESS))))))))) 
(DEFPROP
 |(ADD ? TO YOUR LIST OF ? REGARDLESS)|
 (ADD ? TO YOUR LIST OF ? REGARDLESS)
 PATTERN) 
(DEFPROP
 |MACRO-(ADD ?VALUE TO YOUR LIST OF ?LIST-NAME)SOMETHING|
 T
 MACRO-DEFINITION-FORM) 
(DEFINE-MACRO
 (|MACRO-(ADD ?VALUE TO YOUR LIST OF ?LIST-NAME)SOMETHING| MYSELF MESSAGE-FORM)
 ((LAMBDA (LIST-NAME VALUE)
    '(ASK
      ,MYSELF
      SET
      YOUR
      ,LIST-NAME
      TO
      `(CONS-IF-NOT-MEMBER
        (QUOTE-IF-NEED-BE ,VALUE)
        (ASK ,MYSELF RECALL YOUR ,LIST-NAME))))
  (CADDR (CDDDDR MESSAGE-FORM)) (CADR MESSAGE-FORM))) 
(DEFUN |(ADD ? TO YOUR LIST OF ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE ADD))
   (AND
    (EQ (CADDR OBJECT) (QUOTE TO))
    (AND
     (EQ (CADDDR OBJECT) (QUOTE YOUR))
     (AND
      (EQ (CAR (CDDDDR OBJECT)) (QUOTE LIST))
      (AND (EQ (CADR (CDDDDR OBJECT)) (QUOTE OF)) (ONE-LONG (CDDR (CDDDDR OBJECT))))))))) 
(DEFPROP |(ADD ? TO YOUR LIST OF ?)| (ADD ? TO YOUR LIST OF ?) PATTERN) 
(DEFPROP |MACRO-(MULTIPLY YOUR ?VARIABLE BY ?FACTOR)SOMETHING| T MACRO-DEFINITION-FORM) 
(DEFINE-MACRO
 (|MACRO-(MULTIPLY YOUR ?VARIABLE BY ?FACTOR)SOMETHING| MYSELF MESSAGE-FORM)
 ((LAMBDA (FACTOR VARIABLE)
    '(ASK
      ,MYSELF
      SET
      YOUR
      ,VARIABLE
      TO
      `(TIMES (OR (ASK ,MYSELF RECALL YOUR ,VARIABLE) 1) (QUOTE-IF-NEED-BE ,FACTOR))))
  (CAR (CDDDDR MESSAGE-FORM)) (CADDR MESSAGE-FORM))) 
(DEFUN |(MULTIPLY YOUR ? BY ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE MULTIPLY))
   (AND
    (EQ (CADR OBJECT) (QUOTE YOUR))
    (AND (EQ (CADDDR OBJECT) (QUOTE BY)) (ONE-LONG (CDDDDR OBJECT)))))) 
(DEFPROP |(MULTIPLY YOUR ? BY ?)| (MULTIPLY YOUR ? BY ?) PATTERN) 
(DEFPROP |MACRO-(INCREMENT YOUR ?VARIABLE BY ?AMOUNT)SOMETHING| T MACRO-DEFINITION-FORM) 
(DEFINE-MACRO
 (|MACRO-(INCREMENT YOUR ?VARIABLE BY ?AMOUNT)SOMETHING| MYSELF MESSAGE-FORM)
 ((LAMBDA (AMOUNT VARIABLE)
    '(ASK
      ,MYSELF
      SET
      YOUR
      ,VARIABLE
      TO
      `(PLUS (OR (ASK ,MYSELF RECALL YOUR ,VARIABLE) 0) (QUOTE-IF-NEED-BE ,AMOUNT))))
  (CAR (CDDDDR MESSAGE-FORM)) (CADDR MESSAGE-FORM))) 
(DEFUN |(INCREMENT YOUR ? BY ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE INCREMENT))
   (AND
    (EQ (CADR OBJECT) (QUOTE YOUR))
    (AND (EQ (CADDDR OBJECT) (QUOTE BY)) (ONE-LONG (CDDDDR OBJECT)))))) 
(DEFPROP |(INCREMENT YOUR ? BY ?)| (INCREMENT YOUR ? BY ?) PATTERN) 
(DEFPROP |MACRO-(TO %MESSAGE)SOMETHING| T MACRO-DEFINITION-FORM) 
(DEFINE-MACRO
 (|MACRO-(TO %MESSAGE)SOMETHING| MYSELF MESSAGE-FORM)
 ((LAMBDA (MESSAGE) '(ASK ,MYSELF !,MESSAGE)) (CDR MESSAGE-FORM))) 
(DEFUN |(TO %)| (OBJECT) (EQ (CAR OBJECT) (QUOTE TO))) 
(DEFPROP |(TO %)| (TO %) PATTERN) 
(DEFPROP |MACRO-(CHANGE YOUR ?VARIABLE TO ?VALUE)SOMETHING| T MACRO-DEFINITION-FORM) 
(DEFINE-MACRO
 (|MACRO-(CHANGE YOUR ?VARIABLE TO ?VALUE)SOMETHING| MYSELF MESSAGE-FORM)
 ((LAMBDA (VALUE VARIABLE) '(ASK ,MYSELF SET YOUR ,VARIABLE TO ,VALUE))
  (CAR (CDDDDR MESSAGE-FORM)) (CADDR MESSAGE-FORM))) 
(DEFUN |(CHANGE YOUR ? TO ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE CHANGE))
   (AND
    (EQ (CADR OBJECT) (QUOTE YOUR))
    (AND (EQ (CADDDR OBJECT) (QUOTE TO)) (ONE-LONG (CDDDDR OBJECT)))))) 
(DEFPROP |(CHANGE YOUR ? TO ?)| (CHANGE YOUR ? TO ?) PATTERN) 
(DEFUN D0080 NIL
  ((LAMBDA (ACTION PATTERN)
     (LET
      ((*MESSAGE
        '(DO
          WHEN
          RECEIVING
          ,PATTERN
          (COND ((ACTOR-EQ MYSELF (QUOTE ,MYSELF)) !,ACTION)
                (T (DO-OLD-BEHAVIOR))))))
      (QUICK-COMPILED-ASK
       '#,(METHOD-AT-POSITION (|(DO WHEN RECEIVING ? %)| 0) SOMETHING)
       '#,(ACTOR-OF (QUOTE SOMETHING)))))
   (CDDDR (CDDDDR *MESSAGE)) (CADDR (CDDDDR *MESSAGE)))) 
(DEFUN |(DO ONLY FOR YOURSELF WHEN RECEIVING ? %)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE DO))
   (AND
    (EQ (CADR OBJECT) (QUOTE ONLY))
    (AND
     (EQ (CADDR OBJECT) (QUOTE FOR))
     (AND
      (EQ (CADDDR OBJECT) (QUOTE YOURSELF))
      (AND
       (EQ (CAR (CDDDDR OBJECT)) (QUOTE WHEN))
       (AND (EQ (CADR (CDDDDR OBJECT)) (QUOTE RECEIVING)) (LISTP (CDDR (CDDDDR OBJECT))))))))
   )) 
(DEFPROP
 |(DO ONLY FOR YOURSELF WHEN RECEIVING ? %)|
 (DO ONLY FOR YOURSELF WHEN RECEIVING ? %)
 PATTERN) 
(DEFUN D0079 NIL
  ((LAMBDA (SIZE PATTERN-FOR-VARIABLES)
     (LET*
      ((ARRAY-HOLDER '(ARRAY-FOR ,PATTERN-FOR-VARIABLES))
       (OLD-ARRAY
        (LET
         ((*MESSAGE '(RECALL YOUR ,ARRAY-HOLDER)))
         (COMPILED-ASK
          '#,(LIST
              (METHOD-AT-POSITION ((RECALL YOUR SIBLINGS) 0) SOMETHING)
              (METHOD-AT-POSITION ((RECALL YOUR DESCENDANTS) 0) SOMETHING)
              (METHOD-AT-POSITION ((RECALL YOUR CHILDLESS-DESCENDANTS) 0) SOMETHING)
              (METHOD-AT-POSITION ((RECALL YOUR PARENT) 0) SOMETHING)
              (METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING))
          '#,(ACTOR-OF (QUOTE SOMETHING)))))
       (THE-ARRAY
        (COND (OLD-ARRAY (*REARRAY OLD-ARRAY T SIZE))
              (T (*ARRAY (GENERATE-SYMBOL 'ARRAY) T SIZE))))
       (VARIABLES-IN-PATTERN (FIND-VARIABLES-IN-PATTERN PATTERN-FOR-VARIABLES)))
      (LET
       ((*MESSAGE '(SET YOUR ,ARRAY-HOLDER TO ,THE-ARRAY)))
       (COMPILED-ASK
        '#,(LIST
            (METHOD-AT-POSITION (|(SET YOUR PARENT TO ?)| 0) SOMETHING)
            (METHOD-AT-POSITION (|(SET YOUR WHOLE TO ?)| 0) SOMETHING)
            (METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING))
        '#,(ACTOR-OF (QUOTE SOMETHING))))
      (LET
       ((*MESSAGE
         '(DO
           WHEN
           RECEIVING
           (RECALL YOUR ,PATTERN-FOR-VARIABLES)
           (,THE-ARRAY !,VARIABLES-IN-PATTERN))))
       (QUICK-COMPILED-ASK
        '#,(METHOD-AT-POSITION (|(DO WHEN RECEIVING ? %)| 0) SOMETHING)
        '#,(ACTOR-OF (QUOTE SOMETHING))))
      (LET
       ((*MESSAGE
         '(DO
           ONLY
           FOR
           YOURSELF
           WHEN
           RECEIVING
           (SET YOUR ,PATTERN-FOR-VARIABLES TO ?NEW-VALUE)
           (STORE (,THE-ARRAY !,VARIABLES-IN-PATTERN) NEW-VALUE))))
       (QUICK-COMPILED-ASK
        '#,(METHOD-AT-POSITION (|(DO ONLY FOR YOURSELF WHEN RECEIVING ? %)| 0) SOMETHING)
        '#,(ACTOR-OF (QUOTE SOMETHING)))))
     NO-VALUE)
   (CAR (CDDDDR (CDDDDR *MESSAGE))) (CADDR *MESSAGE))) 
(DEFUN |(WHEN REPRESENTING ? USE AN ARRAY OF SIZE ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE WHEN))
   (AND
    (EQ (CADR OBJECT) (QUOTE REPRESENTING))
    (AND
     (EQ (CADDDR OBJECT) (QUOTE USE))
     (AND
      (EQ (CAR (CDDDDR OBJECT)) (QUOTE AN))
      (AND
       (EQ (CADR (CDDDDR OBJECT)) (QUOTE ARRAY))
       (AND
        (EQ (CADDR (CDDDDR OBJECT)) (QUOTE OF))
        (AND
         (EQ (CADDDR (CDDDDR OBJECT)) (QUOTE SIZE))
         (ONE-LONG (CDDDDR (CDDDDR OBJECT))))))))))) 
(DEFPROP
 |(WHEN REPRESENTING ? USE AN ARRAY OF SIZE ?)|
 (WHEN REPRESENTING ? USE AN ARRAY OF SIZE ?)
 PATTERN) 
(DEFUN D0078 NIL
  ((LAMBDA (VARIABLE NAMES)
     (LET
      ((*MESSAGE '(SET YOUR (COMPONENTS OF ,VARIABLE) TO ,NAMES)))
      (QUICK-COMPILED-ASK
       '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
       '#,(ACTOR-OF (QUOTE SOMETHING))))
     (LET
      ((SETTING-COMPONENTS-METHOD
        (LET
         ((*MESSAGE
           '(DO
             WHEN
             RECEIVING
             (SET YOUR {MEMQ ?ELEMENT (QUOTE ,NAMES)} TO ?VALUE-OF-ELEMENT)
             (SET-VALUE-OF-ELEMENT
              ELEMENT
              VALUE-OF-ELEMENT
              (QUOTE ,VARIABLE)
              (QUOTE ,NAMES)))))
         (QUICK-COMPILED-ASK
          '#,(METHOD-AT-POSITION (|(DO WHEN RECEIVING ? %)| 0) SOMETHING)
          '#,(ACTOR-OF (QUOTE SOMETHING))))))
      (LET
       ((*MESSAGE
         '(DO
           WHEN
           RECEIVING
           (SET YOUR ,VARIABLE TO ?NEW-VALUE)
           (DO-OLD-BEHAVIOR)
           (SET-EACH-COMPONENT
            (QUOTE ,NAMES)
            NEW-VALUE
            (QUOTE ,SETTING-COMPONENTS-METHOD))
           NEW-VALUE)))
       (QUICK-COMPILED-ASK
        '#,(METHOD-AT-POSITION (|(DO WHEN RECEIVING ? %)| 0) SOMETHING)
        '#,(ACTOR-OF (QUOTE SOMETHING))))
      (LET
       ((*MESSAGE
         '(DO
           WHEN
           RECEIVING
           (RECALL YOUR {MEMQ ?ELEMENT (QUOTE ,NAMES)})
           (RECALL-VALUE-OF-ELEMENT ELEMENT (QUOTE ,VARIABLE) (QUOTE ,NAMES)))))
       (QUICK-COMPILED-ASK
        '#,(METHOD-AT-POSITION (|(DO WHEN RECEIVING ? %)| 0) SOMETHING)
        '#,(ACTOR-OF (QUOTE SOMETHING))))))
   (CAR (CDDDDR *MESSAGE)) (CADR *MESSAGE))) 
(DEFUN |(CONSIDER ? COMPONENTS OF ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE CONSIDER))
   (AND
    (EQ (CADDR OBJECT) (QUOTE COMPONENTS))
    (AND (EQ (CADDDR OBJECT) (QUOTE OF)) (ONE-LONG (CDDDDR OBJECT)))))) 
(DEFPROP |(CONSIDER ? COMPONENTS OF ?)| (CONSIDER ? COMPONENTS OF ?) PATTERN) 
(DEFUN D0077 NIL
  ((LAMBDA (SYNONYMS)
     (LET*
      ((NOTHING-FOUND (GENSYM)) (VALUE-OF-SYNONYMS (VALUE-OF-SYNONYMS SYNONYMS)))
      (DO
       ((S SYNONYMS (REST S))
        (PREVIOUS NIL)
        (NON-ATOMIC-ALIST (REST (INTERNAL-RECALL-YOUR-VARIABLE-OF MYSELF))))
       ((NULL S)
        (COND ((NOT (EQ VALUE-OF-SYNONYMS NOTHING-FOUND))
               (SET-VARIABLE-TO-VALUE (FIRST SYNONYMS) VALUE-OF-SYNONYMS))))
       (LET
        ((*MESSAGE
          '(SET
            YOUR
            (SYNONYMS-OF ,(FIRST S))
            TO
            ,(UNION
              (APPEND PREVIOUS (REST S))
              (SECOND (ASSOC '(SYNONYMS-OF ,(FIRST S)) NON-ATOMIC-ALIST))))))
        (QUICK-COMPILED-ASK
         '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
         '#,(ACTOR-OF (QUOTE SOMETHING))))
       (PUSH (FIRST S) PREVIOUS))))
   (CADR *MESSAGE))) 
(DEFUN |(CONSIDER ? SYNONYMS)| (OBJECT)
  (AND (EQ (CAR OBJECT) (QUOTE CONSIDER)) (EQUAL (CDDR OBJECT) (QUOTE (SYNONYMS))))) 
(DEFPROP |(CONSIDER ? SYNONYMS)| (CONSIDER ? SYNONYMS) PATTERN) 
(DEFUN D0076 NIL
  (DO
   ((I
     (LET
      ((*MESSAGE '(LIST ALL YOUR VARIABLE NAMES)))
      (QUICK-COMPILED-ASK
       '#,(METHOD-AT-POSITION ((LIST ALL YOUR VARIABLE NAMES) 0) SOMETHING)
       '#,(ACTOR-OF (QUOTE SOMETHING))))
     (REST I)))
   ((NULL I) NO-VALUE)
   (LET
    ((VARIABLE-NAME (FIRST I)))
    (COND ((MEMQ VARIABLE-NAME '(NAME OFFSPRING WHOLE PARTS SYNONYMS)))
          (T
           (LET
            ((*MESSAGE '(FORGET YOUR ,VARIABLE-NAME)))
            (QUICK-COMPILED-ASK
             '#,(METHOD-AT-POSITION (|(FORGET YOUR ?)| 0) SOMETHING)
             '#,(ACTOR-OF (QUOTE SOMETHING))))))))) 
(DEFUN D0075 NIL
  ((LAMBDA (VARIABLE)
     (FORGET-YOUR-VARIABLE VARIABLE (INTERNAL-RECALL-YOUR-VARIABLE-OF MYSELF) T))
   (CADDR *MESSAGE))) 
(DEFUN |(FORGET YOUR ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE FORGET))
   (AND (EQ (CADR OBJECT) (QUOTE YOUR)) (ONE-LONG (CDDR OBJECT))))) 
(DEFPROP |(FORGET YOUR ?)| (FORGET YOUR ?) PATTERN) 
(DEFUN D0074 NIL
  ((LAMBDA (VARIABLE) (RECALL-VALUE-OF-VARIABLE VARIABLE)) (CADDR *MESSAGE))) 
(DEFUN |(RECALL YOUR ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE RECALL))
   (AND (EQ (CADR OBJECT) (QUOTE YOUR)) (ONE-LONG (CDDR OBJECT))))) 
(DEFPROP |(RECALL YOUR ?)| (RECALL YOUR ?) PATTERN) 
(DEFUN D0073 NIL
  ((LAMBDA (VALUE VARIABLE) (SET-VARIABLE-TO-VALUE VARIABLE VALUE))
   (CAR (CDDDDR *MESSAGE)) (CADDR *MESSAGE))) 
(DEFUN |(SET YOUR ? TO ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE SET))
   (AND
    (EQ (CADR OBJECT) (QUOTE YOUR))
    (AND (EQ (CADDDR OBJECT) (QUOTE TO)) (ONE-LONG (CDDDDR OBJECT)))))) 
(DEFPROP |(SET YOUR ? TO ?)| (SET YOUR ? TO ?) PATTERN) 
(DEFUN D0070 NIL
  ((LAMBDA (NEW-WHOLE)
     (LET
      ((WHOLE
        (LET
         ((*MESSAGE '(RECALL YOUR WHOLE)))
         (QUICK-COMPILED-ASK
          '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
          '#,(ACTOR-OF (QUOTE SOMETHING)))))
       (NAME (NAME-OF MYSELF)))
      (COND ((NOT (ACTOR-EQ (ACTOR-OF WHOLE T) (ACTOR-OF NEW-WHOLE T)))
             (COND (WHOLE
                    (LET
                     ((MYSELF (ACTOR-OF WHOLE))
                      (*MESSAGE
                       '(SET
                         YOUR
                         PARTS
                         TO
                         ,(SAFE-DELETE
                           (QUOTE-IF-NEED-BE ,NAME)
                           (ASK ,WHOLE RECALL YOUR PARTS)))))
                     (QUICK-COMPILED-ASK
                      '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
                      '#,(ACTOR-OF (QUOTE SOMETHING))))))
             (AND
              (EXISTS? NEW-WHOLE)
              (COND ((AND NAME (INTERNEDP NAME))
                     (LET
                      ((MYSELF (ACTOR-OF NEW-WHOLE))
                       (*MESSAGE
                        '(SET
                          YOUR
                          PARTS
                          TO
                          ,(CONS-IF-NOT-MEMBER
                            (QUOTE-IF-NEED-BE ,NAME)
                            (ASK ,NEW-WHOLE RECALL YOUR PARTS)))))
                      (QUICK-COMPILED-ASK
                       '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
                       '#,(ACTOR-OF (QUOTE SOMETHING)))))))))
      (RUN-WITH-METHOD-INVISIBLE
       (LET
        ((*MESSAGE '(!,*MESSAGE)))
        (COMPILED-ASK
         '#,(LIST
             (METHOD-AT-POSITION (|(SET YOUR WHOLE TO ?)| 0) SOMETHING)
             (METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING))
         '#,(ACTOR-OF (QUOTE SOMETHING))))
       MYSELF
       *METHOD-BEING-RUN)))
   (CAR (CDDDDR *MESSAGE)))) 
(DEFUN |(SET YOUR WHOLE TO ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE SET))
   (AND
    (EQ (CADR OBJECT) (QUOTE YOUR))
    (AND
     (EQ (CADDR OBJECT) (QUOTE WHOLE))
     (AND (EQ (CADDDR OBJECT) (QUOTE TO)) (ONE-LONG (CDDDDR OBJECT))))))) 
(DEFPROP |(SET YOUR WHOLE TO ?)| (SET YOUR WHOLE TO ?) PATTERN) 
(DEFUN D0067 NIL
  ((LAMBDA (NEW-PARENT)
     (LET*
      ((NAME
        (LET
         ((*MESSAGE '(RECALL YOUR NAME)))
         (QUICK-COMPILED-ASK
          '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
          '#,(ACTOR-OF (QUOTE SOMETHING)))))
       (INTERNED? (AND NAME (INTERNEDP NAME))))
      (LET
       ((*MESSAGE
         '(SEQUENTIALLY (ASK YOUR PARENT REMOVE ,NAME FROM YOUR LIST OF OFFSPRING))))
       (QUICK-COMPILED-ASK
        '#,(METHOD-AT-POSITION (|(SEQUENTIALLY (ASK YOUR ? %) %)| 0) SOMETHING)
        '#,(ACTOR-OF (QUOTE SOMETHING))))
      (CHANGE-PARENT-OF MYSELF (NAME-OR-ACTOR-OF NEW-PARENT))
      (COND (INTERNED?
             (LET
              ((MYSELF (ACTOR-OF NEW-PARENT))
               (*MESSAGE
                '(SET
                  YOUR
                  OFFSPRING
                  TO
                  ,(CONS-IF-NOT-MEMBER
                    (QUOTE-IF-NEED-BE ,NAME)
                    (ASK ,NEW-PARENT RECALL YOUR OFFSPRING)))))
              (QUICK-COMPILED-ASK
               '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
               '#,(ACTOR-OF (QUOTE SOMETHING)))))))
     NEW-PARENT)
   (CAR (CDDDDR *MESSAGE)))) 
(DEFUN |(SET YOUR PARENT TO ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE SET))
   (AND
    (EQ (CADR OBJECT) (QUOTE YOUR))
    (AND
     (EQ (CADDR OBJECT) (QUOTE PARENT))
     (AND (EQ (CADDDR OBJECT) (QUOTE TO)) (ONE-LONG (CDDDDR OBJECT))))))) 
(DEFPROP |(SET YOUR PARENT TO ?)| (SET YOUR PARENT TO ?) PATTERN) 
(DEFUN D0066 NIL (PARENT-OF MYSELF)) 
(DEFUN D0065 NIL (CHILDLESS-DESCENDANTS-OF MYSELF)) 
(DEFUN D0064 NIL
  (MAPCAN
   'DESCENDANTS-OF-INCLUDING-SELF
   (LET
    ((*MESSAGE '(RECALL YOUR OFFSPRING)))
    (QUICK-COMPILED-ASK
     '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
     '#,(ACTOR-OF (QUOTE SOMETHING)))))) 
(DEFUN D0063 NIL
  (SAFE-DELETE
   MYSELF
   (LET
    ((PARENT
      (LET
       ((*MESSAGE '(RECALL YOUR PARENT)))
       (QUICK-COMPILED-ASK
        '#,(METHOD-AT-POSITION ((RECALL YOUR PARENT) 0) SOMETHING)
        '#,(ACTOR-OF (QUOTE SOMETHING))))))
    (AND
     PARENT
     (LET
      ((MYSELF (ACTOR-OF PARENT)) (*MESSAGE '(RECALL YOUR OFFSPRING)))
      (QUICK-COMPILED-ASK
       '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
       '#,(ACTOR-OF (QUOTE SOMETHING)))))))) 
(DEFUN D0062 NIL
  ((LAMBDA (FORM PATTERN) (INSERT-MACRO-METHOD PATTERN FORM MYSELF))
   (CDR (CDDDDR *MESSAGE)) (CAR (CDDDDR *MESSAGE)))) 
(DEFUN |(MACRO EXPAND WHEN RECEIVING ? %)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE MACRO))
   (AND
    (EQ (CADR OBJECT) (QUOTE EXPAND))
    (AND
     (EQ (CADDR OBJECT) (QUOTE WHEN))
     (AND (EQ (CADDDR OBJECT) (QUOTE RECEIVING)) (LISTP (CDDDDR OBJECT))))))) 
(DEFPROP |(MACRO EXPAND WHEN RECEIVING ? %)| (MACRO EXPAND WHEN RECEIVING ? %) PATTERN) 
(DEFUN D0061 NIL
  ((LAMBDA (ACTION PATTERN) (INSERT-METHOD PATTERN ACTION MYSELF)) (CDDDDR *MESSAGE)
   (CADDDR *MESSAGE))) 
(DEFUN |(DO WHEN RECEIVING ? %)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE DO))
   (AND
    (EQ (CADR OBJECT) (QUOTE WHEN))
    (AND (EQ (CADDR OBJECT) (QUOTE RECEIVING)) (LISTP (CDDDR OBJECT)))))) 
(DEFPROP |(DO WHEN RECEIVING ? %)| (DO WHEN RECEIVING ? %) PATTERN) 
(DEFUN D0060 NIL
  ((LAMBDA (ACTION PATTERN)
     (LET
      ((*REPLACE-OLD-METHODS NIL))
      (INSERT-METHOD PATTERN '((REMOVE-CURRENT-METHOD) !,ACTION) MYSELF)))
   (CDR (CDDDDR *MESSAGE)) (CAR (CDDDDR *MESSAGE)))) 
(DEFUN |(DO ONCE WHEN RECEIVING ? %)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE DO))
   (AND
    (EQ (CADR OBJECT) (QUOTE ONCE))
    (AND
     (EQ (CADDR OBJECT) (QUOTE WHEN))
     (AND (EQ (CADDDR OBJECT) (QUOTE RECEIVING)) (LISTP (CDDDDR OBJECT))))))) 
(DEFPROP |(DO ONCE WHEN RECEIVING ? %)| (DO ONCE WHEN RECEIVING ? %) PATTERN) 
(DEFUN D0059 (MESSAGE)
  (COND ((AND
          (EQ (CAR MESSAGE) (QUOTE DO))
          (COND ((AND
                  (AND
                   (EQ (CADR MESSAGE) (QUOTE ONCE))
                   (AND
                    (EQ (CADDR MESSAGE) (QUOTE WHEN))
                    (AND
                     (EQ (CADDDR MESSAGE) (QUOTE RECEIVING))
                     (LISTP (CDDDDR MESSAGE)))))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION (|(DO ONCE WHEN RECEIVING ? %)| 0) SOMETHING))))
                ((AND
                  (AND
                   (EQ (CADR MESSAGE) (QUOTE WHEN))
                   (AND (EQ (CADDR MESSAGE) (QUOTE RECEIVING)) (LISTP (CDDDR MESSAGE))))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION (|(DO WHEN RECEIVING ? %)| 0) SOMETHING))))
                ((AND
                  (AND
                   (EQ (CADR MESSAGE) (QUOTE ONLY))
                   (AND
                    (EQ (CADDR MESSAGE) (QUOTE FOR))
                    (AND
                     (EQ (CADDDR MESSAGE) (QUOTE YOURSELF))
                     (AND
                      (EQ (CAR (CDDDDR MESSAGE)) (QUOTE WHEN))
                      (AND
                       (EQ (CADR (CDDDDR MESSAGE)) (QUOTE RECEIVING))
                       (LISTP (CDDR (CDDDDR MESSAGE))))))))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION
                       (|(DO ONLY FOR YOURSELF WHEN RECEIVING ? %)| 0)
                       SOMETHING))))
                ((AND
                  (AND (MEMQ (CADR MESSAGE) (QUOTE (AT IN))) (LISTP (CDDDR MESSAGE)))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION (|(DO {or AT IN} ? ? %)| 0) SOMETHING)))))))
        ((AND
          (AND
           (EQ (CAR MESSAGE) (QUOTE MACRO))
           (AND
            (EQ (CADR MESSAGE) (QUOTE EXPAND))
            (AND
             (EQ (CADDR MESSAGE) (QUOTE WHEN))
             (AND (EQ (CADDDR MESSAGE) (QUOTE RECEIVING)) (LISTP (CDDDDR MESSAGE))))))
          (METHOD-IF-NOT-HIDDEN
           '#,(METHOD-AT-POSITION (|(MACRO EXPAND WHEN RECEIVING ? %)| 0) SOMETHING))))
        ((AND
          (EQ (CAR MESSAGE) (QUOTE RECALL))
          (COND ((AND
                  (EQ (CADR MESSAGE) (QUOTE YOUR))
                  (COND ((AND
                          (EQ (CADDR MESSAGE) (QUOTE SIBLINGS))
                          (AND
                           (NULL (CDDDR MESSAGE))
                           (OR
                            (METHOD-IF-NOT-HIDDEN
                             '#,(METHOD-AT-POSITION ((RECALL YOUR SIBLINGS) 0) SOMETHING))
                            (METHOD-IF-NOT-HIDDEN
                             '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING))))))
                        ((AND
                          (EQ (CADDR MESSAGE) (QUOTE DESCENDANTS))
                          (AND
                           (NULL (CDDDR MESSAGE))
                           (OR
                            (METHOD-IF-NOT-HIDDEN
                             '#,(METHOD-AT-POSITION
                                 ((RECALL YOUR DESCENDANTS) 0)
                                 SOMETHING))
                            (METHOD-IF-NOT-HIDDEN
                             '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING))))))
                        ((AND
                          (EQ (CADDR MESSAGE) (QUOTE CHILDLESS-DESCENDANTS))
                          (AND
                           (NULL (CDDDR MESSAGE))
                           (OR
                            (METHOD-IF-NOT-HIDDEN
                             '#,(METHOD-AT-POSITION
                                 ((RECALL YOUR CHILDLESS-DESCENDANTS) 0)
                                 SOMETHING))
                            (METHOD-IF-NOT-HIDDEN
                             '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING))))))
                        ((AND
                          (EQ (CADDR MESSAGE) (QUOTE PARENT))
                          (AND
                           (NULL (CDDDR MESSAGE))
                           (OR
                            (METHOD-IF-NOT-HIDDEN
                             '#,(METHOD-AT-POSITION ((RECALL YOUR PARENT) 0) SOMETHING))
                            (METHOD-IF-NOT-HIDDEN
                             '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING))))))
                        ((AND
                          (ONE-LONG (CDDR MESSAGE))
                          (METHOD-IF-NOT-HIDDEN
                           '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)))))))
                ((AND
                  (EQ (CADR MESSAGE) (QUOTE EACH))
                  (COND ((AND
                          (AND
                           (EQ (CADDR MESSAGE) (QUOTE OF))
                           (AND
                            (EQ (CADDDR MESSAGE) (QUOTE YOUR))
                            (ONE-LONG (CDDDDR MESSAGE))))
                          (METHOD-IF-NOT-HIDDEN
                           '#,(METHOD-AT-POSITION
                               (|(RECALL EACH OF YOUR ?)| 0)
                               SOMETHING))))
                        ((AND
                          (AND
                           (EQ (CADDR MESSAGE) (QUOTE ITEM))
                           (AND
                            (EQ (CADDDR MESSAGE) (QUOTE MATCHING))
                            (EQ (CADR (CDDDDR MESSAGE)) (QUOTE THEN))))
                          (METHOD-IF-NOT-HIDDEN
                           '#,(METHOD-AT-POSITION
                               (|(RECALL EACH ITEM MATCHING ? THEN %)| 0)
                               SOMETHING)))))))
                ((AND
                  (AND
                   (EQ (CADR MESSAGE) (QUOTE ALL))
                   (AND
                    (EQ (CADDR MESSAGE) (QUOTE POSSIBLE))
                    (AND
                     (EQ (CADDDR MESSAGE) (QUOTE ITEMS))
                     (AND
                      (EQ (CAR (CDDDDR MESSAGE)) (QUOTE MATCHING))
                      (ONE-LONG (CDR (CDDDDR MESSAGE)))))))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION
                       (|(RECALL ALL POSSIBLE ITEMS MATCHING ?)| 0)
                       SOMETHING))))
                ((AND
                  (AND
                   (EQ (CADR MESSAGE) (QUOTE AN))
                   (AND
                    (EQ (CADDR MESSAGE) (QUOTE ITEM))
                    (AND
                     (EQ (CADDDR MESSAGE) (QUOTE MATCHING))
                     (EQ (CADR (CDDDDR MESSAGE)) (QUOTE THEN)))))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION
                       (|(RECALL AN ITEM MATCHING ? THEN %)| 0)
                       SOMETHING)))))))
        ((AND
          (EQ (CAR MESSAGE) (QUOTE SET))
          (AND
           (EQ (CADR MESSAGE) (QUOTE YOUR))
           (COND ((AND
                   (EQ (CADDR MESSAGE) (QUOTE PARENT))
                   (AND
                    (AND (EQ (CADDDR MESSAGE) (QUOTE TO)) (ONE-LONG (CDDDDR MESSAGE)))
                    (OR
                     (METHOD-IF-NOT-HIDDEN
                      '#,(METHOD-AT-POSITION (|(SET YOUR PARENT TO ?)| 0) SOMETHING))
                     (METHOD-IF-NOT-HIDDEN
                      '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING))))))
                 ((AND
                   (EQ (CADDR MESSAGE) (QUOTE WHOLE))
                   (AND
                    (AND (EQ (CADDDR MESSAGE) (QUOTE TO)) (ONE-LONG (CDDDDR MESSAGE)))
                    (OR
                     (METHOD-IF-NOT-HIDDEN
                      '#,(METHOD-AT-POSITION (|(SET YOUR WHOLE TO ?)| 0) SOMETHING))
                     (METHOD-IF-NOT-HIDDEN
                      '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING))))))
                 ((AND
                   (AND (EQ (CADDDR MESSAGE) (QUOTE TO)) (ONE-LONG (CDDDDR MESSAGE)))
                   (METHOD-IF-NOT-HIDDEN
                    '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING))))))))
        ((AND
          (EQ (CAR MESSAGE) (QUOTE FORGET))
          (COND ((AND
                  (AND (EQ (CADR MESSAGE) (QUOTE YOUR)) (ONE-LONG (CDDR MESSAGE)))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION (|(FORGET YOUR ?)| 0) SOMETHING))))
                ((AND
                  (EQUAL (CDR MESSAGE) (QUOTE (EVERYTHING)))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION ((FORGET EVERYTHING) 0) SOMETHING))))
                ((AND
                  (AND (EQ (CADR MESSAGE) (QUOTE ITEM)) (ONE-LONG (CDDR MESSAGE)))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION (|(FORGET ITEM ?)| 0) SOMETHING))))
                ((AND
                  (AND
                   (EQ (CADR MESSAGE) (QUOTE ITEMS))
                   (AND (EQ (CADDR MESSAGE) (QUOTE MATCHING)) (ONE-LONG (CDDDR MESSAGE))))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION (|(FORGET ITEMS MATCHING ?)| 0) SOMETHING)))))))
        ((AND
          (EQ (CAR MESSAGE) (QUOTE CONSIDER))
          (COND ((EQUAL (CDDR MESSAGE) (QUOTE (SYNONYMS)))
                 (METHOD-IF-NOT-HIDDEN
                  '#,(METHOD-AT-POSITION (|(CONSIDER ? SYNONYMS)| 0) SOMETHING)))
                ((AND
                  (EQ (CADDR MESSAGE) (QUOTE COMPONENTS))
                  (AND (EQ (CADDDR MESSAGE) (QUOTE OF)) (ONE-LONG (CDDDDR MESSAGE))))
                 (METHOD-IF-NOT-HIDDEN
                  '#,(METHOD-AT-POSITION (|(CONSIDER ? COMPONENTS OF ?)| 0) SOMETHING))))))
	((d0059-1 message))))

(DEFUN D0059-1 (MESSAGE)
       (cond
        ((AND
          (AND
           (EQ (CAR MESSAGE) (QUOTE WHEN))
           (AND
            (EQ (CADR MESSAGE) (QUOTE REPRESENTING))
            (AND
             (EQ (CADDDR MESSAGE) (QUOTE USE))
             (AND
              (EQ (CAR (CDDDDR MESSAGE)) (QUOTE AN))
              (AND
               (EQ (CADR (CDDDDR MESSAGE)) (QUOTE ARRAY))
               (AND
                (EQ (CADDR (CDDDDR MESSAGE)) (QUOTE OF))
                (AND
                 (EQ (CADDDR (CDDDDR MESSAGE)) (QUOTE SIZE))
                 (ONE-LONG (CDDDDR (CDDDDR MESSAGE))))))))))
          (METHOD-IF-NOT-HIDDEN
           '#,(METHOD-AT-POSITION
               (|(WHEN REPRESENTING ? USE AN ARRAY OF SIZE ?)| 0)
               SOMETHING))))
        ((AND
          (AND
           (EQ (CAR MESSAGE) (QUOTE CHANGE))
           (AND
            (EQ (CADR MESSAGE) (QUOTE YOUR))
            (AND (EQ (CADDDR MESSAGE) (QUOTE TO)) (ONE-LONG (CDDDDR MESSAGE)))))
          (METHOD-IF-NOT-HIDDEN
           '#,(METHOD-AT-POSITION (|(CHANGE YOUR ? TO ?)| 0) SOMETHING))))
        ((AND
          (EQ (CAR MESSAGE) (QUOTE TO))
          (METHOD-IF-NOT-HIDDEN '#,(METHOD-AT-POSITION (|(TO %)| 0) SOMETHING))))
        ((AND
          (AND
           (EQ (CAR MESSAGE) (QUOTE INCREMENT))
           (AND
            (EQ (CADR MESSAGE) (QUOTE YOUR))
            (AND (EQ (CADDDR MESSAGE) (QUOTE BY)) (ONE-LONG (CDDDDR MESSAGE)))))
          (METHOD-IF-NOT-HIDDEN
           '#,(METHOD-AT-POSITION (|(INCREMENT YOUR ? BY ?)| 0) SOMETHING))))
        ((AND
          (AND
           (EQ (CAR MESSAGE) (QUOTE MULTIPLY))
           (AND
            (EQ (CADR MESSAGE) (QUOTE YOUR))
            (AND (EQ (CADDDR MESSAGE) (QUOTE BY)) (ONE-LONG (CDDDDR MESSAGE)))))
          (METHOD-IF-NOT-HIDDEN
           '#,(METHOD-AT-POSITION (|(MULTIPLY YOUR ? BY ?)| 0) SOMETHING))))
        ((AND
          (EQ (CAR MESSAGE) (QUOTE ADD))
          (COND ((AND
                  (EQ (CADDR MESSAGE) (QUOTE TO))
                  (AND
                   (EQ (CADDDR MESSAGE) (QUOTE YOUR))
                   (AND
                    (EQ (CAR (CDDDDR MESSAGE)) (QUOTE LIST))
                    (AND
                     (EQ (CADR (CDDDDR MESSAGE)) (QUOTE OF))
                     (ONE-LONG (CDDR (CDDDDR MESSAGE)))))))
                 (METHOD-IF-NOT-HIDDEN
                  '#,(METHOD-AT-POSITION (|(ADD ? TO YOUR LIST OF ?)| 0) SOMETHING)))
                ((AND
                  (EQ (CADDR MESSAGE) (QUOTE TO))
                  (AND
                   (EQ (CADDDR MESSAGE) (QUOTE YOUR))
                   (AND
                    (EQ (CAR (CDDDDR MESSAGE)) (QUOTE LIST))
                    (AND
                     (EQ (CADR (CDDDDR MESSAGE)) (QUOTE OF))
                     (EQUAL (CDDDR (CDDDDR MESSAGE)) (QUOTE (REGARDLESS)))))))
                 (METHOD-IF-NOT-HIDDEN
                  '#,(METHOD-AT-POSITION
                      (|(ADD ? TO YOUR LIST OF ? REGARDLESS)| 0)
                      SOMETHING))))))
        ((AND
          (AND
           (EQ (CAR MESSAGE) (QUOTE REMOVE))
           (AND
            (EQ (CADDR MESSAGE) (QUOTE FROM))
            (AND
             (EQ (CADDDR MESSAGE) (QUOTE YOUR))
             (AND
              (EQ (CAR (CDDDDR MESSAGE)) (QUOTE LIST))
              (AND
               (EQ (CADR (CDDDDR MESSAGE)) (QUOTE OF))
               (ONE-LONG (CDDR (CDDDDR MESSAGE))))))))
          (METHOD-IF-NOT-HIDDEN
           '#,(METHOD-AT-POSITION (|(REMOVE ? FROM YOUR LIST OF ?)| 0) SOMETHING))))
        ((AND
          (EQUAL MESSAGE (QUOTE (LIST ALL YOUR VARIABLE NAMES)))
          (METHOD-IF-NOT-HIDDEN
           '#,(METHOD-AT-POSITION ((LIST ALL YOUR VARIABLE NAMES) 0) SOMETHING))))
        ((AND
          (EQ (CAR MESSAGE) (QUOTE MAKE))
          (COND ((AND
                  (EQ (CADR MESSAGE) (QUOTE AN))
                  (COND ((AND
                          (AND
                           (EQ (CADDR MESSAGE) (QUOTE INSTANCE))
                           (AND
                            (EQ (CADDDR MESSAGE) (QUOTE NAMED))
                            (AND
                             (EQ (CADR (CDDDDR MESSAGE)) (QUOTE COPYING))
                             (ONE-LONG (CDDR (CDDDDR MESSAGE))))))
                          (METHOD-IF-NOT-HIDDEN
                           '#,(METHOD-AT-POSITION
                               (|(MAKE AN INSTANCE NAMED ? COPYING ?)| 0)
                               SOMETHING))))
                        ((AND
                          (NULL (CDDR MESSAGE))
                          (METHOD-IF-NOT-HIDDEN
                           '#,(METHOD-AT-POSITION (|(MAKE ?)| 0) SOMETHING)))))))
                ((AND
                  (NULL (CDR MESSAGE))
                  (METHOD-IF-NOT-HIDDEN '#,(METHOD-AT-POSITION ((MAKE) 0) SOMETHING))))
                ((COND ((ONE-LONG (CDR MESSAGE))
                        (METHOD-IF-NOT-HIDDEN
                         '#,(METHOD-AT-POSITION (|(MAKE ?)| 0) SOMETHING)))
                       ((EQUAL (CDR MESSAGE) (QUOTE (UP AN UNINTERNED NAME)))
                        (METHOD-IF-NOT-HIDDEN
                         '#,(METHOD-AT-POSITION
                             ((MAKE UP AN UNINTERNED NAME) 0)
                             SOMETHING)))))
                ((AND
                  (EQ (CADR MESSAGE) (QUOTE UP))
                  (COND ((AND
                          (EQUAL (CDDR MESSAGE) (QUOTE (A NAME)))
                          (METHOD-IF-NOT-HIDDEN
                           '#,(METHOD-AT-POSITION ((MAKE UP A NAME) 0) SOMETHING))))
                        ((AND
                          (NULL (CDDR MESSAGE))
                          (METHOD-IF-NOT-HIDDEN
                           '#,(METHOD-AT-POSITION (|(MAKE ?)| 0) SOMETHING))))
                        ((AND
                          (EQUAL (CDDR MESSAGE) (QUOTE (AN UNINTERNED NAME)))
                          (METHOD-IF-NOT-HIDDEN
                           '#,(METHOD-AT-POSITION
                               ((MAKE UP AN UNINTERNED NAME) 0)
                               SOMETHING)))))))
                ((AND
                  (EQ (CADR MESSAGE) (QUOTE SYNONYM))
                  (COND ((AND
                          (ONE-LONG (CDDR MESSAGE))
                          (METHOD-IF-NOT-HIDDEN
                           '#,(METHOD-AT-POSITION (|(MAKE SYNONYM ?)| 0) SOMETHING))))
                        ((AND
                          (NULL (CDDR MESSAGE))
                          (METHOD-IF-NOT-HIDDEN
                           '#,(METHOD-AT-POSITION (|(MAKE ?)| 0) SOMETHING))))
                        ((AND
                          (EQ (CADDR MESSAGE) (QUOTE AN))
                          (COND ((AND
                                  (EQUAL (CDDDR MESSAGE) (QUOTE (UNINTERNED NAME)))
                                  (METHOD-IF-NOT-HIDDEN
                                   '#,(METHOD-AT-POSITION
                                       ((MAKE UP AN UNINTERNED NAME) 0)
                                       SOMETHING))))
                                ((AND
                                  (NULL (CDDDR MESSAGE))
                                  (METHOD-IF-NOT-HIDDEN
                                   '#,(METHOD-AT-POSITION
                                       (|(MAKE SYNONYM ?)| 0)
                                       SOMETHING)))))))))))))
	((d0059-2 message))))
(DEFUN D0059-2 (MESSAGE)
       (cond
        ((AND
          (AND
           (EQ (CAR MESSAGE) (QUOTE IF))
           (AND
            (EQ (CADR MESSAGE) (QUOTE NEW))
            (AND (EQ (CADDR MESSAGE) (QUOTE MAKE)) (ONE-LONG (CDDDR MESSAGE)))))
          (METHOD-IF-NOT-HIDDEN '#,(METHOD-AT-POSITION (|(IF NEW MAKE ?)| 0) SOMETHING))))
        ((AND
          (EQ (CAR MESSAGE) (QUOTE CLONE))
          (COND ((AND
                  (NULL (CDR MESSAGE))
                  (METHOD-IF-NOT-HIDDEN '#,(METHOD-AT-POSITION ((CLONE) 0) SOMETHING))))
                ((AND
                  (AND
                   (EQ (CADR MESSAGE) (QUOTE AND))
                   (AND
                    (EQ (CADDR MESSAGE) (QUOTE NAME))
                    (AND (EQ (CADDDR MESSAGE) (QUOTE IT)) (ONE-LONG (CDDDDR MESSAGE)))))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION (|(CLONE AND NAME IT ?)| 0) SOMETHING)))))))
        ((AND
          (EQUAL MESSAGE (QUOTE (ABSORB YOUR PARTS)))
          (METHOD-IF-NOT-HIDDEN
           '#,(METHOD-AT-POSITION ((ABSORB YOUR PARTS) 0) SOMETHING))))
        ((AND
          (EQUAL MESSAGE (QUOTE (REMOB)))
          (METHOD-IF-NOT-HIDDEN '#,(METHOD-AT-POSITION ((REMOB) 0) SOMETHING))))
        ((AND
          (EQUAL MESSAGE (QUOTE (DISEMBODY)))
          (METHOD-IF-NOT-HIDDEN '#,(METHOD-AT-POSITION ((DISEMBODY) 0) SOMETHING))))
        ((AND
          (EQUAL MESSAGE (QUOTE (UNMAKE)))
          (METHOD-IF-NOT-HIDDEN '#,(METHOD-AT-POSITION ((UNMAKE) 0) SOMETHING))))
        ((AND
          (AND (EQ (CAR MESSAGE) (QUOTE MEMORIZE)) (ONE-LONG (CDR MESSAGE)))
          (METHOD-IF-NOT-HIDDEN '#,(METHOD-AT-POSITION (|(MEMORIZE ?)| 0) SOMETHING))))
        ((AND
          (AND
           (EQ (CAR MESSAGE) (QUOTE COLLECT))
           (AND
            (EQ (CADR MESSAGE) (QUOTE ITEMS))
            (AND
             (EQ (CADDR MESSAGE) (QUOTE MEMORIZED))
             (AND (EQ (CADDDR MESSAGE) (QUOTE MATCHING)) (ONE-LONG (CDDDDR MESSAGE))))))
          (METHOD-IF-NOT-HIDDEN
           '#,(METHOD-AT-POSITION (|(COLLECT ITEMS MEMORIZED MATCHING ?)| 0) SOMETHING))))
        ((AND
          (EQUAL MESSAGE (QUOTE (TICK)))
          (METHOD-IF-NOT-HIDDEN '#,(METHOD-AT-POSITION ((TICK) 0) SOMETHING))))
        ((AND
          (AND
           (EQ (CAR MESSAGE) (QUOTE PLAN))
           (AND
            (EQ (CADR MESSAGE) (QUOTE AFTER))
            (AND
             (EQ (CADDR MESSAGE) (QUOTE RECEIVING))
             (AND
              (EQ (CAR (CDDDDR MESSAGE)) (QUOTE TO))
              (ONE-LONG (CDR (CDDDDR MESSAGE)))))))
          (METHOD-IF-NOT-HIDDEN
           '#,(METHOD-AT-POSITION (|(PLAN AFTER RECEIVING ? TO ?)| 0) SOMETHING))))
        ((AND
          (LET ((? (CAR MESSAGE))) (MEMQ ? '(PLAN GRADUALLY REPEAT ASK BROADCAST)))
          (METHOD-IF-NOT-HIDDEN
           '#,(METHOD-AT-POSITION
               (|({MEMQ ? '(PLAN GRADUALLY REPEAT ASK BROADCAST)} %)| 0)
               SOMETHING))))
	((d0059-3 message))))
(DEFUN D0059-3 (MESSAGE)
       (cond
        ((AND
          (EQ (CAR MESSAGE) (QUOTE SEQUENTIALLY))
          (COND ((AND
                  (AND
                   (LISTP (CADR MESSAGE))
                   (EQ (CAADR MESSAGE) (QUOTE PLAN))
                   (AND (LISTP (CDADR MESSAGE)) (EQ (CADADR MESSAGE) (QUOTE NEXT))))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION (|(SEQUENTIALLY (PLAN NEXT %) %)| 0) SOMETHING))))
                ((AND
                  (AND
                   (LISTP (CADR MESSAGE))
                   (EQ (CAADR MESSAGE) (QUOTE PLAN))
                   (AND
                    (LISTP (CDADR MESSAGE))
                    (EQ (CADADR MESSAGE) (QUOTE AFTER))
                    (AND (LISTP (CDDADR MESSAGE)) (LISTP (CDR (CDDADR MESSAGE))))))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION
                       (|(SEQUENTIALLY (PLAN AFTER ? ? %) %)| 0)
                       SOMETHING))))
                ((AND
                  (AND (LISTP (CADR MESSAGE)) (EQ (CAADR MESSAGE) (QUOTE CONCURRENTLY)))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION
                       (|(SEQUENTIALLY (CONCURRENTLY %) %)| 0)
                       SOMETHING))))
                ((AND
                  (AND
                   (LISTP (CADR MESSAGE))
                   (EQ (CAADR MESSAGE) (QUOTE REPEAT))
                   (AND
                    (LISTP (CDADR MESSAGE))
                    (EQUAL (CDDADR MESSAGE) (QUOTE (FOREVER)))))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION
                       (|(SEQUENTIALLY (REPEAT ? FOREVER) %)| 0)
                       SOMETHING))))
                ((AND
                  (AND
                   (LISTP (CADR MESSAGE))
                   (EQ (CAADR MESSAGE) (QUOTE REPEAT))
                   (AND
                    (LISTP (CDADR MESSAGE))
                    (AND
                     (LISTP (CDDADR MESSAGE))
                     (EQUAL (CDR (CDDADR MESSAGE)) (QUOTE (TIMES))))))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION
                       (|(SEQUENTIALLY (REPEAT ? ? TIMES) %)| 0)
                       SOMETHING))))
                ((AND
                  (AND
                   (LISTP (CADR MESSAGE))
                   (EQ (CAADR MESSAGE) (QUOTE DO))
                   (AND
                    (LISTP (CDADR MESSAGE))
                    (EQ (CADADR MESSAGE) (QUOTE AT))
                    (AND
                     (LISTP (CDDADR MESSAGE))
                     (EQ (CAR (CDDADR MESSAGE)) (QUOTE SPEED))
                     (AND
                      (LISTP (CDR (CDDADR MESSAGE)))
                      (AND
                       (LISTP (CDDR (CDDADR MESSAGE)))
                       (EQ (CADDR (CDDADR MESSAGE)) (QUOTE ASK))
                       (AND
                        (LISTP (CDDDR (CDDADR MESSAGE)))
                        (AND
                         (LISTP (CDDDDR (CDDADR MESSAGE)))
                         (MEMQ (CAR (CDDDDR (CDDADR MESSAGE))) (QUOTE (SET CHANGE)))
                         (AND
                          (LISTP (CDR (CDDDDR (CDDADR MESSAGE))))
                          (EQ (CADR (CDDDDR (CDDADR MESSAGE))) (QUOTE YOUR))
                          (AND
                           (LISTP (CDDR (CDDDDR (CDDADR MESSAGE))))
                           (AND
                            (LISTP (CDDDR (CDDDDR (CDDADR MESSAGE))))
                            (EQ (CADDDR (CDDDDR (CDDADR MESSAGE))) (QUOTE TO))
                            (ONE-LONG (CDDDDR (CDDDDR (CDDADR MESSAGE))))))))))))))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION
                       (|(SEQUENTIALLY (DO AT SPEED ? ASK ? {or SET CHANGE} YOUR ? TO ?) %)|
                        0)
                       SOMETHING))))
                ((AND
                  (AND
                   (LISTP (CADR MESSAGE))
                   (EQ (CAADR MESSAGE) (QUOTE DO))
                   (AND
                    (LISTP (CDADR MESSAGE))
                    (EQ (CADADR MESSAGE) (QUOTE AT))
                    (AND
                     (LISTP (CDDADR MESSAGE))
                     (EQ (CAR (CDDADR MESSAGE)) (QUOTE SPEED))
                     (AND
                      (LISTP (CDR (CDDADR MESSAGE)))
                      (AND
                       (LISTP (CDDR (CDDADR MESSAGE)))
                       (MEMQ (CADDR (CDDADR MESSAGE)) (QUOTE (SET CHANGE)))
                       (AND
                        (LISTP (CDDDR (CDDADR MESSAGE)))
                        (EQ (CADDDR (CDDADR MESSAGE)) (QUOTE YOUR))
                        (AND
                         (LISTP (CDDDDR (CDDADR MESSAGE)))
                         (AND
                          (LISTP (CDR (CDDDDR (CDDADR MESSAGE))))
                          (EQ (CADR (CDDDDR (CDDADR MESSAGE))) (QUOTE TO))
                          (ONE-LONG (CDDR (CDDDDR (CDDADR MESSAGE))))))))))))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION
                       (|(SEQUENTIALLY (DO AT SPEED ? {or SET CHANGE} YOUR ? TO ?) %)|
                        0)
                       SOMETHING))))
                ((AND
                  (AND
                   (LISTP (CADR MESSAGE))
                   (EQ (CAADR MESSAGE) (QUOTE DO))
                   (AND
                    (LISTP (CDADR MESSAGE))
                    (EQ (CADADR MESSAGE) (QUOTE IN))
                    (AND
                     (LISTP (CDDADR MESSAGE))
                     (AND
                      (LISTP (CDR (CDDADR MESSAGE)))
                      (AND
                       (LISTP (CDDR (CDDADR MESSAGE)))
                       (LET
                        ((REVERSED-OBJECT (REVERSE (CDDR (CDDADR MESSAGE)))))
                        (LISTP REVERSED-OBJECT)))))))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION
                       (|(SEQUENTIALLY (DO IN ? ? % ?) %)| 0)
                       SOMETHING))))
                ((AND
                  (AND
                   (LISTP (CADR MESSAGE))
                   (EQ (CAADR MESSAGE) (QUOTE DO))
                   (AND
                    (LISTP (CDADR MESSAGE))
                    (EQ (CADADR MESSAGE) (QUOTE AT))
                    (AND
                     (LISTP (CDDADR MESSAGE))
                     (EQ (CAR (CDDADR MESSAGE)) (QUOTE SPEED))
                     (AND
                      (LISTP (CDR (CDDADR MESSAGE)))
                      (AND
                       (LISTP (CDDR (CDDADR MESSAGE)))
                       (LET
                        ((REVERSED-OBJECT (REVERSE (CDDR (CDDADR MESSAGE)))))
                        (LISTP REVERSED-OBJECT)))))))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION
                       (|(SEQUENTIALLY (DO AT SPEED ? % ?) %)| 0)
                       SOMETHING))))
                ((AND
                  (AND
                   (LISTP (CADR MESSAGE))
                   (EQ (CAADR MESSAGE) (QUOTE GRADUALLY))
                   (AND
                    (LISTP (CDADR MESSAGE))
                    (EQ (CADADR MESSAGE) (QUOTE ASK))
                    (AND
                     (LISTP (CDDADR MESSAGE))
                     (AND
                      (LISTP (CDR (CDDADR MESSAGE)))
                      (MEMQ (CADR (CDDADR MESSAGE)) (QUOTE (SET CHANGE)))
                      (AND
                       (LISTP (CDDR (CDDADR MESSAGE)))
                       (EQ (CADDR (CDDADR MESSAGE)) (QUOTE YOUR))
                       (AND
                        (LISTP (CDDDR (CDDADR MESSAGE)))
                        (AND
                         (LISTP (CDDDDR (CDDADR MESSAGE)))
                         (EQ (CAR (CDDDDR (CDDADR MESSAGE))) (QUOTE TO))
                         (ONE-LONG (CDR (CDDDDR (CDDADR MESSAGE)))))))))))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION
                       (|(SEQUENTIALLY (GRADUALLY ASK ? {or SET CHANGE} YOUR ? TO ?) %)|
                        0)
                       SOMETHING))))
                ((AND
                  (AND
                   (LISTP (CADR MESSAGE))
                   (EQ (CAADR MESSAGE) (QUOTE GRADUALLY))
                   (AND
                    (LISTP (CDADR MESSAGE))
                    (MEMQ (CADADR MESSAGE) (QUOTE (SET CHANGE)))
                    (AND
                     (LISTP (CDDADR MESSAGE))
                     (EQ (CAR (CDDADR MESSAGE)) (QUOTE YOUR))
                     (AND
                      (LISTP (CDR (CDDADR MESSAGE)))
                      (AND
                       (LISTP (CDDR (CDDADR MESSAGE)))
                       (EQ (CADDR (CDDADR MESSAGE)) (QUOTE TO))
                       (ONE-LONG (CDDDR (CDDADR MESSAGE))))))))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION
                       (|(SEQUENTIALLY (GRADUALLY {or SET CHANGE} YOUR ? TO ?) %)| 0)
                       SOMETHING))))
                ((AND
                  (AND
                   (LISTP (CADR MESSAGE))
                   (EQ (CAADR MESSAGE) (QUOTE GRADUALLY))
                   (AND
                    (LISTP (CDADR MESSAGE))
                    (EQ (CADADR MESSAGE) (QUOTE ASK))
                    (AND
                     (LISTP (CDDADR MESSAGE))
                     (AND
                      (LISTP (CDR (CDDADR MESSAGE)))
                      (LET
                       ((REVERSED-OBJECT (REVERSE (CDR (CDDADR MESSAGE)))))
                       (LISTP REVERSED-OBJECT))))))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION
                       (|(SEQUENTIALLY (GRADUALLY ASK ? % ?) %)| 0)
                       SOMETHING))))
                ((AND
                  (AND
                   (LISTP (CADR MESSAGE))
                   (EQ (CAADR MESSAGE) (QUOTE GRADUALLY))
                   (AND
                    (LISTP (CDADR MESSAGE))
                    (LET
                     ((REVERSED-OBJECT (REVERSE (CDADR MESSAGE))))
                     (LISTP REVERSED-OBJECT))))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION
                       (|(SEQUENTIALLY (GRADUALLY % ?) %)| 0)
                       SOMETHING))))
                ((AND
                  (AND
                   (LISTP (CADR MESSAGE))
                   (EQ (CAADR MESSAGE) (QUOTE BROADCAST))
                   (AND
                    (LISTP (CDADR MESSAGE))
                    (EQ (CADADR MESSAGE) (QUOTE OR))
                    (AND
                     (LISTP (CDDADR MESSAGE))
                     (EQ (CAR (CDDADR MESSAGE)) (QUOTE ASK))
                     (AND
                      (LISTP (CDR (CDDADR MESSAGE)))
                      (EQ (CADR (CDDADR MESSAGE)) (QUOTE YOUR))
                      (LISTP (CDDR (CDDADR MESSAGE)))))))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION
                       (|(SEQUENTIALLY (BROADCAST OR ASK YOUR ? %) %)| 0)
                       SOMETHING))))
                ((AND
                  (AND
                   (LISTP (CADR MESSAGE))
                   (EQ (CAADR MESSAGE) (QUOTE BROADCAST))
                   (AND
                    (LISTP (CDADR MESSAGE))
                    (EQ (CADADR MESSAGE) (QUOTE TO))
                    (AND
                     (LISTP (CDDADR MESSAGE))
                     (EQ (CAR (CDDADR MESSAGE)) (QUOTE YOUR))
                     (LISTP (CDR (CDDADR MESSAGE))))))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION
                       (|(SEQUENTIALLY (BROADCAST TO YOUR ? %) %)| 0)
                       SOMETHING))))
                ((AND
                  (AND
                   (LISTP (CADR MESSAGE))
                   (EQ (CAADR MESSAGE) (QUOTE ASK))
                   (AND
                    (LISTP (CDADR MESSAGE))
                    (EQ (CADADR MESSAGE) (QUOTE YOUR))
                    (LISTP (CDDADR MESSAGE))))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION
                       (|(SEQUENTIALLY (ASK YOUR ? %) %)| 0)
                       SOMETHING))))
                ((AND
                  (AND
                   (LISTP (CADR MESSAGE))
                   (EQ (CAADR MESSAGE) (QUOTE ASK))
                   (AND
                    (LISTP (CDADR MESSAGE))
                    (EQ (CADADR MESSAGE) (QUOTE EACH))
                    (AND
                     (LISTP (CDDADR MESSAGE))
                     (EQ (CAR (CDDADR MESSAGE)) (QUOTE OF))
                     (AND
                      (LISTP (CDR (CDDADR MESSAGE)))
                      (EQ (CADR (CDDADR MESSAGE)) (QUOTE YOUR))
                      (LISTP (CDDR (CDDADR MESSAGE)))))))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION
                       (|(SEQUENTIALLY (ASK EACH OF YOUR ? %) %)| 0)
                       SOMETHING))))
                ((AND
                  (AND
                   (LISTP (CADR MESSAGE))
                   (EQ (CAADR MESSAGE) (QUOTE ASK))
                   (AND
                    (LISTP (CDADR MESSAGE))
                    (EQ (CADADR MESSAGE) (QUOTE EACH))
                    (AND
                     (LISTP (CDDADR MESSAGE))
                     (EQ (CAR (CDDADR MESSAGE)) (QUOTE OF))
                     (LISTP (CDR (CDDADR MESSAGE))))))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION
                       (|(SEQUENTIALLY (ASK EACH OF ? %) %)| 0)
                       SOMETHING))))
                ((AND
                  (AND
                   (LISTP (CADR MESSAGE))
                   (EQ (CAADR MESSAGE) (QUOTE ASK))
                   (LISTP (CDADR MESSAGE)))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION (|(SEQUENTIALLY (ASK ? %) %)| 0) SOMETHING))))
                ((AND
                  T
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION (|(SEQUENTIALLY %)| 0) SOMETHING)))))))
        ((AND
          (EQUAL MESSAGE (QUOTE (STOP EVERYTHING)))
          (METHOD-IF-NOT-HIDDEN '#,(METHOD-AT-POSITION ((STOP EVERYTHING) 0) SOMETHING))))
	((d0059-4 message))))

(DEFUN D0059-4 (MESSAGE)
       (cond
        ((AND
          (AND (EQ (CAR MESSAGE) (QUOTE WAIT)) (EQ (CADR MESSAGE) (QUOTE FOR)))
          (METHOD-IF-NOT-HIDDEN '#,(METHOD-AT-POSITION (|(WAIT FOR %)| 0) SOMETHING))))
        ((AND
          (EQ (CAR MESSAGE) (QUOTE CONCURRENTLY))
          (METHOD-IF-NOT-HIDDEN '#,(METHOD-AT-POSITION (|(CONCURRENTLY %)| 0) SOMETHING))))
        ((AND
          (AND
           (EQ (CAR MESSAGE) (QUOTE DO))
           (AND (EQ (CADR MESSAGE) (QUOTE THE)) (EQ (CADDR MESSAGE) (QUOTE FOLLOWING))))
          (METHOD-IF-NOT-HIDDEN
           '#,(METHOD-AT-POSITION (|(DO THE FOLLOWING %)| 0) SOMETHING))))
        ((AND
          (AND
           (EQ (CAR MESSAGE) (QUOTE KEEP))
           (AND
            (EQ (CADR MESSAGE) (QUOTE DOING))
            (AND (EQ (CADDR MESSAGE) (QUOTE UNTIL)) (LISTP (CDDDR MESSAGE)))))
          (METHOD-IF-NOT-HIDDEN
           '#,(METHOD-AT-POSITION (|(KEEP DOING UNTIL ? %)| 0) SOMETHING))))
        ((AND
          (AND
           (EQ (CAR MESSAGE) (QUOTE ARE))
           (AND
            (EQ (CADR MESSAGE) (QUOTE YOU))
            (AND (MEMQ (CADDR MESSAGE) (QUOTE (A AN))) (ONE-LONG (CDDDR MESSAGE)))))
          (METHOD-IF-NOT-HIDDEN
           '#,(METHOD-AT-POSITION (|(ARE YOU {or A AN} ?)| 0) SOMETHING))))
        ((AND
          (AND
           (EQ (CAR MESSAGE) (QUOTE FIND))
           (AND
            (EQ (CADR MESSAGE) (QUOTE ANCESTOR))
            (AND (EQ (CADDR MESSAGE) (QUOTE MATCHING)) (ONE-LONG (CDDDR MESSAGE)))))
          (METHOD-IF-NOT-HIDDEN
           '#,(METHOD-AT-POSITION (|(FIND ANCESTOR MATCHING ?)| 0) SOMETHING))))
        ((AND
          (EQ (CAR MESSAGE) (QUOTE RECALL))
          (COND ((AND
                  (AND
                   (EQ (CADR MESSAGE) (QUOTE INTERNAL))
                   (AND
                    (EQ (CADDR MESSAGE) (QUOTE METHOD))
                    (EQ (CADDDR MESSAGE) (QUOTE FOR))))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION (|(RECALL INTERNAL METHOD FOR %)| 0) SOMETHING))))
                ((AND
                  (AND
                   (EQ (CADR MESSAGE) (QUOTE METHOD))
                   (EQ (CADDR MESSAGE) (QUOTE FOR)))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION (|(RECALL METHOD FOR %)| 0) SOMETHING)))))))
        ((AND
          (AND
           (EQ (CAR MESSAGE) (QUOTE REMOVE))
           (AND (EQ (CADR MESSAGE) (QUOTE METHOD)) (EQ (CADDR MESSAGE) (QUOTE FOR))))
          (METHOD-IF-NOT-HIDDEN
           '#,(METHOD-AT-POSITION (|(REMOVE METHOD FOR %)| 0) SOMETHING))))
        ((AND
          (EQ (CAR MESSAGE) (QUOTE TRACE))
          (METHOD-IF-NOT-HIDDEN '#,(METHOD-AT-POSITION (|(TRACE %)| 0) SOMETHING))))
        ((AND
          (EQ (CAR MESSAGE) (QUOTE UNTRACE))
          (COND ((AND
                  (ONE-LONG (CDR MESSAGE))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION (|(UNTRACE ?)| 0) SOMETHING))))
                ((AND
                  (NULL (CDR MESSAGE))
                  (METHOD-IF-NOT-HIDDEN '#,(METHOD-AT-POSITION ((UNTRACE) 0) SOMETHING))))))
         )
        ((AND
          (AND
           (EQ (CAR MESSAGE) (QUOTE CONSTRAIN))
           (AND
            (EQ (CADR MESSAGE) (QUOTE YOUR))
            (AND
             (EQ (CADDDR MESSAGE) (QUOTE TO))
             (AND
              (EQ (CAR (CDDDDR MESSAGE)) (QUOTE EQUAL))
              (AND
               (EQ (CADDR (CDDDDR MESSAGE)) (QUOTE OF))
               (AND
                (EQ (CAR (CDDDDR (CDDDDR MESSAGE))) (QUOTE OF))
                (ONE-LONG (CDR (CDDDDR (CDDDDR MESSAGE))))))))))
          (METHOD-IF-NOT-HIDDEN
           '#,(METHOD-AT-POSITION
               (|(CONSTRAIN YOUR ? TO EQUAL ? OF ? OF ?)| 0)
               SOMETHING))))
        ((AND
          (EQ (CAR MESSAGE) (QUOTE TELL))
          (COND ((AND
                  (AND
                   (EQ (CADR MESSAGE) (QUOTE EACH))
                   (AND
                    (EQ (CADDR MESSAGE) (QUOTE OF))
                    (AND
                     (EQ (CADDDR MESSAGE) (QUOTE YOUR))
                     (AND
                      (EQ (CADR (CDDDDR MESSAGE)) (QUOTE WHENEVER))
                      (AND
                       (EQ (CADDR (CDDDDR MESSAGE)) (QUOTE YOUR))
                       (EQUAL (CDDDDR (CDDDDR MESSAGE)) (QUOTE (IS CHANGED))))))))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION
                       (|(TELL EACH OF YOUR ? WHENEVER YOUR ? IS CHANGED)| 0)
                       SOMETHING))))
                ((AND
                  (AND
                   (EQ (CADR MESSAGE) (QUOTE YOUR))
                   (AND
                    (EQ (CADDDR MESSAGE) (QUOTE WHENEVER))
                    (AND
                     (EQ (CAR (CDDDDR MESSAGE)) (QUOTE YOUR))
                     (EQUAL (CDDR (CDDDDR MESSAGE)) (QUOTE (IS CHANGED))))))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION
                       (|(TELL YOUR ? WHENEVER YOUR ? IS CHANGED)| 0)
                       SOMETHING)))))))
        ((AND
          (AND
           (EQ (CAR MESSAGE) (QUOTE NOTICE))
           (AND
            (EQ (CADR MESSAGE) (QUOTE THAT))
            (AND
             (EQ (CADDDR MESSAGE) (QUOTE OF))
             (AND
              (EQ (CADR (CDDDDR MESSAGE)) (QUOTE IS))
              (AND
               (EQ (CADDR (CDDDDR MESSAGE)) (QUOTE NOW))
               (ONE-LONG (CDDDR (CDDDDR MESSAGE))))))))
          (METHOD-IF-NOT-HIDDEN
           '#,(METHOD-AT-POSITION (|(NOTICE THAT ? OF ? IS NOW ?)| 0) SOMETHING))))
	((d0059-5 message))))

(DEFUN D0059-5 (MESSAGE)
       (cond
        ((AND
          (EQ (CAR MESSAGE) (QUOTE PRINT))
          (COND ((AND
                  (AND
                   (LET
                    ((? (CADR MESSAGE)))
                    (MEMQ ? '(MEMORY VARIABLES SCRIPT DATABASE ALL)))
                   (AND
                    (EQ (CADDR MESSAGE) (QUOTE ON))
                    (AND (EQ (CADDDR MESSAGE) (QUOTE FILE)) (ONE-LONG (CDDDDR MESSAGE)))))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION
                       (|(PRINT {MEMQ ? '(MEMORY VARIABLES SCRIPT DATABASE ALL)} ON FILE ?)|
                        0)
                       SOMETHING))))
                ((AND
                  (AND
                   (LET
                    ((? (CADR MESSAGE)))
                    (MEMQ ? '(MEMORY VARIABLES SCRIPT DATABASE ALL)))
                   (NULL (CDDR MESSAGE)))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION
                       (|(PRINT {MEMQ ? '(MEMORY VARIABLES SCRIPT DATABASE ALL)})| 0)
                       SOMETHING))))
                ((AND
                  (NULL (CDR MESSAGE))
                  (METHOD-IF-NOT-HIDDEN '#,(METHOD-AT-POSITION ((PRINT) 0) SOMETHING))))
                ((AND
                  (AND (EQ (CADR MESSAGE) (QUOTE YOUR)) (ONE-LONG (CDDR MESSAGE)))
                  (METHOD-IF-NOT-HIDDEN
                   '#,(METHOD-AT-POSITION (|(PRINT YOUR ?)| 0) SOMETHING)))))))
        ((AND
          (AND
           (EQ (CAR MESSAGE) (QUOTE COMPARE))
           (AND
            (EQ (CADR MESSAGE) (QUOTE YOURSELF))
            (AND (EQ (CADDR MESSAGE) (QUOTE WITH)) (ONE-LONG (CDDDR MESSAGE)))))
          (METHOD-IF-NOT-HIDDEN
           '#,(METHOD-AT-POSITION (|(COMPARE YOURSELF WITH ?)| 0) SOMETHING))))
        ((AND
          (AND (EQ (CAR MESSAGE) (QUOTE COMPILE)) (EQ (CADR MESSAGE) (QUOTE MESSAGE)))
          (METHOD-IF-NOT-HIDDEN
           '#,(METHOD-AT-POSITION (|(COMPILE MESSAGE %)| 0) SOMETHING))))
        ((AND
          (EQ (CAR MESSAGE) (QUOTE SAVE))
          (METHOD-IF-NOT-HIDDEN '#,(METHOD-AT-POSITION (|(SAVE %)| 0) SOMETHING))))
        ((AND
          (EQ (CAR MESSAGE) (QUOTE HELP))
          (METHOD-IF-NOT-HIDDEN '#,(METHOD-AT-POSITION (|(HELP %)| 0) SOMETHING))))
        ((AND
          (EQ (CAR MESSAGE) (QUOTE WARNING))
          (METHOD-IF-NOT-HIDDEN '#,(METHOD-AT-POSITION (|(WARNING %)| 0) SOMETHING))))
        ((AND
          (AND
           (EQ (CAR MESSAGE) (QUOTE SHOULD))
           (AND (EQ (CADR MESSAGE) (QUOTE NOT)) (EQ (CADDR MESSAGE) (QUOTE HAPPEN))))
          (METHOD-IF-NOT-HIDDEN
           '#,(METHOD-AT-POSITION (|(SHOULD NOT HAPPEN %)| 0) SOMETHING)))))) 
(DEFUN D0171 NIL
  ((LAMBDA (UNITS NUMBER)
     (LET
      ((NUMBER (NUMBER-OF-TICKS NUMBER UNITS)))
      (LET
       ((*MESSAGE '(TICK)))
       (QUICK-COMPILED-ASK
        '#,(METHOD-AT-POSITION ((TICK) 0) CLOCK)
        '#,(ACTOR-OF (QUOTE CLOCK))))
      (COND ((> NUMBER 1)
             (LET
              ((*MESSAGE '(RUN FOR ,(1- NUMBER) TICKS)))
              (QUICK-COMPILED-ASK
               '#,(METHOD-AT-POSITION (|(RUN FOR ? ?)| 0) CLOCK)
               '#,(ACTOR-OF (QUOTE CLOCK))))))))
   (CADDDR *MESSAGE) (CADDR *MESSAGE))) 
(DEFUN |(RUN FOR ? ?)| (OBJECT)
  (AND
   (EQ (CAR OBJECT) (QUOTE RUN))
   (AND (EQ (CADR OBJECT) (QUOTE FOR)) (ONE-LONG (CDDDR OBJECT))))) 
(DEFPROP |(RUN FOR ? ?)| (RUN FOR ? ?) PATTERN) 
(DEFUN D0170 NIL
  (RUN-WITH-METHOD-INVISIBLE
   (LET
    ((*MESSAGE '(!,*MESSAGE)))
    (COMPILED-ASK
     '#,(LIST
         (METHOD-AT-POSITION ((TICK) 0) CLOCK)
         (METHOD-AT-POSITION ((TICK) 0) SOMETHING))
     '#,(ACTOR-OF (QUOTE CLOCK))))
   MYSELF
   *METHOD-BEING-RUN)
  (LET
   ((ACTORS-TO-RUN
     (LET
      ((*MESSAGE '(RECALL YOUR ACTORS-TO-RUN-NEXT)))
      (QUICK-COMPILED-ASK
       '#,(METHOD-AT-POSITION (|(RECALL YOUR ?)| 0) SOMETHING)
       '#,(ACTOR-OF (QUOTE CLOCK))))))
   (LET
    ((*MESSAGE '(SET YOUR ACTORS-TO-RUN-NEXT TO NIL)))
    (QUICK-COMPILED-ASK
     '#,(METHOD-AT-POSITION (|(SET YOUR ? TO ?)| 0) SOMETHING)
     '#,(ACTOR-OF (QUOTE CLOCK))))
   (DIRECTOR-MAPCAR
    (FUNCTION
     (LAMBDA (ACTOR)
       (LET
        ((MYSELF (ACTOR-OF ACTOR)) (*MESSAGE '(TICK)))
        (QUICK-COMPILED-ASK
         '#,(METHOD-AT-POSITION ((TICK) 0) CLOCK)
         '#,(ACTOR-OF (QUOTE CLOCK))))))
    ACTORS-TO-RUN))) 
(DEFUN D0169 (MESSAGE)
  (COND ((AND
          (EQUAL MESSAGE (QUOTE (TICK)))
          (METHOD-IF-NOT-HIDDEN '#,(METHOD-AT-POSITION ((TICK) 0) CLOCK))))
        ((AND
          (AND
           (EQ (CAR MESSAGE) (QUOTE RUN))
           (AND (EQ (CADR MESSAGE) (QUOTE FOR)) (ONE-LONG (CDDDR MESSAGE))))
          (METHOD-IF-NOT-HIDDEN '#,(METHOD-AT-POSITION (|(RUN FOR ? ?)| 0) CLOCK)))))) 
(COMMENT AND NOW FOR THE ODDS AND ENDS) 
(REAP-SYMBOLS-IN-ACTOR (ACTOR-OF (QUOTE SOMETHING))) 
(ASK SOMETHING ADD CLOCK TO YOUR LIST OF OFFSPRING) 
(ASK CLOCK MAKE SYNONYM UNIVERSE) 
(REAP-SYMBOLS-IN-ACTOR (ACTOR-OF (QUOTE CLOCK))) 
(ASK CLOCK ADD DEFAULT-CLOCK TO YOUR LIST OF OFFSPRING) 
(REAP-SYMBOLS-IN-ACTOR (ACTOR-OF (QUOTE DEFAULT-CLOCK))) 